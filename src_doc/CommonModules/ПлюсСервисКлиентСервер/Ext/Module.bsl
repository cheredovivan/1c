#Область ПрограммныйИнтерфейс

// Адрес сервиса 1С:Плюс
// 
// Возвращаемое значение:
//  Строка
Функция АдресСервиса() Экспорт
	
	Возврат "https://plus.1c.ru";
	
КонецФункции

#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс

Функция КомандаУстановитьРасширение() Экспорт
	
	Возврат "УстановитьРасширение";
	
КонецФункции

Функция КомандаРасширениеУстановлено() Экспорт
	
	Возврат "РасширениеУстановлено";
	
КонецФункции

Функция КомандаОткрытьНастройки() Экспорт
	
	Возврат "ОткрытьНастройки";
	
КонецФункции

Функция КомандаПосмотретьОписание() Экспорт
	
	Возврат "ПосмотретьОписание";

КонецФункции

Функция ПолеПубличныйИдентификатор() Экспорт
	
	Возврат "ExtPublicId";
	
КонецФункции

Функция ПолеИдентификаторВерсии() Экспорт
	
	Возврат "ExtVersionId";
	
КонецФункции

Функция ИмяСерверногоОповещенияНеобходимаУстановкаМонопольногоРежима() Экспорт
	Возврат "ПлюсСервис.НеобходимаУстановкаМонопольногоРежима";
КонецФункции

Функция ИмяСерверногоОповещенияОтключеноАвтообновление() Экспорт
	Возврат "ПлюсСервис.ОтключеноАвтообновление";
КонецФункции

Функция ИмяСерверногоОповещенияВыбратьИПоказатьРекомендацию() Экспорт
	Возврат "ПлюсСервис.ВыбратьИПоказатьРекомендацию";
КонецФункции

Функция ИмяПараметраПриложенияПлюсРекомендации() Экспорт
	Возврат "ПлюсСервис.Рекомендации";
КонецФункции

Функция ИмяПараметраСеансаФормыСРекомендациями() Экспорт
	Возврат "ПлюсФормыСРекомендациями";
КонецФункции

Функция ИмяПараметраСеансаИсторияОткрытыхФорм() Экспорт
	Возврат "ПлюсИсторияОткрытыхФорм";
КонецФункции

Функция ИмяПараметраПриложенияИсторияОткрытыхФорм() Экспорт
	Возврат "ИсторияОткрытыхФорм";
КонецФункции

Функция ИмяПараметраПриложенияЛимитИсчерпан() Экспорт
	Возврат "ЛимитИсчерпан";
КонецФункции

Функция ИмяПараметраПриложенияИсторияПоказов() Экспорт
	Возврат "ИсторияПоказов";
КонецФункции

Функция ШаблонСтрокиМассиваИсторияОткрытыхФорм() Экспорт

	Шаблон = "ТипИсточника=%1;ИмяОбъекта=%2;ИмяФормы=%3";

	Возврат Шаблон;

КонецФункции

Функция ПараметрыРекомендацииДляИсторииПоказов() Экспорт

	// Формируем параметры для сохранения в ПараметрыПриложения
	// ПараметрыПриложения - глобальная клиентская переменная
	// ХранилищеЗначения недоступно в контексте клиента
	// Удаляем параметр Логотип - ХранилищеЗначения
	Рекомендация = ПараметрыРекомендации();
	Рекомендация.Удалить("Логотип");

	Возврат Рекомендация;

КонецФункции

Функция ПараметрыРекомендацииДляОповещенияПользователя() Экспорт

	// Формируем параметры для заполнения оповещения пользователю
	// Оповещение пользователю формируется в контексте клиента
	// ХранилищеЗначения недоступно в контексте клиента
	// Удаляем параметр Логотип - ХранилищеЗначения
	// В оповещении пользователю можно отобразить картинку из временного хранилища
	// Добавляем параметр АдресЛоготип - Строка, адрес временного хранилища для картинки логотипа
	Рекомендация = ПараметрыРекомендации();
	Рекомендация.Удалить("Логотип");
	Рекомендация.Вставить("АдресЛоготип", "");

	Возврат Рекомендация;

КонецФункции

Функция ПараметрыРекомендации() Экспорт

	Рекомендация = Новый Структура;

	Рекомендация.Вставить("Пользователь", ПредопределенноеЗначение("Справочник.Пользователи.ПустаяСсылка"));
	Рекомендация.Вставить("ИдРасширения", ОбщегоНазначенияКлиентСервер.ПустойУникальныйИдентификатор());
	Рекомендация.Вставить("ЦелевоеДействиеТип", 0);
	Рекомендация.Вставить("ЦелевоеДействиеОбъект", "");
	Рекомендация.Вставить("ЦелевоеДействиеФорма", "");
	Рекомендация.Вставить("Заголовок", "");
	Рекомендация.Вставить("Описание", "");
	Рекомендация.Вставить("Логотип", Неопределено);
	Рекомендация.Вставить("ДатаВыполнения", Дата("00010101"));
	Рекомендация.Вставить("ОписаниеОшибки", "");

	Возврат Рекомендация;

КонецФункции

Процедура ПлюсРекомендацииОбработкаПолученияФормыСправочника(Источник, ВидФормы, Параметры, ВыбраннаяФорма,
	ДополнительнаяИнформация, СтандартнаяОбработка) Экспорт

	ТипИсточникаСправочник = 2;
	ИмяФормы = ИмяФормыДляРекомендаций(ВидФормы, ВыбраннаяФорма);
	ТипЗначенияИсточника = ТипЗнч(Источник);
		
	ПлюсСервисВызовСервера.ДобавитьФормуВИсториюОткрытых(ТипИсточникаСправочник, ТипЗначенияИсточника, ИмяФормы);

КонецПроцедуры

Процедура ПлюсРекомендацииОбработкаПолученияФормыДокумента(Источник, ВидФормы, Параметры, ВыбраннаяФорма,
	ДополнительнаяИнформация, СтандартнаяОбработка) Экспорт

	ТипИсточникаДокумент = 1;
	ИмяФормы = ИмяФормыДляРекомендаций(ВидФормы, ВыбраннаяФорма);
	ТипЗначенияИсточника = ТипЗнч(Источник);
	
	ПлюсСервисВызовСервера.ДобавитьФормуВИсториюОткрытых(ТипИсточникаДокумент, ТипЗначенияИсточника, ИмяФормы);

КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Функция ИмяФормыДляРекомендаций(ВидФормы, ВыбраннаяФорма)
	
	Если ВыбраннаяФорма = Неопределено Или ВыбраннаяФорма = "" Тогда
		ИмяФормы = ВидФормы;
	Иначе
		ИмяФормы = ?(ТипЗнч(ВыбраннаяФорма) = Тип("Строка"), ВыбраннаяФорма, ВыбраннаяФорма.Имя);
	КонецЕсли;
	
	Возврат ИмяФормы;
	
КонецФункции

#КонецОбласти