// Модуль устарел. В будущем будет переименован в РаботаСОрганизациямиВызовСервера

#Область ПрограммныйИнтерфейс

// См. Справочники.Организации.ОрганизацияПоУмолчанию
// Для вызова с клиента.
// 
// Возвращаемое значение:
//  СправочникСсылка.Организации
Функция ОрганизацияПоУмолчанию() Экспорт
	
	Возврат Справочники.Организации.ОрганизацияПоУмолчанию();
	
КонецФункции

#Область УстаревшиеПроцедурыИФункции

// Устарела. Следует использовать См. Справочники.Организации.ОрганизацияПоУмолчанию 
// или См. ОрганизацияПоУмолчанию. - для вызова с клиента.
// 
// Возвращаемое значение:
//  СправочникСсылка.Организации
Функция ПолучитьОрганизациюПоУмолчанию() Экспорт
	
	Возврат Справочники.Организации.ОрганизацияПоУмолчанию();
	
КонецФункции

// Устарела. Следует использовать см. Справочники.Организации.ОтветственноеЛицо
// 
// Параметры:
//  ОтветственноеЛицо - Строка - Вид ответственного лица, см. в коде
//  Организация - СправочникСсылка.Организации -
//  Период - Дата -
// 
// Возвращаемое значение:
//  СправочникСсылка.Сотрудники, СправочникСсылка.Пользователи -
Функция ПолучитьОтветственноеЛицо(Знач ОтветственноеЛицо, Знач Организация, Знач Период) Экспорт
	
	Возврат Справочники.Организации.ОтветственноеЛицо(ОтветственноеЛицо, Организация, Период);
	
КонецФункции

// Устарела. Следует использовать см. Справочники.Организации.ОтветственныеСотрудникиПоОрганизациям
// 
// Параметры:
//  ОтветственноеЛицо - ПеречислениеСсылка.ОтветственныеЛицаОрганизаций - Тип отв. лица
//  Организации - Массив Из СправочникСсылка.Организации -
//  			- СписокЗначений Из СправочникСсылка.Организации - Организации для отбора отв. лиц.
//  Период - Дата, Неопределено - Период отв. лица. Если не передан, используется текущая дата.
// 
// Возвращаемое значение:
//  ТаблицаЗначений - Ответственные лица по организациям:
//		* Сотрудник - СправочникСсылка.Сотрудники
//		* Организация - СправочникСсылка.Организации
Функция ОтветственныеСотрудникиПоОрганизациям(
	Знач ОтветственноеЛицо, Знач Организации, Знач Период = Неопределено) Экспорт
	
	Возврат Справочники.Организации.ОтветственныеСотрудникиПоОрганизациям(ОтветственноеЛицо, Организации, Период);
	
КонецФункции

// Устарела. Не используется. Следует использовать См. ОрганизацииСлужебный.ПроверитьЗначениеОпцииИспользоватьУчетПоОрганизациямПриЗаписи
// 
// Параметры:
//  Источник - СправочникОбъект.Организации -
//  Отказ - Булево -
Процедура ПроверитьЗначениеОпцииИспользоватьУчетПоОрганизациямПриЗаписи(Источник, Отказ) Экспорт
	
	ОрганизацииСлужебный.ПроверитьЗначениеОпцииИспользоватьУчетПоОрганизациямПриЗаписи(Источник, Отказ);
	
КонецПроцедуры

// Устарела. См. Справочники.Организации - обработчик в модуле менеджера.
Процедура ОбработкаПолученияДанныхВыбора(ДанныеВыбора, Параметры, СтандартнаяОбработка) Экспорт

	Если Параметры.Свойство("СтрокаПоиска") 
		И НЕ ПустаяСтрока(Параметры.СтрокаПоиска) Тогда
	
		СтандартнаяОбработка = Ложь;
		
		Текст = Параметры.СтрокаПоиска;
		СловаПоиска = ОбщегоНазначенияДокументооборот.СловаПоиска(Текст);
		ДанныеВыбора = Новый СписокЗначений;
		
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 50
		|	Организации.Ссылка,
		|	""Наименование"" КАК ПолеСовпадения,
		|	Организации.Наименование КАК ЗначениеПоля,
		|	Организации.Представление КАК Организация
		|ИЗ
		|	Справочник.Организации КАК Организации
		|ГДЕ
		|	Организации.ПометкаУдаления = ЛОЖЬ
		|	И Организации.Наименование ПОДОБНО &Текст
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ ПЕРВЫЕ 50
		|	Организации.Ссылка,
		|	""ИНН"",
		|	Организации.ИНН,
		|	Организации.Представление
		|ИЗ
		|	Справочник.Организации КАК Организации
		|ГДЕ
		|	Организации.ПометкаУдаления = ЛОЖЬ
		|	И Организации.ИНН ПОДОБНО &Текст
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ ПЕРВЫЕ 50
		|	Организации.Ссылка,
		|	""ОГРН"",
		|	Организации.ОГРН,
		|	Организации.Представление
		|ИЗ
		|	Справочник.Организации КАК Организации
		|ГДЕ
		|	Организации.ПометкаУдаления = ЛОЖЬ
		|	И Организации.ОГРН ПОДОБНО &Текст";
		
		Запрос.УстановитьПараметр("Текст", "%" + Текст + "%");
		
		ОбъектМетаданных = Метаданные.Справочники.Организации;
		Если Не МультиязычностьПовтИсп.КонфигурацияИспользуетТолькоОдинЯзык(ОбъектМетаданных.ТабличныеЧасти.Найти("Представления") = Неопределено) Тогда
			
			Если МультиязычностьСервер.ИспользуетсяДополнительныйЯзык(1) Тогда
				Запрос.Текст = СтрЗаменить(Запрос.Текст,
					"Организации.Наименование ПОДОБНО &Текст",
					"(Организации.Наименование ПОДОБНО &Текст ИЛИ Организации.НаименованиеЯзык1 ПОДОБНО &Текст)");
			КонецЕсли;
			
		КонецЕсли;
		
		Выборка = Запрос.Выполнить().Выбрать();
		Пока Выборка.Следующий() Цикл
			
			Если Выборка.ПолеСовпадения = "Наименование" Тогда 
				ПредставлениеФорматированнаяСтрока = ОбщегоНазначенияДокументооборот.ФорматированныйРезультатПоиска(
					Выборка.Организация,
					СловаПоиска);
				
				ДобавкаТекста = СтрШаблон(" (%1)", НСтр("ru='Организация'"));
					
				ПредставлениеФорматированнаяСтрока = Новый ФорматированнаяСтрока(
					ПредставлениеФорматированнаяСтрока,
					Новый ФорматированнаяСтрока(ДобавкаТекста,
						, WebЦвета.Серый)
					);
							
			ИначеЕсли Выборка.ПолеСовпадения = "ИНН" ИЛИ Выборка.ПолеСовпадения = "ОГРН" Тогда 
				ПредставлениеФорматированнаяСтрока = ОбщегоНазначенияДокументооборот.ФорматированныйРезультатПоиска(
					Выборка.ЗначениеПоля,
					СловаПоиска);
				
				ДобавкаТекста = СтрШаблон(НСтр("ru = ' (%1)'"), Выборка.Организация);
					
				ПредставлениеФорматированнаяСтрока = Новый ФорматированнаяСтрока(
					ПредставлениеФорматированнаяСтрока,
					Новый ФорматированнаяСтрока(ДобавкаТекста,
						, WebЦвета.Серый)
					);
					
			КонецЕсли;
					
			ДанныеВыбора.Добавить(Выборка.Ссылка, ПредставлениеФорматированнаяСтрока);
			
		КонецЦикла;
	
	Иначе
		Параметры.Отбор.Вставить("ПометкаУдаления", Ложь);
	КонецЕсли;

КонецПроцедуры

// Устарела. Не используется.
// Вернет ДвоичныеДанные картинки печати организации
// 
// Параметры:
// 	Организация -СправочникСсылка.Организации
// 	
// Возвращаемое значение:
// - ДвоичныеДанные -
// - Неопределено -
// 	
Функция Логотип(Знач Организация) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	ФайлФотографии = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(Организация, "Логотип");
	ДвоичныеДанные = ФайлФотографии.Получить();
	Возврат ДвоичныеДанные;
	
КонецФункции	

// Устарела. Следует использовать см. Справочники.Организации.КартинкиПечатейОрганизации
// 
// Параметры:
// 	Документ - СправочникСсылка.ДокументыПредприятия -
// 	
// Возвращаемое значение:
// Массив из ДвоичныеДанные - массив картинок
Функция КартинкиПечатейОрганизации(Знач Документ) Экспорт
	
	Возврат Справочники.Организации.КартинкиПечатейОрганизации(Документ);
	
КонецФункции

#КонецОбласти

#КонецОбласти