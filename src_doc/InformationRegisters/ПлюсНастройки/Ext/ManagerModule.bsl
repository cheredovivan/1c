#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныйПрограммныйИнтерфейс

Функция ВключитьИспользование() Экспорт
	
	Использование = Истина;
	
	ПлюсСервисПереопределяемый.ПередИзменениемЗначенияИспользованияВПриложении(Использование);

	Возврат ИзменитьЗначениеИспользованияВОбластиДанных(Использование);

КонецФункции

Функция ВыключитьИспользование() Экспорт
	
	Использование = Ложь;
	
	ПлюсСервисПереопределяемый.ПередИзменениемЗначенияИспользованияВПриложении(Использование);

	Возврат ИзменитьЗначениеИспользованияВОбластиДанных(Использование);

КонецФункции

Функция ИзменитьНастройки(Настройки) Экспорт
	
	ТребуетсяЗапись = Ложь;
	
	МенеджерЗаписи = СоздатьМенеджерЗаписи();
	Для Каждого Элемент Из Настройки Цикл
		Если Метаданные.РегистрыСведений.ПлюсНастройки.Ресурсы.Найти(Элемент.Ключ) Тогда
			МенеджерЗаписи[Элемент.Ключ] = Элемент.Значение;
			ТребуетсяЗапись = Истина;
		КонецЕсли;
	КонецЦикла;
	
	Если ТребуетсяЗапись Тогда
		МенеджерЗаписи.Записать(Истина);
	КонецЕсли;
	
	Возврат Истина;
	
КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Функция ИзменитьЗначениеИспользованияВОбластиДанных(Использование)
	
	МенеджерЗаписи = СоздатьМенеджерЗаписи();
	МенеджерЗаписи.СервисИспользуется = Использование;
	МенеджерЗаписи.Записать(Истина);
	
	Возврат Истина;
	
КонецФункции

#КонецОбласти

#КонецЕсли