
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ЧтоМеняем = Параметры.ЧтоМеняем;
	НаЧтоМеняем = Параметры.НаЧтоМеняем;
	ТипЗамечания = Параметры.ТипЗамечания;
	Автор = Параметры.Автор;
	Комментарий = Параметры.Комментарий;
	РеальныйАвтор = Параметры.РеальныйАвтор;
	Замечание = Параметры.Замечание;
	
	Если Параметры.Свойство("ПринятаяРедакция") Тогда
		ПринятаяРедакция = Параметры.ПринятаяРедакция;
	КонецЕсли;	
	
	Элементы.ПринятаяРедакция.Видимость = Ложь;
	
	Если Параметры.Свойство("ЭтоИнициатор") Тогда
		ЭтоИнициатор = Параметры.ЭтоИнициатор;

		Если ЭтоИнициатор Тогда
			Элементы.НовыйТекст.ТолькоПросмотр = Истина;
			Элементы.Замечание.ТолькоПросмотр = Истина;
			Элементы.ПринятаяРедакция.Видимость = Истина;
			
			Если Параметры.Свойство("СтатусПринятия") Тогда
				СтатусПринятия = Параметры.СтатусПринятия;
				
				Если СтатусПринятия = Перечисления.СтатусыПринятияЗамечаний.Принята Тогда
					Элементы.ПринятаяРедакция.ТолькоПросмотр = Истина;
				КонецЕсли;		
			КонецЕсли;	
			
			Если ТипЗамечания = Перечисления.ТипыЗамечаний.Комментарий Тогда
				Элементы.Комментарий.ТолькоПросмотр = Истина;
				Элементы.ПринятаяРедакция.ТолькоПросмотр = Истина;
			КонецЕсли;         
			
		КонецЕсли;			
		
	КонецЕсли;	
	
	ЭтоМобильныйКлиент = ПараметрыСеанса.ЭтоМобильныйКлиент;
	Если ЭтоМобильныйКлиент Тогда
		МК_НастроитьЭлементыФормы();
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ОК(Команда)
	
	СтруктураВозврата = Новый Структура("ЧтоМеняем, НаЧтоМеняем, ТипЗамечания, 
		|Автор, Комментарий, Замечание, ПринятаяРедакция", 
		ЧтоМеняем, НаЧтоМеняем, 
		ТипЗамечания, Автор,
		Комментарий, Замечание, ПринятаяРедакция);
	
	Закрыть(СтруктураВозврата);
	
КонецПроцедуры

#Область СлужебныеПроцедурыИФункции

#Область СлужебныеПроцедурыИФункции_МобильныйКлиент

&НаСервере
Процедура МК_НастроитьЭлементыФормы()
	
	Элементы.МК_НижнийБлок.Видимость = Истина;
	
	Элементы.Переместить(Элементы.ФормаОК, Элементы.МК_НижнийБлок);
	МК.ОформитьАкцентнуюКнопку(Элементы.ФормаОК);
	
	Элементы.Переместить(Элементы.ФормаОтмена, Элементы.МК_НижнийБлок);
	МК.ОформитьАкцентнуюКнопку(Элементы.ФормаОтмена);
	
	Элементы.ФормаОтмена.ЦветФона = ЦветаСтиля.ОтметкаОтрицательногоВыполненияЗадачи;
	Элементы.ФормаОтмена.ЦветРамки = ЦветаСтиля.ОтметкаОтрицательногоВыполненияЗадачи;
	
	МК.ВыровнятьЭлементФормы(Элементы.Автор);
	МК.ВыровнятьЭлементФормы(Элементы.РеальныйАвтор);
	МК.ВыровнятьЭлементФормы(Элементы.ТипЗаметки);

КонецПроцедуры
	
#КонецОбласти

#КонецОбласти
