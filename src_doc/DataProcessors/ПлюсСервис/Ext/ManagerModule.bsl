
#Область СлужебныеПроцедурыИФункции

Функция УстановитьМонопольныйРежимНаСервере(ЭтоУстановка, ЭтоУдаление) Экспорт
	
	//@skip-check unavailable-in-safemode
	УстановитьПривилегированныйРежим(Истина);
	
	МонопольныйРежим = Ложь;
	Попытка
		УстановитьМонопольныйРежим(Истина);
		МонопольныйРежим = Истина;
	Исключение
		#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда
			КодОсновногоЯзыка =  ОбщегоНазначения.КодОсновногоЯзыка();
		#Иначе
			КодОсновногоЯзыка =  ОбщегоНазначенияКлиент.КодОсновногоЯзыка();
		#КонецЕсли
		Если ЭтоУстановка Тогда
			ИмяСобытия = НСтр("ru = 'Расширения 1С:Плюс.Установка расширения'", КодОсновногоЯзыка);
		ИначеЕсли ЭтоУдаление Тогда
			ИмяСобытия = НСтр("ru = 'Расширения 1С:Плюс.Удаление расширения'", КодОсновногоЯзыка);
		Иначе
			ИмяСобытия = НСтр("ru = 'Расширения 1С:Плюс.Обновление расширения'", КодОсновногоЯзыка);
		КонецЕсли;
		ЗаписьЖурналаРегистрации(
				ИмяСобытия,
				УровеньЖурналаРегистрации.Ошибка,,,
				ОбработкаОшибок.ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
	КонецПопытки;
	
	Возврат МонопольныйРежим;
	
КонецФункции

#КонецОбласти