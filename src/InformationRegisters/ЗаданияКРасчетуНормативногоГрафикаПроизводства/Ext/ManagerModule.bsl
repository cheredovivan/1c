#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Добавляет записи в регистр заданий.
//
// Параметры:
//  ОбъектРасчета - ДокументСсылка.ЗаказНаПроизводство2_2 - документ, для которого необходимо добавить задание.
//  Автозапуск    - Булево - автоматический запуск расчет фоновым заданием.
//
Процедура ДобавитьЗадание(ОбъектРасчета, Автозапуск = Истина) Экспорт
	
	Задание = Новый Структура;
	Задание.Вставить("ОбъектРасчета", ОбъектРасчета);
	
	Если Автозапуск Тогда
		ОтложенныеЗадания.ОбработатьЗаданияОчереди("ЗаданияКРасчетуНормативногоГрафикаПроизводства", Задание);
	Иначе
		ОтложенныеЗадания.ДобавитьЗаданияВОчередь("ЗаданияКРасчетуНормативногоГрафикаПроизводства", Задание)
	КонецЕсли;
	
КонецПроцедуры

// Запускает в фоновом режиме планирование производства
// Параметры:
//  ОбъектРасчета - ДокументСсылка.ЗаказНаПроизводство2_2 - документ, для которого необходимо запустить задание.
//
Процедура ЗапуститьЗадание(ОбъектРасчета = Неопределено) Экспорт
	
	Очередь = "ЗаданияКРасчетуНормативногоГрафикаПроизводства";
	
	Если ЗначениеЗаполнено(ОбъектРасчета) Тогда
		
		Отбор = Новый Структура("ОбъектРасчета", ОбъектРасчета);
		
		ТаблицаЗаданий = ОтложенныеЗадания.ИнициализироватьТаблицуЗаданий(Очередь);
		ТаблицаЗаданий[0].Задания = ОтложенныеЗадания.ПолучитьЗадания(Очередь, Отбор);
		
		ОтложенныеЗадания.Запустить(ТаблицаЗаданий);
		
	Иначе
		
		ОтложенныеЗадания.Запустить(Очередь);
		
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли
