#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныеПроцедурыИФункции

Функция НастройкиДляОбновления() Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Настройки.ПричинаОтсутствия КАК ПричинаОтсутствия,
	|	Настройки.ОформлятьЗаднимЧислом КАК ОформлятьЗаднимЧислом,
	|	Настройки.ТребуетсяОбновление КАК ТребуетсяОбновление,
	|	Настройки.КоличествоДнейДоНачалаОтсутствияДляИзмененияЗаявки КАК КоличествоДнейДоНачалаОтсутствияДляИзмененияЗаявки
	|ИЗ
	|	РегистрСведений.НастройкиОтсутствийКабинетСотрудника КАК Настройки
	|ГДЕ
	|	Настройки.ТребуетсяОбновление";
	
	Возврат Запрос.Выполнить().Выгрузить();

КонецФункции

Функция Настройки(ПричиныОтсутствий) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("ПричиныОтсутствий", ПричиныОтсутствий);
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ПричиныОтсутствий.Ссылка КАК ПричинаОтсутствия,
	|	ЕСТЬNULL(Настройки.ОформлятьЗаднимЧислом, ЛОЖЬ) КАК ОформлятьЗаднимЧислом,
	|	ЕСТЬNULL(Настройки.ТребуетсяОбновление, ЛОЖЬ) КАК ТребуетсяОбновление,
	|	ЕСТЬNULL(Настройки.КоличествоДнейДоНачалаОтсутствияДляИзмененияЗаявки, 0) КАК КоличествоДнейДоНачалаОтсутствияДляИзмененияЗаявки
	|ИЗ
	|	Перечисление.ПричиныОтсутствийЗаявокКабинетСотрудника КАК ПричиныОтсутствий
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НастройкиОтсутствийКабинетСотрудника КАК Настройки
	|		ПО ПричиныОтсутствий.Ссылка = Настройки.ПричинаОтсутствия
	|ГДЕ
	|	ПричиныОтсутствий.Ссылка В(&ПричиныОтсутствий)";
	
	Возврат Запрос.Выполнить().Выгрузить();

КонецФункции

Функция ДоступныеПричиныОтсутствий() Экспорт

	ПричиныОтсутствий = Новый Массив;
	ПричиныОтсутствий.Добавить(Перечисления.ПричиныОтсутствийЗаявокКабинетСотрудника.Отпуск);
	ПричиныОтсутствий.Добавить(Перечисления.ПричиныОтсутствийЗаявокКабинетСотрудника.ОтпускЗаСвойСчет);
	ПричиныОтсутствий.Добавить(Перечисления.ПричиныОтсутствийЗаявокКабинетСотрудника.УчебныйОтпуск);
	ПричиныОтсутствий.Добавить(Перечисления.ПричиныОтсутствийЗаявокКабинетСотрудника.Командировка);
	ПричиныОтсутствий.Добавить(Перечисления.ПричиныОтсутствийЗаявокКабинетСотрудника.Отгул);
	ПричиныОтсутствий.Добавить(Перечисления.ПричиныОтсутствийЗаявокКабинетСотрудника.ЛичныеДела);
	
	Возврат ПричиныОтсутствий;

КонецФункции

#КонецОбласти

#КонецЕсли