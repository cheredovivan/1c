#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныеПроцедурыИФункции

Функция НастройкиИнтеграции() Экспорт
	
	Настройки = РегистрыСведений.НастройкиИнтеграцииКабинетСотрудника.СоздатьМенеджерЗаписи();
	Настройки.Прочитать();
	
	СтруктураНастроек = ОбщегоНазначения.СтруктураПоМенеджеруЗаписи(
							Настройки, Метаданные.РегистрыСведений.НастройкиИнтеграцииКабинетСотрудника);
	
	Если Не ЗначениеЗаполнено(СтруктураНастроек.ДнейСохраненияПубликации) Тогда
		СтруктураНастроек.ДнейСохраненияПубликации = 5;
	КонецЕсли;
	
	Если Не ЗначениеЗаполнено(СтруктураНастроек.СпособПолученияСогласияНаПрисоединениеКЭДОБЗК) Тогда
		СтруктураНастроек.СпособПолученияСогласияНаПрисоединениеКЭДОБЗК = Перечисления.СпособыПолученияСогласияНаПрисоединениеКЭДОБЗК.БумажныйДокумент;	
	КонецЕсли;
	
	Возврат СтруктураНастроек;

КонецФункции

Процедура СохранитьНовыеВидыКонтактнойИнформации(ВидКИМобильныйТелефон, ВидКИАдресЭлектроннойПочты) Экспорт

	Настройки = НастройкиИнтеграции();
	Настройки.ВидКонтактнойИнформацииМобильныйТелефон = ВидКИМобильныйТелефон;
	Настройки.ВидКонтактнойИнформацииАдресЭлектроннойПочты = ВидКИАдресЭлектроннойПочты;
	
	НаборЗаписей = РегистрыСведений.НастройкиИнтеграцииКабинетСотрудника.СоздатьНаборЗаписей();
	ЗаполнитьЗначенияСвойств(НаборЗаписей.Добавить(), Настройки);
	НаборЗаписей.Записать();

КонецПроцедуры

Процедура СохранитьЗначениеИспользуетсяЭДОБЗК(ИспользуетсяЭДОБЗК) Экспорт

	Настройки = НастройкиИнтеграции();
	Настройки.ИспользуетсяЭДОБЗК = ИспользуетсяЭДОБЗК;
	
	НаборЗаписей = РегистрыСведений.НастройкиИнтеграцииКабинетСотрудника.СоздатьНаборЗаписей();
	ЗаполнитьЗначенияСвойств(НаборЗаписей.Добавить(), Настройки);
	НаборЗаписей.ДополнительныеСвойства.Вставить("ОбновитьНастройкиФункциональностьСервиса");
	НаборЗаписей.Записать();

КонецПроцедуры

Процедура СохранитьЗначениеДнейСохраненияПубликации(ДнейСохраненияПубликации) Экспорт

	Настройки = НастройкиИнтеграции();
	Настройки.ДнейСохраненияПубликации = ДнейСохраненияПубликации;
	
	НаборЗаписей = РегистрыСведений.НастройкиИнтеграцииКабинетСотрудника.СоздатьНаборЗаписей();
	ЗаполнитьЗначенияСвойств(НаборЗаписей.Добавить(), Настройки);
	НаборЗаписей.Записать();

КонецПроцедуры

Процедура СохранитьЗначениеКоординаторОбсуждений(НовоеЗначение) Экспорт

	Настройки = НастройкиИнтеграции();
	Настройки.КоординаторОбсуждений = НовоеЗначение;
	
	НаборЗаписей = РегистрыСведений.НастройкиИнтеграцииКабинетСотрудника.СоздатьНаборЗаписей();
	ЗаполнитьЗначенияСвойств(НаборЗаписей.Добавить(), Настройки);
	НаборЗаписей.Записать();

КонецПроцедуры

Процедура СохранитьЗначениеИдентификаторПриложенияСовместногоИспользования(НовоеЗначение) Экспорт

	Настройки = НастройкиИнтеграции();
	Настройки.ИдентификаторПриложенияСовместногоИспользования = НовоеЗначение;
	
	НаборЗаписей = РегистрыСведений.НастройкиИнтеграцииКабинетСотрудника.СоздатьНаборЗаписей();
	ЗаполнитьЗначенияСвойств(НаборЗаписей.Добавить(), Настройки);
	НаборЗаписей.Записать();

КонецПроцедуры

Процедура СохранитьЗначениеСпособПолученияСогласияНаПрисоединениеКЭДОБЗК(СпособПолучения) Экспорт
	
	Настройки = НастройкиИнтеграции();
	Настройки.СпособПолученияСогласияНаПрисоединениеКЭДОБЗК = СпособПолучения;
	
	НаборЗаписей = РегистрыСведений.НастройкиИнтеграцииКабинетСотрудника.СоздатьНаборЗаписей();
	ЗаполнитьЗначенияСвойств(НаборЗаписей.Добавить(), Настройки);
	НаборЗаписей.ДополнительныеСвойства.Вставить("ОбновитьНастройкиФункциональностьСервиса");
	НаборЗаписей.Записать();

КонецПроцедуры

Процедура СохранитьЗначениеВариантОтчетаРасчетныйЛисток(ВариантОтчетаРасчетныйЛисток) Экспорт
	Настройки = НастройкиИнтеграции();
	Настройки.ВариантОтчетаРасчетныйЛисток = ВариантОтчетаРасчетныйЛисток;
	СохранитьНастройки(Настройки);
КонецПроцедуры

Процедура СохранитьЗначениеВариантОтчетаРасчетныйЛистокЗаПервуюПоловину(ВариантОтчетаРасчетныйЛистокЗаПервуюПоловину) Экспорт
	Настройки = НастройкиИнтеграции();
	Настройки.ВариантОтчетаРасчетныйЛистокЗаПервуюПоловину = ВариантОтчетаРасчетныйЛистокЗаПервуюПоловину;
	СохранитьНастройки(Настройки);
КонецПроцедуры

Процедура СохранитьЗначениеФормироватьРасчетныеЛистыОтдельнымЗапросом(ФормироватьРасчетныеЛистыОтдельнымЗапросом) Экспорт
	Настройки = НастройкиИнтеграции();
	Настройки.ФормироватьРасчетныеЛистыОтдельнымЗапросом = ФормироватьРасчетныеЛистыОтдельнымЗапросом;
	СохранитьНастройки(Настройки);
КонецПроцедуры

Процедура СохранитьЗначениеИспользоватьСборДанныхДляОформленияНаРаботу(НовоеЗначение) Экспорт

	Настройки = НастройкиИнтеграции();
	Настройки.ИспользоватьСборДанныхДляОформленияНаРаботу = НовоеЗначение;
	
	НаборЗаписей = РегистрыСведений.НастройкиИнтеграцииКабинетСотрудника.СоздатьНаборЗаписей();
	ЗаполнитьЗначенияСвойств(НаборЗаписей.Добавить(), Настройки);
	НаборЗаписей.ДополнительныеСвойства.Вставить("ОбновитьНастройкиФункциональностьСервиса");
	НаборЗаписей.Записать();

КонецПроцедуры


Процедура СохранитьНастройки(Настройки)
	НаборЗаписей = РегистрыСведений.НастройкиИнтеграцииКабинетСотрудника.СоздатьНаборЗаписей();
	ЗаполнитьЗначенияСвойств(НаборЗаписей.Добавить(), Настройки);
	НаборЗаписей.Записать();
КонецПроцедуры

#КонецОбласти

#КонецЕсли

