#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Добавляет записи в регистр заданий.
//
// Параметры:
//  Данные - ДокументСсылка.ЭтапПроизводства2_2, ТаблицаЗначений - документ, для которого необходимо добавить задание,
//                                                                 или таблица документов, для которых необходимо
//                                                                 добавить задания, с колонкой:
//                                                                  * ОбъектРасчета - ДокументСсылка.ЭтапПроизводства2_2 -
//  АвтоЗапуск - Булево - автоматический запуск задание.
//
Процедура ДобавитьЗадания(Данные, Автозапуск = Истина) Экспорт
	
	Если ТипЗнч(Данные) = Тип("ТаблицаЗначений") Тогда
		Задания = Данные;
	Иначе
		Задания = Новый Структура;
		Задания.Вставить("ОбъектРасчета", Данные);
	КонецЕсли;
	
	Если Автозапуск Тогда
		ОтложенныеЗадания.ОбработатьЗаданияОчереди("ЗаданияКРасчетуОчередиПроизводственныхОпераций", Задания);
	Иначе
		ОтложенныеЗадания.ДобавитьЗаданияВОчередь("ЗаданияКРасчетуОчередиПроизводственныхОпераций", Задания);
	КонецЕсли;
	
КонецПроцедуры

// Запускает задания расчета очереди производственных операций
//
Процедура ЗапуститьЗадания() Экспорт
	
	ОтложенныеЗадания.Запустить("ЗаданияКРасчетуОчередиПроизводственныхОпераций");
	
КонецПроцедуры

// Инициализирует таблицу данных для записи заданий, которую можно передать на вход метода см. ДобавитьЗадания
//
// Возвращаемое значение:
//  ТаблицаЗначений - Таблица данных заданий:
//   * ОбъектРасчета - ДокументСсылка.ЭтапПроизводства2_2 - документ, для которого необходимо добавить задание.
//
Функция ИнициализироватьТаблицуДанныхЗаданий() Экспорт
	
	Таблица = Новый ТаблицаЗначений;
	Таблица.Колонки.Добавить("ОбъектРасчета", Новый ОписаниеТипов("ДокументСсылка.ЭтапПроизводства2_2"));
	
	Возврат Таблица;
	
КонецФункции

#КонецОбласти

#КонецЕсли