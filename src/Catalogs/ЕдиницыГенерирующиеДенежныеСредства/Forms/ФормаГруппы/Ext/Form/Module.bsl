#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Справочники.ЕдиницыГенерирующиеДенежныеСредства.ОграничитьСписокОрганизаций(Параметры, Объект, Элементы.Владелец);
	//Создание новй группы из формы списка справочника, открытой из документа.
	Если Объект.Ссылка = Справочники.ЕдиницыГенерирующиеДенежныеСредства.ПустаяСсылка() 
			И Параметры.ЗначенияЗаполнения.Свойство("Владелец")
			И ТипЗнч(Параметры.ЗначенияЗаполнения.Владелец) = Тип("СписокЗначений")
			И Параметры.ЗначенияЗаполнения.Владелец.Количество() > 0 Тогда
				// Владельцем будет первая из списка, организация-филиал, указанная в документе.
				Для Каждого Владелец Из Параметры.ЗначенияЗаполнения.Владелец Цикл
					Объект.Владелец = Владелец.Значение;
					Прервать;
				КонецЦикла;
	КонецЕсли;
	
	ПриЧтенииСозданииНаСервере();
	
	// СтандартныеПодсистемы.Свойства
	ДополнительныеПараметры = Новый Структура;
	ДополнительныеПараметры.Вставить("ИмяЭлементаДляРазмещения", "ГруппаДополнительныеРеквизиты");
	УправлениеСвойствами.ПриСозданииНаСервере(ЭтотОбъект, ДополнительныеПараметры);
	// Конец СтандартныеПодсистемы.Свойства
	
	// СтандартныеПодсистемы.ВерсионированиеОбъектов
	ВерсионированиеОбъектов.ПриСозданииНаСервере(ЭтотОбъект);
	// Конец СтандартныеПодсистемы.ВерсионированиеОбъектов

КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции
&НаСервере
Процедура ПриЧтенииСозданииНаСервере()
	
	ИспользоватьНесколькоОрганизаций       = ПолучитьФункциональнуюОпцию("ИспользоватьНесколькоОрганизаций");
	
	Если Не ИспользоватьНесколькоОрганизаций Тогда
		Если Не ЗначениеЗаполнено(Объект.Ссылка) Тогда // Новый элемент справочника.
			Объект.Владелец = ЗначениеНастроекПовтИсп.ПолучитьОрганизациюПоУмолчанию();
		КонецЕсли;
	КонецЕсли;
	
	Элементы.Владелец.Видимость = ИспользоватьНесколькоОрганизаций;
	
	Если Объект.Ссылка <> Справочники.ЕдиницыГенерирующиеДенежныеСредства.ПустаяСсылка() Тогда
		Элементы.Владелец.ТолькоПросмотр = Истина;
	КонецЕсли;
	
КонецПроцедуры
#КонецОбласти

