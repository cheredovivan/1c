#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область Переменные

Перем мПолноеИмяФайлаВнешнейОбработки Экспорт;

Перем мВерсияОтчета Экспорт;

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

#Область ФормированиеРегламентированногоОтчета

Функция СформироватьАвтоматическиРеглОтчет(ПараметрыАвтоформирования, КорректирующийОтчет) Экспорт
	
	ИмяФормы = ПараметрыАвтоформирования.ИмяФормыОтчета;
	
	ПодготовленныйРеглОтчет = ПодготовленныйРеглОтчет(ИмяФормы, ПараметрыАвтоформирования, КорректирующийОтчет);
	
	РазделыОтчета       = ПодготовленныйРеглОтчет.РазделыОтчета;
	ДанныеРеглОтчета    = ПодготовленныйРеглОтчет.ДанныеРеглОтчета;
	ДеревоСтраницОтчета = ПодготовленныйРеглОтчет.ДеревоСтраницОтчета;
	
	ПараметрыЗаписи = Новый Структура;
	ПараметрыЗаписи.Вставить("ИсточникОтчета", ПараметрыАвтоформирования.ИсточникОтчета);
	ПараметрыЗаписи.Вставить("ИмяФормыОтчета", ПараметрыАвтоформирования.ИмяФормыОтчета);
	ПараметрыЗаписи.Вставить("Организация", ПараметрыАвтоформирования.Организация);
	ПараметрыЗаписи.Вставить("ДатаНачала", ПараметрыАвтоформирования.ДатаНачала);
	ПараметрыЗаписи.Вставить("ДатаОкончания", ПараметрыАвтоформирования.ДатаОкончания);
	ПараметрыЗаписи.Вставить("СохраняемыйРеглОтчет", ПараметрыАвтоформирования.СсылкаНаСохрРеглОтчет);
	ПараметрыЗаписи.Вставить("Ошибки", ПараметрыАвтоформирования.Ошибки);
	ПараметрыЗаписи.Вставить("ДатаПодписи", ДанныеРеглОтчета.ДатаПодписи);
	ПараметрыЗаписи.Вставить("ЕдиницаИзмерения", Перечисления.ПорядкиОкругленияОтчетности.Окр1);
	ПараметрыЗаписи.Вставить("ТочностьЕдиницыИзмерения", 0);
	ПараметрыЗаписи.Вставить("Комментарий", ?(ПараметрыАвтоформирования.Свойство("КомментарийАвтозаполнения"),
	ПараметрыАвтоформирования["КомментарийАвтозаполнения"], ""));
	ПараметрыЗаписи.Вставить("КодИФНС", РазделыОтчета.Титульный.НалоговыйОрган);
	ПараметрыЗаписи.Вставить("КПП", "");
	ПараметрыЗаписи.Вставить("СтруктураМногоуровневыхРазделов", ДанныеРеглОтчета.СтруктураМногоуровневыхРазделов);
	ПараметрыЗаписи.Вставить("СтруктураРеквизитовФормы", ДанныеРеглОтчета.СтруктураРеквизитовФормы);
	ПараметрыЗаписи.Вставить("ВерсияФормы", ДанныеРеглОтчета.СтруктураРеквизитовФормы.мВерсияФормы);
	ПараметрыЗаписи.Вставить("ФлОтклВыборЗначений", Ложь);
	ПараметрыЗаписи.Вставить("Автозаполнение", Ложь);
	ПараметрыЗаписи.Вставить("ПечатьБезШтрихкодаРазрешена", Неопределено);
	ПараметрыЗаписи.Вставить("ФлПодсчетСтраниц", Неопределено);
	ПараметрыЗаписи.Вставить("СохранятьРасшифровку", Ложь);
	ПараметрыЗаписи.Вставить("АдресВременногоХранилищаРасшифровки",
	ДанныеРеглОтчета.СтруктураРеквизитовФормы.АдресВременногоХранилищаРасшифровки);
	ПараметрыЗаписи.Вставить("ДеревоСтраницОтчета", ДеревоСтраницОтчета);
	ПараметрыЗаписи.Вставить("Вариант", ДанныеРеглОтчета.СтруктураРеквизитовФормы.ВидДокумента);
	ПараметрыЗаписи.Вставить("РазделыОтчета", РазделыОтчета);
	ПараметрыЗаписи.Вставить("НаименованиеОтчета", ДанныеРеглОтчета.СтруктураРеквизитовФормы.НаименованиеОтчета);
	
	НастройкиАвтозаполнения = НастройкиАвтозаполненияОтчета(ПараметрыАвтоформирования);
	Если ЗначениеЗаполнено(НастройкиАвтозаполнения) Тогда
		ПараметрыЗаписи.Вставить("НастройкиАвтозаполнения", НастройкиАвтозаполнения);
	КонецЕсли;
	
	Возврат ЗаписатьРеглОтчет(ИмяФормы, ПараметрыЗаписи);
	
КонецФункции

Функция ПодготовленныйРеглОтчет(ИмяФормы, ПараметрыАвтоформирования, КорректирующийОтчет)
	
	РазделыОтчета = РазделыРеглОтчета(ИмяФормы);
	
	ДанныеРеглОтчета = Новый Структура;
	ДанныеРеглОтчета.Вставить("ДатаПодписи", ТекущаядатаСеанса());
	
	ПараметрыАвтоФормирования.Вставить("ДатаПодписи", ДанныеРеглОтчета.ДатаПодписи);
	
	ЗаполнитьРеглОтчет(ИмяФормы,
					   ПараметрыАвтоформирования,
					   КорректирующийОтчет,
					   РазделыОтчета,
					   ДанныеРеглОтчета);
	
	РазделыОтчета.Титульный.Период = "34";
	РазделыОтчета.Титульный.ОтчетГод = Формат(ПараметрыАвтоформирования.ДатаОкончания, "ДФ=гггг");
	
	РазделыОтчета.Титульный.ДатаПодписи = ДанныеРеглОтчета.ДатаПодписи;
	
	Если ПараметрыАвтоформирования.Свойство("НомерКорректировки") Тогда
		ДанныеРеглОтчета.СтруктураРеквизитовФормы.ВидДокумента = ПараметрыАвтоФормирования.НомерКорректировки;
	Иначе
		ДанныеРеглОтчета.СтруктураРеквизитовФормы.ВидДокумента = ?(КорректирующийОтчет, 1, 0);
	КонецЕсли;
	
	РазделыОтчета.Титульный.НомерКорректировки = ДанныеРеглОтчета.СтруктураРеквизитовФормы.ВидДокумента;
	
	ЗаполнитьСведенияОбОрганизации(ИмяФормы,
								   ДанныеРеглОтчета.СтруктураРеквизитовФормы,
								   ДанныеРеглОтчета.ДатаПодписи,
								   РазделыОтчета.Титульный);
	
	ДеревоСтраницОтчета = СтруктураСтраницОтчета(ИмяФормы, ПараметрыАвтоформирования.ДатаОкончания);
	
	ДанныеРеглОтчета.Вставить("ДеревоСтраницОтчета", ДеревоСтраницОтчета);
	
	ПодготовленныйРеглОтчет = Новый Структура;
	ПодготовленныйРеглОтчет.Вставить("РазделыОтчета",       РазделыОтчета);
	ПодготовленныйРеглОтчет.Вставить("ДанныеРеглОтчета",    ДанныеРеглОтчета);
	ПодготовленныйРеглОтчет.Вставить("ДеревоСтраницОтчета", ДеревоСтраницОтчета);
	
	Возврат ПодготовленныйРеглОтчет;
	
КонецФункции

Процедура СформироватьСтруктуруРеквизитовФормы(ИмяФормы, СтруктураРеквизитовФормы) Экспорт
	
	СтруктураРеквизитовФормы = Новый Структура;
	
	СтруктураРеквизитовФормы.Вставить("мВерсияФормы", "01/01/" + Лев(Прав(СокрЛП(ИмяФормы), 7), 4));
	СтруктураРеквизитовФормы.Вставить("НаименованиеОтчета", "3-НДФЛ (с 2025 года)");
	СтруктураРеквизитовФормы.Вставить("ФлажокОтклАвтоРасчет", Ложь);
	СтруктураРеквизитовФормы.Вставить("ОтображатьКнопкуЗаполнить", Ложь);
	СтруктураРеквизитовФормы.Вставить("ОтображатьКнопкуРасшифровать", Ложь);
	СтруктураРеквизитовФормы.Вставить("АдресВременногоХранилищаРасшифровки");
	СтруктураРеквизитовФормы.Вставить("мСохранятьРасшифровку", Истина);
	СтруктураРеквизитовФормы.Вставить("АвтозаполняемыеПоказатели", Новый Структура);
	СтруктураРеквизитовФормы.Вставить("ВыводитьСтраницуВТаблДокНаСервере");
	СтруктураРеквизитовФормы.Вставить("НаимТекущегоРаздела");
	СтруктураРеквизитовФормы.Вставить("мАвтоВыборКодов");
	СтруктураРеквизитовФормы.Вставить("мБезОткрытияФормы");
	СтруктураРеквизитовФормы.Вставить("мЗаписываетсяНовыйДокумент");
	СтруктураРеквизитовФормы.Вставить("СписокПечатаемыхЛистов", Новый СписокЗначений);
	СтруктураРеквизитовФормы.Вставить("мПечатныеформы", Новый СписокЗначений);
	СтруктураРеквизитовФормы.Вставить("мРежимПечати");
	СтруктураРеквизитовФормы.Вставить("мСчетчикСтраниц");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыР1М1");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыР1М2");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыП1М1");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыП3М1");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыП3М2");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыП7М1");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыП8М1");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыП1РМ1");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыП1РМ2");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыП1РМ3");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыП5РМ1");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыП5РМ2");
	СтруктураРеквизитовФормы.Вставить("ДлинаИмениГруппы");
	СтруктураРеквизитовФормы.Вставить("ДлинаИмениГрафы");
	СтруктураРеквизитовФормы.Вставить("ТочностьЕдиницыИзмерения");
	СтруктураРеквизитовФормы.Вставить("ВидДокумента");
	СтруктураРеквизитовФормы.Вставить("ЕдиницаИзмерения");
	СтруктураРеквизитовФормы.Вставить("мВариант");
	СтруктураРеквизитовФормы.Вставить("мСтрокаФормата");
	СтруктураРеквизитовФормы.Вставить("мВыбраннаяФорма");
	СтруктураРеквизитовФормы.Вставить("мДатаКонцаПериодаОтчета");
	СтруктураРеквизитовФормы.Вставить("мДатаНачалаПериодаОтчета");
	СтруктураРеквизитовФормы.Вставить("мПериодичность");
	СтруктураРеквизитовФормы.Вставить("мСкопированаФорма");
	СтруктураРеквизитовФормы.Вставить("мСохраненныйДок");
	СтруктураРеквизитовФормы.Вставить("мПечатьБезШтрихкодаРазрешена");
	СтруктураРеквизитовФормы.Вставить("Организация");
	СтруктураРеквизитовФормы.Вставить("ИП");
	СтруктураРеквизитовФормы.Вставить("НаимОрганизации");
	СтруктураРеквизитовФормы.Вставить("СтрПериодОтчета");
	СтруктураРеквизитовФормы.Вставить("ТекущаяСтрокаРазделовОтчета");
	СтруктураРеквизитовФормы.Вставить("НомераСтрокМногоуровнегоРаздела");
	СтруктураРеквизитовФормы.Вставить("СтруктураМногострочныхЧастей");
	СтруктураРеквизитовФормы.Вставить("ИдентификаторЗадания");
	СтруктураРеквизитовФормы.Вставить("РезультатЗапускаАвтозаполненияПриСоздании");
	СтруктураРеквизитовФормы.Вставить("АдресВоВременномХранилище");
	СтруктураРеквизитовФормы.Вставить("ДоступенМеханизмПечатиРеглОтчетностиСДвухмернымШтрихкодомPDF417");
	СтруктураРеквизитовФормы.Вставить("СформироватьФормуОтчетаАвтоматически");
	СтруктураРеквизитовФормы.Вставить("СообщенияПослеАвтозаполнения");
	СтруктураРеквизитовФормы.Вставить("АдресВоВременномХранилищеСообщенияПослеАвтозаполнения");
	РегламентированнаяОтчетностьЗагрузка.ДополнитьСтруктуруРеквизитовПараметрамиКопирования(СтруктураРеквизитовФормы);
	
	// ПроцессыОбработкиДокументов
	//
	СтруктураРеквизитовФормы.Вставить("ПустаяСсылкаНаРегламентированныйОтчет",
	Документы.РегламентированныйОтчет.ПустаяСсылка());
	//
	// ПроцессыОбработкиДокументов
	
КонецПроцедуры

Процедура ИнициализироватьМногострочныеЧасти(ИмяФормы, СтруктураРеквизитовФормы) Экспорт
	
	// Свойства, общие для всех многострочных групп.
	СтруктураРеквизитовФормы.ДлинаИмениГруппы = 8;
	СтруктураРеквизитовФормы.ДлинаИмениГрафы  = 13;
	
	// Структура с описанием свойств каждой группы в отдельности.
	СтруктураМногострочныхЧастей = Новый Структура;
	
	// Идентификаторы многострочных групп.
	СтруктураРеквизитовФормы.мИдГруппыР1М1  = "П00001М1";
	СтруктураРеквизитовФормы.мИдГруппыР1М2  = "П00001М2";
	СтруктураРеквизитовФормы.мИдГруппыП1М1  = "П000П1М1";
	СтруктураРеквизитовФормы.мИдГруппыП3М1  = "П000П3М1";
	СтруктураРеквизитовФормы.мИдГруппыП3М2  = "П000П3М2";
	СтруктураРеквизитовФормы.мИдГруппыП7М1  = "П000П7М1";
	СтруктураРеквизитовФормы.мИдГруппыП8М1  = "П000П8М1";
	СтруктураРеквизитовФормы.мИдГруппыП1РМ1 = "П00П1РМ1";
	СтруктураРеквизитовФормы.мИдГруппыП1РМ2 = "П00П1РМ2";
	СтруктураРеквизитовФормы.мИдГруппыП1РМ3 = "П00П1РМ3";
	СтруктураРеквизитовФормы.мИдГруппыП5РМ1 = "П00П5РМ1";
	СтруктураРеквизитовФормы.мИдГруппыП5РМ2 = "П00П5РМ2";
	
	ИменаГраф = Новый Массив;
	ИменаГраф.Добавить("П00001М102003");
	ИменаГраф.Добавить("П00001М103003");
	ИменаГраф.Добавить("П00001М104003");
	ИменаГраф.Добавить("П00001М105003");
	ИменаПодчиненныхГрупп = Новый Массив;
	СтруктураМногострочныхЧастей.Вставить(СтруктураРеквизитовФормы.мИдГруппыР1М1, Новый Структура(
		"ИменаГраф,ИсхКолСтрок,УровеньПодчинения,ИменаПодчиненныхГрупп", ИменаГраф, 1, 0, ИменаПодчиненныхГрупп));
	
	ИменаГраф = Новый Массив;
	ИменаГраф.Добавить("П00001М206003");
	ИменаГраф.Добавить("П00001М207003");
	ИменаГраф.Добавить("П00001М208003");
	ИменаГраф.Добавить("П00001М209003");
	ИменаГраф.Добавить("П00001М210003");
	ИменаГраф.Добавить("П00001М211003");
	ИменаГраф.Добавить("П00001М212003");
	ИменаГраф.Добавить("П00001М213003");
	ИменаГраф.Добавить("П00001М214003");
	ИменаГраф.Добавить("П00001М215003");
	ИменаГраф.Добавить("П00001М216003");
	ИменаГраф.Добавить("П00001М217003");
	ИменаПодчиненныхГрупп = Новый Массив;
	СтруктураМногострочныхЧастей.Вставить(СтруктураРеквизитовФормы.мИдГруппыР1М2, Новый Структура(
		"ИменаГраф,ИсхКолСтрок,УровеньПодчинения,ИменаПодчиненныхГрупп", ИменаГраф, 1, 0, ИменаПодчиненныхГрупп));
	
	ИменаГраф = Новый Массив;
	ИменаГраф.Добавить("П000П1М101003");
	ИменаГраф.Добавить("П000П1М102003");
	ИменаГраф.Добавить("П000П1М103003");
	ИменаГраф.Добавить("П000П1М104003");
	ИменаГраф.Добавить("П000П1М105003");
	ИменаГраф.Добавить("П000П1М106003");
	ИменаГраф.Добавить("П000П1М107003");
	ИменаГраф.Добавить("П000П1М108003");
	ИменаПодчиненныхГрупп = Новый Массив;
	СтруктураМногострочныхЧастей.Вставить(СтруктураРеквизитовФормы.мИдГруппыП1М1, Новый Структура(
		"ИменаГраф,ИсхКолСтрок,УровеньПодчинения,ИменаПодчиненныхГрупп", ИменаГраф, 1, 0, ИменаПодчиненныхГрупп));
	
	ИменаГраф = Новый Массив;
	ИменаГраф.Добавить("П000П3М101003");
	ИменаГраф.Добавить("П000П3М103003");
	ИменаГраф.Добавить("П000П3М104003");
	ИменаГраф.Добавить("П000П3М104103");
	ИменаГраф.Добавить("П000П3М104203");
	ИменаГраф.Добавить("П000П3М104303");
	ИменаГраф.Добавить("П000П3М104403");
	ИменаГраф.Добавить("П000П3М104503");
	ИменаПодчиненныхГрупп = Новый Массив;
	СтруктураМногострочныхЧастей.Вставить(СтруктураРеквизитовФормы.мИдГруппыП3М1, Новый Структура(
		"ИменаГраф,ИсхКолСтрок,УровеньПодчинения,ИменаПодчиненныхГрупп", ИменаГраф, 1, 0, ИменаПодчиненныхГрупп));
	
	ИменаГраф = Новый Массив;
	ИменаГраф.Добавить("П000П3М211003");
	ИменаГраф.Добавить("П000П3М212003");
	ИменаГраф.Добавить("П000П3М213003");
	ИменаГраф.Добавить("П000П3М214003");
	ИменаГраф.Добавить("П000П3М215003");
	ИменаПодчиненныхГрупп = Новый Массив;
	СтруктураМногострочныхЧастей.Вставить(СтруктураРеквизитовФормы.мИдГруппыП3М2, Новый Структура(
		"ИменаГраф,ИсхКолСтрок,УровеньПодчинения,ИменаПодчиненныхГрупп", ИменаГраф, 1, 0, ИменаПодчиненныхГрупп));
	
	ИменаГраф = Новый Массив;
	ИменаГраф.Добавить("П000П7М101003");
	ИменаГраф.Добавить("П000П7М102003");
	ИменаГраф.Добавить("П000П7М103003");
	ИменаГраф.Добавить("П000П7М103203");
	ИменаГраф.Добавить("П000П7М103303");
	ИменаГраф.Добавить("П000П7М104003");
	ИменаГраф.Добавить("П000П7М105003");
	ИменаГраф.Добавить("П000П7М108003");
	ИменаГраф.Добавить("П000П7М109003");
	ИменаПодчиненныхГрупп = Новый Массив;
	СтруктураМногострочныхЧастей.Вставить(СтруктураРеквизитовФормы.мИдГруппыП7М1, Новый Структура(
		"ИменаГраф,ИсхКолСтрок,УровеньПодчинения,ИменаПодчиненныхГрупп", ИменаГраф, 1, 0, ИменаПодчиненныхГрупп));
	
	ИменаГраф = Новый Массив;
	ИменаГраф.Добавить("П000П8М105103");
	ИменаГраф.Добавить("П000П8М105203");
	ИменаПодчиненныхГрупп = Новый Массив;
	СтруктураМногострочныхЧастей.Вставить(СтруктураРеквизитовФормы.мИдГруппыП8М1, Новый Структура(
		"ИменаГраф,ИсхКолСтрок,УровеньПодчинения,ИменаПодчиненныхГрупп", ИменаГраф, 1, 0, ИменаПодчиненныхГрупп));
	
	ИменаГраф = Новый Массив;
	ИменаГраф.Добавить("П00П1РМ101003");
	ИменаГраф.Добавить("П00П1РМ102003");
	ИменаГраф.Добавить("П00П1РМ103003");
	ИменаГраф.Добавить("П00П1РМ104003");
	ИменаГраф.Добавить("П00П1РМ105003");
	ИменаГраф.Добавить("П00П1РМ106003");
	ИменаПодчиненныхГрупп = Новый Массив;
	СтруктураМногострочныхЧастей.Вставить(СтруктураРеквизитовФормы.мИдГруппыП1РМ1, Новый Структура(
		"ИменаГраф,ИсхКолСтрок,УровеньПодчинения,ИменаПодчиненныхГрупп", ИменаГраф, 1, 0, ИменаПодчиненныхГрупп));
	
	ИменаГраф = Новый Массив;
	ИменаГраф.Добавить("П00П1РМ207003");
	ИменаГраф.Добавить("П00П1РМ208003");
	ИменаГраф.Добавить("П00П1РМ209003");
	ИменаГраф.Добавить("П00П1РМ210003");
	ИменаГраф.Добавить("П00П1РМ211003");
	ИменаПодчиненныхГрупп = Новый Массив;
	СтруктураМногострочныхЧастей.Вставить(СтруктураРеквизитовФормы.мИдГруппыП1РМ2, Новый Структура(
		"ИменаГраф,ИсхКолСтрок,УровеньПодчинения,ИменаПодчиненныхГрупп", ИменаГраф, 1, 0, ИменаПодчиненныхГрупп));
	
	ИменаГраф = Новый Массив;
	ИменаГраф.Добавить("П00П1РМ312003");
	ИменаГраф.Добавить("П00П1РМ313003");
	ИменаГраф.Добавить("П00П1РМ314003");
	ИменаПодчиненныхГрупп = Новый Массив;
	СтруктураМногострочныхЧастей.Вставить(СтруктураРеквизитовФормы.мИдГруппыП1РМ3, Новый Структура(
		"ИменаГраф,ИсхКолСтрок,УровеньПодчинения,ИменаПодчиненныхГрупп", ИменаГраф, 1, 0, ИменаПодчиненныхГрупп));
	
	ИменаГраф = Новый Массив;
	ИменаГраф.Добавить("П00П5РМ101003");
	ИменаГраф.Добавить("П00П5РМ102003");
	ИменаГраф.Добавить("П00П5РМ102103");
	ИменаГраф.Добавить("П00П5РМ103003");
	ИменаГраф.Добавить("П00П5РМ104003");
	ИменаГраф.Добавить("П00П5РМ105003");
	ИменаГраф.Добавить("П00П5РМ106003");
	ИменаГраф.Добавить("П00П5РМ106103");
	ИменаПодчиненныхГрупп = Новый Массив;
	СтруктураМногострочныхЧастей.Вставить(СтруктураРеквизитовФормы.мИдГруппыП5РМ1, Новый Структура(
		"ИменаГраф,ИсхКолСтрок,УровеньПодчинения,ИменаПодчиненныхГрупп", ИменаГраф, 1, 0, ИменаПодчиненныхГрупп));
	
	ИменаГраф = Новый Массив;
	ИменаГраф.Добавить("П00П5РМ208003");
	ИменаГраф.Добавить("П00П5РМ209003");
	ИменаГраф.Добавить("П00П5РМ210003");
	ИменаГраф.Добавить("П00П5РМ211003");
	ИменаГраф.Добавить("П00П5РМ212003");
	ИменаГраф.Добавить("П00П5РМ213003");
	ИменаГраф.Добавить("П00П5РМ214003");
	ИменаГраф.Добавить("П00П5РМ215003");
	ИменаГраф.Добавить("П00П5РМ216003");
	ИменаПодчиненныхГрупп = Новый Массив;
	СтруктураМногострочныхЧастей.Вставить(СтруктураРеквизитовФормы.мИдГруппыП5РМ2, Новый Структура(
		"ИменаГраф,ИсхКолСтрок,УровеньПодчинения,ИменаПодчиненныхГрупп", ИменаГраф, 1, 0, ИменаПодчиненныхГрупп));
	
	СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей = СтруктураМногострочныхЧастей;
	
КонецПроцедуры

Процедура ИнициализироватьМногоуровневыеРазделы(ИмяФормы,
												СтруктураРеквизитовФормы,
												СтруктураМногоуровневыхРазделов) Экспорт
	
	СтруктураРеквизитовФормы.НомераСтрокМногоуровнегоРаздела = Новый Массив;
	
	// Формирование структуры свойств многоуровневых разделов.
	//
	СтруктураМногоуровневыхРазделов = Новый Структура;
	
	СтруктураРаздела = Новый Структура;
	ИменаГруппМнЧ = Новый Массив;
	ИменаГруппМнЧ.Добавить(СтруктураРеквизитовФормы.мИдГруппыР1М1);
	ИменаГруппМнЧ.Добавить(СтруктураРеквизитовФормы.мИдГруппыР1М2);
	СтруктураРаздела.Вставить("ИменаГруппМнЧ", ИменаГруппМнЧ);
	СтруктураМногоуровневыхРазделов.Вставить("Раздел1", СтруктураРаздела);
	
	СтруктураРаздела = Новый Структура;
	СтруктураМногоуровневыхРазделов.Вставить("Раздел1Приложение", СтруктураРаздела);
	
	СтруктураРаздела = Новый Структура;
	СтруктураРаздела.Вставить("Многостраничность");
	СтруктураМногоуровневыхРазделов.Вставить("Раздел2", СтруктураРаздела);
	
	СтруктураРаздела = Новый Структура;
	ИменаГруппМнЧ = Новый Массив;
	ИменаГруппМнЧ.Добавить(СтруктураРеквизитовФормы.мИдГруппыП1М1);
	СтруктураРаздела.Вставить("ИменаГруппМнЧ", ИменаГруппМнЧ);
	СтруктураМногоуровневыхРазделов.Вставить("Приложение1", СтруктураРаздела);
	
	СтруктураРаздела = Новый Структура;
	СтруктураРаздела.Вставить("Многостраничность");
	СтруктураМногоуровневыхРазделов.Вставить("Приложение2", СтруктураРаздела);
	
	СтруктураРаздела = Новый Структура;
	ИменаГруппМнЧ = Новый Массив;
	ИменаГруппМнЧ.Добавить(СтруктураРеквизитовФормы.мИдГруппыП3М1);
	ИменаГруппМнЧ.Добавить(СтруктураРеквизитовФормы.мИдГруппыП3М2);
	СтруктураРаздела.Вставить("ИменаГруппМнЧ", ИменаГруппМнЧ);
	СтруктураМногоуровневыхРазделов.Вставить("Приложение3", СтруктураРаздела);
	
	СтруктураРаздела = Новый Структура;
	СтруктураМногоуровневыхРазделов.Вставить("Приложение3Продолжение", СтруктураРаздела);
	
	СтруктураРаздела = Новый Структура;
	СтруктураМногоуровневыхРазделов.Вставить("Приложение4", СтруктураРаздела);
	
	СтруктураРаздела = Новый Структура;
	СтруктураМногоуровневыхРазделов.Вставить("Приложение5", СтруктураРаздела);
	
	СтруктураРаздела = Новый Структура;
	СтруктураМногоуровневыхРазделов.Вставить("Приложение6", СтруктураРаздела);
	
	СтруктураРаздела = Новый Структура;
	ИменаГруппМнЧ = Новый Массив;
	ИменаГруппМнЧ.Добавить(СтруктураРеквизитовФормы.мИдГруппыП7М1);
	СтруктураРаздела.Вставить("ИменаГруппМнЧ", ИменаГруппМнЧ);
	СтруктураМногоуровневыхРазделов.Вставить("Приложение7", СтруктураРаздела);
	
	СтруктураРаздела = Новый Структура;
	СтруктураРаздела.Вставить("Многостраничность");
	ИменаГруппМнЧ = Новый Массив;
	ИменаГруппМнЧ.Добавить(СтруктураРеквизитовФормы.мИдГруппыП8М1);
	СтруктураРаздела.Вставить("ИменаГруппМнЧ", ИменаГруппМнЧ);
	СтруктураМногоуровневыхРазделов.Вставить("Приложение8", СтруктураРаздела);
	
	СтруктураРаздела = Новый Структура;
	ИменаГруппМнЧ = Новый Массив;
	ИменаГруппМнЧ.Добавить(СтруктураРеквизитовФормы.мИдГруппыП1РМ1);
	ИменаГруппМнЧ.Добавить(СтруктураРеквизитовФормы.мИдГруппыП1РМ2);
	ИменаГруппМнЧ.Добавить(СтруктураРеквизитовФормы.мИдГруппыП1РМ3);
	СтруктураРаздела.Вставить("ИменаГруппМнЧ", ИменаГруппМнЧ);
	СтруктураМногоуровневыхРазделов.Вставить("Приложение1Расчет", СтруктураРаздела);
	
	СтруктураРаздела = Новый Структура;
	ИменаГруппМнЧ = Новый Массив;
	ИменаГруппМнЧ.Добавить(СтруктураРеквизитовФормы.мИдГруппыП5РМ1);
	ИменаГруппМнЧ.Добавить(СтруктураРеквизитовФормы.мИдГруппыП5РМ2);
	СтруктураРаздела.Вставить("ИменаГруппМнЧ", ИменаГруппМнЧ);
	СтруктураМногоуровневыхРазделов.Вставить("Приложение5Расчет", СтруктураРаздела);
	
	// Формирование начальной структуры дерева разделов
	// с заполнением каждого уровня пустыми данными.
	//
	ДеревоДанных = Новый ДеревоЗначений;
	ДеревоДанных.Колонки.Добавить("Данные");
	ДеревоДанных.Колонки.Добавить("ДанныеМногострочныхЧастей");
	
	ТабличныйДокумент = Новый ТабличныйДокумент;
	
	Для каждого Элем Из СтруктураМногоуровневыхРазделов Цикл
		Если Элем.Значение.Свойство("Подчиненность") Тогда
			Продолжить;
		КонецЕсли;
		
		ДеревоДанныхРаздела = ДеревоДанных.Скопировать();
		ТекВетка = ДеревоДанныхРаздела.Строки.Добавить();
		
		ТабличныйДокумент.Очистить();
		ТабличныйДокумент.Вывести(ЭтотОбъект.ПолучитьМакет(ИмяФормы + "_" + Элем.Ключ));
		
		ДанныеТаблДокумента = ДанныеТабличногоДокумента(ИмяФормы,
														Элем.Ключ,
														СтруктураМногоуровневыхРазделов,
														ТабличныйДокумент,
														СтруктураРеквизитовФормы);
		
		ТекВетка.Данные = ДанныеТаблДокумента.Данные;
		ТекВетка.ДанныеМногострочныхЧастей = ДанныеТаблДокумента.ДанныеМногострочныхЧастей;
		
		ИнициализироватьПодчиненныеРазделы(ИмяФормы,
										   Элем.Ключ,
										   ТекВетка,
										   СтруктураМногоуровневыхРазделов,
										   ТабличныйДокумент,
										   СтруктураРеквизитовФормы);
		
		Если НЕ СтруктураРеквизитовФормы.Свойство("АдресВоВрХранилищеДеревоДанных" + Элем.Ключ) Тогда
			СтруктураРеквизитовФормы.Вставить("АдресВоВрХранилищеДеревоДанных" + Элем.Ключ, Неопределено);
		КонецЕсли;
		
		РегламентированнаяОтчетность.ПоместитьВКэш(ДеревоДанныхРаздела, Новый УникальныйИдентификатор,
		СтруктураРеквизитовФормы["АдресВоВрХранилищеДеревоДанных" + Элем.Ключ]);
	КонецЦикла;
	
КонецПроцедуры

Функция ДанныеТабличногоДокумента(ИмяФормы,
								  НаимРаздела,
								  СтруктураМногоуровневыхРазделов,
								  ТабличныйДокумент,
								  СтруктураРеквизитовФормы) Экспорт
	
	ДанныеТаблДокумента = Новый Структура;
	
	// Многоуровневые разделы.
	//
	Если СтруктураМногоуровневыхРазделов.Свойство(НаимРаздела) Тогда
		
		СтруктураРаздела = СтруктураМногоуровневыхРазделов[НаимРаздела];
		
		ИменаГруппМнЧ = Неопределено;
		СтруктураРаздела.Свойство("ИменаГруппМнЧ", ИменаГруппМнЧ);
		РазделСодержитМнЧ = (ИменаГруппМнЧ <> Неопределено);
		
		СтруктураДанных = Новый Структура();
		Для Каждого ТекущаяОбласть Из ТабличныйДокумент.Области Цикл
			Если СтрЧислоВхождений(Тип(ТекущаяОбласть), "Рисунок") = 0
				И ТекущаяОбласть.ТипОбласти = ТипОбластиЯчеекТабличногоДокумента.Прямоугольник
				И ТекущаяОбласть.СодержитЗначение = Истина Тогда
				Если РазделСодержитМнЧ Тогда
					Если РегламентированнаяОтчетностьКлиентСервер.МногострочнаяЧастьТекущейОбласти(
						СтруктураРеквизитовФормы, ТекущаяОбласть.Имя) = Неопределено Тогда
						СтруктураДанных.Вставить(ТекущаяОбласть.Имя, ТекущаяОбласть.Значение);
					КонецЕсли;
				Иначе
					СтруктураДанных.Вставить(ТекущаяОбласть.Имя, ТекущаяОбласть.Значение);
				КонецЕсли;
			КонецЕсли;
		КонецЦикла;
		ДанныеТаблДокумента.Вставить("Данные", СтруктураДанных);
		
		СтруктураДанныхМногострочныхЧастей = Новый Структура;
		Если РазделСодержитМнЧ Тогда
			Для каждого ИмяГруппыМнЧ Из СтруктураРаздела["ИменаГруппМнЧ"] Цикл
				ЭлемСтруктуры = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппыМнЧ];
				Если ЭлемСтруктуры["УровеньПодчинения"] = 0 Тогда
					ДеревоДанных = Новый ДеревоЗначений;
					ДеревоДанных.Колонки.Добавить("Данные");
					ДеревоДанных.Колонки.Добавить("ДанныеМногострочныхЧастей");
					СформироватьДеревоМногострочнойЧастиПоДаннымТабличногоДокумента(
						ИмяФормы, СтруктураРеквизитовФормы, ТабличныйДокумент, ИмяГруппыМнЧ, ДеревоДанных);
					СтруктураДанныхМногострочныхЧастей.Вставить(ИмяГруппыМнЧ, ДеревоДанных);
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		ДанныеТаблДокумента.Вставить("ДанныеМногострочныхЧастей", СтруктураДанныхМногострочныхЧастей);
		
	// Обычные разделы.
	//
	Иначе
		
		Для Инд = 0 По ТабличныйДокумент.Области.Количество() - 1 Цикл
			
			ТекОбласть = ТабличныйДокумент.Области[Инд];
			
			Если СтрЧислоВхождений(Тип(ТекОбласть), "Рисунок") = 0
				И ТекОбласть.ТипОбласти = ТипОбластиЯчеекТабличногоДокумента.Прямоугольник
				И ТекОбласть.СодержитЗначение = Истина Тогда
				
				ДанныеТаблДокумента.Вставить(ТекОбласть.Имя, ТекОбласть.Значение);
				
			КонецЕсли;
			
		КонецЦикла;
		
	КонецЕсли;
	
	Возврат ДанныеТаблДокумента;
	
КонецФункции

Процедура ИнициализироватьПодчиненныеРазделы(ИмяФормы,
											 Знач ИмяРаздела,
											 Ветка,
											 СтруктураМногоуровневыхРазделов,
											 ТабличныйДокумент,
											 СтруктураРеквизитовФормы) Экспорт
	
	Если СтруктураМногоуровневыхРазделов[ИмяРаздела].Свойство("ИменаПодчиненныхРазделов") Тогда
		
		ИменаПодчРазделов = СтруктураМногоуровневыхРазделов[ИмяРаздела]["ИменаПодчиненныхРазделов"];
		Для каждого ИмяПодчРаздела Из ИменаПодчРазделов Цикл
			ПодчВетка = Ветка.Строки.Добавить().Строки.Добавить();
			
			ТабличныйДокумент.Очистить();
			ТабличныйДокумент.Вывести(ЭтотОбъект.ПолучитьМакет(ИмяФормы + "_" + ИмяПодчРаздела));
			
			ДанныеТаблДокумента = ДанныеТабличногоДокумента(ИмяФормы,
															ИмяПодчРаздела,
															СтруктураМногоуровневыхРазделов,
															ТабличныйДокумент,
															СтруктураРеквизитовФормы);
									
			ПодчВетка.Данные = ДанныеТаблДокумента.Данные;
			ПодчВетка.ДанныеМногострочныхЧастей = ДанныеТаблДокумента.ДанныеМногострочныхЧастей;
			
			ИнициализироватьПодчиненныеРазделы(ИмяФормы,
											   ИмяПодчРаздела,
											   ПодчВетка,
											   СтруктураМногоуровневыхРазделов,
											   ТабличныйДокумент,
											   СтруктураРеквизитовФормы);
		КонецЦикла;
		
	КонецЕсли;
	
КонецПроцедуры

Процедура ИнициализироватьОбычныеРазделы(ИмяФормы,
										 СтруктураРеквизитовФормы,
										 СтруктураМногоуровневыхРазделов,
										 СтруктураДанныхРазделов,
										 МассивИменРазделов = Неопределено) Экспорт
	
	Если МассивИменРазделов = Неопределено Тогда
		
		МассивИменРазделов = Новый Массив;
		МассивИменРазделов.Добавить("Титульный");
		
	КонецЕсли;
	
	ТабличныйДокумент = Новый ТабличныйДокумент;
	
	Для Каждого ИмяРаздела Из МассивИменРазделов Цикл
		
		ТабличныйДокумент.Очистить();
		ТабличныйДокумент.Вывести(ЭтотОбъект.ПолучитьМакет(ИмяФормы + "_" + ИмяРаздела));
		
		СохранитьДанныеРаздела(ИмяФормы,
							   СтруктураРеквизитовФормы,
							   СтруктураМногоуровневыхРазделов,
							   СтруктураДанныхРазделов,
							   ТабличныйДокумент,
							   ИмяРаздела);
		
	КонецЦикла;
	
КонецПроцедуры

Процедура СохранитьДанныеРаздела(ИмяФормы,
								 СтруктураРеквизитовФормы,
								 СтруктураМногоуровневыхРазделов,
								 СтруктураДанныхРазделов,
								 ТабличныйДокумент,
								 НаимРаздела,
								 ВеткаРаздела = Неопределено) Экспорт
	
	// Многоуровневые разделы.
	Если СтруктураМногоуровневыхРазделов.Свойство(НаимРаздела) Тогда
		
		Если ВеткаРаздела = Неопределено Тогда
			
			СтруктураРаздела = СтруктураМногоуровневыхРазделов[НаимРаздела];
			
			ИмяГлРаздела = Неопределено;
			СтруктураРаздела.Свойство("ИмяГлавногоРаздела", ИмяГлРаздела);
			ИмяГлРаздела = ?(ИмяГлРаздела = Неопределено, НаимРаздела, ИмяГлРаздела);
			
			ДеревоДанныхРаздела = ПолучитьИзВременногоХранилища(
				СтруктураРеквизитовФормы["АдресВоВрХранилищеДеревоДанных" + ИмяГлРаздела]);
			
			ТекВетка = ДеревоДанныхРаздела;
			
			Для Каждого НомерСтроки Из СтруктураРеквизитовФормы.НомераСтрокМногоуровнегоРаздела Цикл
				ТекВетка = ТекВетка.Строки[НомерСтроки - 1];
			КонецЦикла;
			
		Иначе
			
			ТекВетка = ВеткаРаздела;
			
		КонецЕсли;
		
		ДанныеТаблДокумента = ДанныеТабличногоДокумента(ИмяФормы,
														НаимРаздела,
														СтруктураМногоуровневыхРазделов,
														ТабличныйДокумент,
														СтруктураРеквизитовФормы);
		
		ТекВетка.Данные = ДанныеТаблДокумента.Данные;
		ТекВетка.ДанныеМногострочныхЧастей = ДанныеТаблДокумента.ДанныеМногострочныхЧастей;
		
		РегламентированнаяОтчетность.ПоместитьВКэш(ДеревоДанныхРаздела, Новый УникальныйИдентификатор,
		СтруктураРеквизитовФормы["АдресВоВрХранилищеДеревоДанных" + ИмяГлРаздела]);
		
		ДеревоДанныхРаздела = Неопределено;
		
	// Обычные разделы.
	Иначе
		
		СтруктураДанныхРазделов["СтруктураДанных" + НаимРаздела]
			= ДанныеТабличногоДокумента(ИмяФормы,
										НаимРаздела,
		 						  		СтруктураМногоуровневыхРазделов,
										ТабличныйДокумент,
										СтруктураРеквизитовФормы);
		
	КонецЕсли;
	
КонецПроцедуры

Функция СтруктураСтраницОтчета(ИмяФормы, ДатаКонцаПериодаОтчета = Неопределено) Экспорт
	
	ДеревоСтраницОтчета = Новый ДеревоЗначений;
	
	ДеревоСтраницОтчета.Колонки.Добавить("Представление",
		Новый ОписаниеТипов("Строка", , Новый КвалификаторыСтроки(100)));
	ДеревоСтраницОтчета.Колонки.Добавить("ИмяСтраницы",
		Новый ОписаниеТипов("Строка", , Новый КвалификаторыСтроки(100)));
	ДеревоСтраницОтчета.Колонки.Добавить("ИмяПоляТабличногоДокум",
		Новый ОписаниеТипов("Строка", , Новый КвалификаторыСтроки(100)));
	ДеревоСтраницОтчета.Колонки.Добавить("ИмяОбластиТабличногоПоля",
		Новый ОписаниеТипов("Строка", , Новый КвалификаторыСтроки(100)));
	ДеревоСтраницОтчета.Колонки.Добавить("ОриентацияСтраницы");
	ДеревоСтраницОтчета.Колонки.Добавить("ВыводНаПечать",
		Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(1, 0)));
	ДеревоСтраницОтчета.Колонки.Добавить("ПоказатьСтраницу",
		Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(1, 0)));
	ДеревоСтраницОтчета.Колонки.Добавить("ВыгрузитьСтраницу",
		Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(1, 0)));
	
	ДеревоСтраницОтчета.Строки.Очистить();
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Титульный";
	СтрокаУровня1.Представление      = "Титульный лист";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Раздел1";
	СтрокаУровня1.Представление      = "Раздел 1";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Раздел1Приложение";
	СтрокаУровня1.Представление      = "Приложение к Разделу 1";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Раздел2";
	СтрокаУровня1.Представление      = "Раздел 2";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Приложение1";
	СтрокаУровня1.Представление      = "Приложение 1";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Приложение2";
	СтрокаУровня1.Представление      = "Приложение 2";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Приложение3";
	СтрокаУровня1.Представление      = "Приложение 3";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Приложение3Продолжение";
	СтрокаУровня1.Представление      = "Приложение 3 (продолжение)";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Приложение4";
	СтрокаУровня1.Представление      = "Приложение 4";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Приложение5";
	СтрокаУровня1.Представление      = "Приложение 5";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Приложение6";
	СтрокаУровня1.Представление      = "Приложение 6";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Приложение7";
	СтрокаУровня1.Представление      = "Приложение 7";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Приложение8";
	СтрокаУровня1.Представление      = "Приложение 8";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Приложение1Расчет";
	СтрокаУровня1.Представление      = "Расчет к Приложению 1";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	СтрокаУровня1 = ДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы        = "Приложение5Расчет";
	СтрокаУровня1.Представление      = "Расчет к Приложению 5";
	СтрокаУровня1.ОриентацияСтраницы = "Портрет";
	СтрокаУровня1.ВыводНаПечать      = 1;
	СтрокаУровня1.ПоказатьСтраницу   = 1;
	СтрокаУровня1.ВыгрузитьСтраницу  = 2;
	
	Возврат ДеревоСтраницОтчета;
	
КонецФункции

Функция СтруктураДанныхРазделов(ИмяФормы) Экспорт
	
	СтруктураДанныхРазделов = Новый Структура;
	
	СтруктураДанныхРазделов.Вставить("СтруктураДанныхТитульный", Новый Структура);
	
	Возврат СтруктураДанныхРазделов;
	
КонецФункции

Процедура ЗаполнитьЗначенияПоУмолчанию(ИмяФормы,
									   СтруктураРеквизитовФормы,
									   СтруктураДанныхРазделов) Экспорт
	
	Возврат;
	
КонецПроцедуры

Процедура ЗаполнитьСведенияОбОрганизации(ИмяФормы,
										 СтруктураРеквизитовФормы,
										 ДатаПодписи,
										 СтруктураДанныхТитульный,
										 СтруктураДанныхФизЛицо = Неопределено,
										 ВПрограммеИзмененаДатаПодписи = Ложь) Экспорт
	
	СсылкаНаРегистрациюВНО = РеквизитЭлементаСправочника(ИмяФормы, СтруктураРеквизитовФормы.Организация);
	
	Если НЕ ВПрограммеИзмененаДатаПодписи Тогда
		
		СтрокаСведений = "ИННЮЛ, КодНО, ФИО, ДатаРожд, КодУдЛичн, СерияУдЛичн,
		|НомерУдЛичн, ТелСлуж, ТелДом, СистемыНалогообложения, ЭтоФизическоеЛицо";
		
		СведенияОбОрганизации = РегламентированнаяОтчетностьВызовСервера.ПолучитьСведенияОбОрганизации(
		СтруктураРеквизитовФормы.Организация, ДатаПодписи, СтрокаСведений);
		
		ИНН = СокрЛП(СведенияОбОрганизации.ИННЮЛ);
		
		КодНО = СтроковыеФункцииКлиентСервер.ДополнитьСтроку(СведенияОбОрганизации.КодНО, 4, " ", "Слева");
		
		КодСтраны = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(Справочники.СтраныМира.Россия, "Код");
		
		Если СведенияОбОрганизации.ЭтоФизическоеЛицо = Истина Тогда
			// Иное физическое лицо.
			КодКатегорииНалогоплательщика = "760";
		Иначе
			// Физическое лицо, зарегистрированное в качестве индивидуального предпринимателя.
			КодКатегорииНалогоплательщика = "720";
			Если ЗначениеЗаполнено(СведенияОбОрганизации.СистемыНалогообложения) Тогда
				МассивСистемНалогообложения
					= СтрРазделить(СтрЗаменить(ВРег(СведенияОбОрганизации.СистемыНалогообложения), " ", ""), ",");
				Если МассивСистемНалогообложения.Найти("ОСНО") = Неопределено Тогда
					// Иное физическое лицо.
					КодКатегорииНалогоплательщика = "760";
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		ФИО = РегламентированнаяОтчетность.РазложитьФИО(СведенияОбОрганизации.ФИО);
		Фамилия  = СокрЛП(ФИО.Фамилия);
		Имя      = СокрЛП(ФИО.Имя);
		Отчество = СокрЛП(ФИО.Отчество);
		
		ДатаРождения = СведенияОбОрганизации.ДатаРожд;
		
		КодВидаДокумента = СокрЛП(СведенияОбОрганизации.КодУдЛичн);
		СерияИНомерДокумента
			= СтрШаблон("%1 %2", СокрЛП(СведенияОбОрганизации.СерияУдЛичн), СокрЛП(СведенияОбОрганизации.НомерУдЛичн));
		
		// Физическое лицо - налоговый резидент Российской Федерации.
		КодСтатусаНалогоплательщика = "1";
		
		НомерТелефона
			= ?(ЗначениеЗаполнено(СведенияОбОрганизации.ТелСлуж), СведенияОбОрганизации.ТелСлуж, СведенияОбОрганизации.ТелДом);
		НомерТелефона = СтрЗаменить(НомерТелефона, " ", "");
		НомерТелефона = СтрЗаменить(НомерТелефона, "-", "");
		
		Если ТипЗнч(СтруктураДанныхТитульный) = Тип("ТабличныйДокумент") Тогда
			
			СтруктураДанныхТитульный.Области.ИНН.Значение = ИНН;
			СтруктураДанныхТитульный.Области.НалоговыйОрган.Значение = КодНО;
			СтруктураДанныхТитульный.Области.КодСтраны.Значение = КодСтраны;
			СтруктураДанныхТитульный.Области.КодКатегорииНалогоплательщика.Значение = КодКатегорииНалогоплательщика;
			СтруктураДанныхТитульный.Области.Фамилия.Значение = Фамилия;
			СтруктураДанныхТитульный.Области.Имя.Значение = Имя;
			СтруктураДанныхТитульный.Области.Отчество.Значение = Отчество;
			СтруктураДанныхТитульный.Области.ДатаРождения.Значение = ДатаРождения;
			СтруктураДанныхТитульный.Области.КодВидаДокумента.Значение = КодВидаДокумента;
			СтруктураДанныхТитульный.Области.СерияИНомерДокумента.Значение = СерияИНомерДокумента;
			СтруктураДанныхТитульный.Области.КодСтатусаНалогоплательщика.Значение = КодСтатусаНалогоплательщика;
			СтруктураДанныхТитульный.Области.НомерТелефона.Значение = НомерТелефона;
			СтруктураДанныхТитульный.Области.ДатаПодписи.Значение = ДатаПодписи;
			
		ИначеЕсли ТипЗнч(СтруктураДанныхТитульный) = Тип("Структура") Тогда
			
			СтруктураДанныхТитульный.ИНН = ИНН;
			СтруктураДанныхТитульный.НалоговыйОрган = КодНО;
			СтруктураДанныхТитульный.КодСтраны = КодСтраны;
			СтруктураДанныхТитульный.КодКатегорииНалогоплательщика = КодКатегорииНалогоплательщика;
			СтруктураДанныхТитульный.Фамилия = Фамилия;
			СтруктураДанныхТитульный.Имя = Имя;
			СтруктураДанныхТитульный.Отчество = Отчество;
			СтруктураДанныхТитульный.ДатаРождения = ДатаРождения;
			СтруктураДанныхТитульный.КодВидаДокумента = КодВидаДокумента;
			СтруктураДанныхТитульный.СерияИНомерДокумента = СерияИНомерДокумента;
			СтруктураДанныхТитульный.КодСтатусаНалогоплательщика = КодСтатусаНалогоплательщика;
			СтруктураДанныхТитульный.НомерТелефона = НомерТелефона;
			СтруктураДанныхТитульный.ДатаПодписи = ДатаПодписи;
			
		КонецЕсли;
		
	КонецЕсли;
	
	ЗаполнитьСведенияОПодписантах(ИмяФормы,
	СтруктураРеквизитовФормы, СтруктураДанныхТитульный, ДатаПодписи, СсылкаНаРегистрациюВНО);
	
КонецПроцедуры

Процедура ЗаполнитьСведенияОПодписантах(ИмяФормы,
										СтруктураРеквизитовФормы,
										СтруктураДанныхТитульный,
										ДатаПодписи,
										СсылкаНаРегистрациюВНО = Неопределено) Экспорт
	
	Если ТипЗнч(СтруктураДанныхТитульный) = Тип("ТабличныйДокумент") Тогда
		КодНО = СокрЛП(СтруктураДанныхТитульный.Области.НалоговыйОрган.Значение);
	ИначеЕсли ТипЗнч(СтруктураДанныхТитульный) = Тип("Структура") Тогда
		КодНО = СокрЛП(СтруктураДанныхТитульный.НалоговыйОрган);
	КонецЕсли;
	
	Если СсылкаНаРегистрациюВНО <> Неопределено Тогда
		СведенияОПредставителе = РегламентированнаяОтчетностьВызовСервера.ПолучитьПоКодамСведенияОПредставителе(
		СтруктураРеквизитовФормы.Организация, КодНО, , СсылкаНаРегистрациюВНО.КодПоОКТМО);
	Иначе
		СведенияОПредставителе = РегламентированнаяОтчетностьВызовСервера.ПолучитьПоКодамСведенияОПредставителе(
		СтруктураРеквизитовФормы.Организация, КодНО);
	КонецЕсли;
	
	Если СведенияОПредставителе.ТипПодписанта = "2" Тогда
		ФИОПодписант = РегламентированнаяОтчетность.РазложитьФИО(СведенияОПредставителе.ФИОПредставителя);
		ДокументПредставителя = СведенияОПредставителе.ДокументПредставителя;
	Иначе
		ФИОПодписант = Новый Структура("Фамилия,Имя,Отчество", "", "", "");
		ДокументПредставителя = "";
	КонецЕсли;
	
	ТипПодписанта = СокрЛП(СведенияОПредставителе.ТипПодписанта);
	Если ТипПодписанта = "2" Тогда
		ФИО = РегламентированнаяОтчетность.РазложитьФИО(СведенияОПредставителе.ФИОПредставителя);
		ДокументПредставителя = СведенияОПредставителе.ДокументПредставителя;
	Иначе
		ФИО = Новый Структура("Фамилия,Имя,Отчество", "", "", "");
		ДокументПредставителя = "";
	КонецЕсли;
	
	ФамилияПодписанта  = СокрЛП(ФИО.Фамилия);
	ИмяПодписанта      = СокрЛП(ФИО.Имя);
	ОтчествоПодписанта = СокрЛП(ФИО.Отчество);
	
	Если ТипЗнч(СтруктураДанныхТитульный) = Тип("ТабличныйДокумент") Тогда
		
		СтруктураДанныхТитульный.Области.ПрПодп.Значение = ТипПодписанта;
		СтруктураДанныхТитульный.Области.ФамилияПодписанта.Значение = ФамилияПодписанта;
		СтруктураДанныхТитульный.Области.ИмяПодписанта.Значение = ИмяПодписанта;
		СтруктураДанныхТитульный.Области.ОтчествоПодписанта.Значение = ОтчествоПодписанта;
		СтруктураДанныхТитульный.Области.ДокУпПред.Значение = ДокументПредставителя;
		
	ИначеЕсли ТипЗнч(СтруктураДанныхТитульный) = Тип("Структура") Тогда
		
		СтруктураДанныхТитульный.ПрПодп = ТипПодписанта;
		СтруктураДанныхТитульный.ФамилияПодписанта = ФамилияПодписанта;
		СтруктураДанныхТитульный.ИмяПодписанта = ИмяПодписанта;
		СтруктураДанныхТитульный.ОтчествоПодписанта = ОтчествоПодписанта;
		СтруктураДанныхТитульный.ДокУпПред = ДокументПредставителя;
		
	КонецЕсли;
	
КонецПроцедуры

Функция РеквизитЭлементаСправочника(ИмяФормы, Ссылка) Экспорт
	
	Если Ссылка.Метаданные().Реквизиты.Найти("РегистрацияВНалоговомОргане") <> Неопределено Тогда
		Возврат Ссылка.РегистрацияВНалоговомОргане;
	КонецЕсли;
	
	Возврат Неопределено;
	
КонецФункции

Функция РазделыРеглОтчета(ИмяФормы) Экспорт
	
	РазделыОтчета = Новый Структура;
	РазделыОтчета.Вставить("Титульный", Новый Структура);
	
	РазделыОтчета.Вставить("ДанныеМногоуровневыхРазделов", Новый Структура);
	
	Возврат РазделыОтчета;
	
КонецФункции

Функция ЗаписатьДокумент(ИмяФормы, ПараметрыЗаписи) Экспорт
	
	ДокументРегламентированныйОтчет = ПараметрыЗаписи.СохраняемыйРеглОтчет;
	
	ДокументРегламентированныйОтчет.ИсточникОтчета           = ПараметрыЗаписи.ИсточникОтчета;
	ДокументРегламентированныйОтчет.НаименованиеОтчета       = ПараметрыЗаписи.НаименованиеОтчета;
	ДокументРегламентированныйОтчет.ДатаНачала               = ПараметрыЗаписи.ДатаНачала;
	ДокументРегламентированныйОтчет.ДатаОкончания            = ПараметрыЗаписи.ДатаОкончания;
	ДокументРегламентированныйОтчет.Периодичность            = Перечисления.Периодичность.Квартал;
	ДокументРегламентированныйОтчет.ВыбраннаяФорма           = ПараметрыЗаписи.ИмяФормыОтчета;
	ДокументРегламентированныйОтчет.Организация              = ПараметрыЗаписи.Организация;
	ДокументРегламентированныйОтчет.ДатаПодписи              = ПараметрыЗаписи.ДатаПодписи;
	ДокументРегламентированныйОтчет.ЕдиницаИзмерения         = ПараметрыЗаписи.ЕдиницаИзмерения;
	ДокументРегламентированныйОтчет.ТочностьЕдиницыИзмерения = ПараметрыЗаписи.ТочностьЕдиницыИзмерения;
	ДокументРегламентированныйОтчет.ВидОтчетности            = Перечисления.ВидыОтчетности.РегламентированнаяОтчетность;
	ДокументРегламентированныйОтчет.Комментарий              = ПараметрыЗаписи.Комментарий;
	ДокументРегламентированныйОтчет.КодНалоговогоОргана      = ПараметрыЗаписи.КодИФНС;
	ДокументРегламентированныйОтчет.КПП                      = ПараметрыЗаписи.КПП;
	ДокументРегламентированныйОтчет.Вид                      = ПараметрыЗаписи.Вариант;
	ДокументРегламентированныйОтчет.ФорматВыгрузки           = "Автоматически";
	ДокументРегламентированныйОтчет.ПредставлениеВида
		= РегламентированнаяОтчетность.ПредставлениеВидаДокумента(ДокументРегламентированныйОтчет.Вид);
	
	ПоказателиОтчета = Новый Структура;
	ПоказателиОтчета.Вставить("ПолеТабличногоДокументаТитульный", ПараметрыЗаписи.РазделыОтчета.Титульный);
	
	СписокСохранения = Новый Структура;
	СписокСохранения.Вставить("ПоказателиОтчета", ПоказателиОтчета);
	
	// Вставляем данные многоуровневых разделов.
	ДанныеМногоуровневыхРазделов = Новый Структура;
	Для Каждого Элем Из ПараметрыЗаписи.СтруктураМногоуровневыхРазделов Цикл
		СтруктураРаздела = Элем.Значение;
		Если НЕ СтруктураРаздела.Свойство("Подчиненность") Тогда
			ДанныеМногоуровневыхРазделов.Вставить(Элем.Ключ, ПолучитьИзВременногоХранилища(
			ПараметрыЗаписи.СтруктураРеквизитовФормы["АдресВоВрХранилищеДеревоДанных" + Элем.Ключ]));
		КонецЕсли;
	КонецЦикла;
	СписокСохранения.Вставить("ДанныеМногоуровневыхРазделов", ДанныеМногоуровневыхРазделов);
	СписокСохранения.Вставить("ВерсияФормы",                  ПараметрыЗаписи.ВерсияФормы);
	СписокСохранения.Вставить("ФлОтклВыборЗначений",          ПараметрыЗаписи.ФлОтклВыборЗначений);
	СписокСохранения.Вставить("Автозаполнение",               ПараметрыЗаписи.Автозаполнение);
	СписокСохранения.Вставить("ПечатьБезШтрихкодаРазрешена",  ПараметрыЗаписи.ПечатьБезШтрихкодаРазрешена);
	СписокСохранения.Вставить("ФлПодсчетСтраниц",             ПараметрыЗаписи.ФлПодсчетСтраниц);
	
	СписокСохранения.Вставить("СохранятьРасшифровку", ПараметрыЗаписи.СохранятьРасшифровку);
	
	Если ПараметрыЗаписи.АдресВременногоХранилищаРасшифровки <> Неопределено Тогда
		ТаблицаРасшифровки = ПолучитьИзВременногоХранилища(ПараметрыЗаписи.АдресВременногоХранилищаРасшифровки);
		Если ПараметрыЗаписи.СохранятьРасшифровку = Истина Тогда
			СписокСохранения.Вставить("Расшифровка", ТаблицаРасшифровки);
		КонецЕсли;
	КонецЕсли;
	
	НастройкиАвтозаполнения = НастройкиАвтозаполненияОтчета(ПараметрыЗаписи);
	Если ЗначениеЗаполнено(НастройкиАвтозаполнения) Тогда
		СписокСохранения.Вставить("ДанныеПомощникаЗаполнения", НастройкиАвтозаполнения);
	КонецЕсли;
	
	ДокументРегламентированныйОтчет.ДанныеОтчета = Новый ХранилищеЗначения(СписокСохранения, Новый СжатиеДанных(9));
	
	ДокументРегламентированныйОтчет.ДеревоНастройкиСтраниц = Новый ХранилищеЗначения(ПараметрыЗаписи.ДеревоСтраницОтчета);
	
	Попытка
		
		ДокументРегламентированныйОтчет.Записать();
		
		ДокументРегламентированныйОтчет.Разблокировать();
		
	Исключение
		
		ТекстСообщения = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр("ru = '%1';
																						|en = '%1'"),
		РегламентированнаяОтчетностьКлиентСервер.СформироватьТекстСообщения(ОписаниеОшибки()));
		
		РегламентированнаяОтчетность.ДобавитьОшибкуФормированияРеглОтчета(ПараметрыЗаписи, ТекстСообщения);
		
		ДокументРегламентированныйОтчет.Разблокировать();
		
		Возврат Ложь;
		
	КонецПопытки;
	
	Возврат Истина;
	
КонецФункции

Процедура ИнициализироватьМногоуровневыйРаздел(ИмяФормы,
											   СтруктураРеквизитовФормы,
											   СтруктураМногоуровневыхРазделов,
											   ИмяРаздела) Экспорт
	
	УдалитьИзВременногоХранилища(СтруктураРеквизитовФормы["АдресВоВрХранилищеДеревоДанных" + ИмяРаздела]);
	
	ДеревоДанныхРаздела = Новый ДеревоЗначений;
	ДеревоДанныхРаздела.Колонки.Добавить("Данные");
	ДеревоДанныхРаздела.Колонки.Добавить("ДанныеМногострочныхЧастей");
	
	ТабличныйДокумент = Новый ТабличныйДокумент;
	
	ТекВетка = ДеревоДанныхРаздела.Строки.Добавить();
	
	ТабличныйДокумент.Очистить();
	ТабличныйДокумент.Вывести(ЭтотОбъект.ПолучитьМакет(ИмяФормы + "_" + ИмяРаздела));
	
	ДанныеТаблДокумента = ДанныеТабличногоДокумента(ИмяФормы,
													ИмяРаздела,
													СтруктураМногоуровневыхРазделов,
													ТабличныйДокумент,
													СтруктураРеквизитовФормы);
	
	ТекВетка.Данные = ДанныеТаблДокумента.Данные;
	ТекВетка.ДанныеМногострочныхЧастей = ДанныеТаблДокумента.ДанныеМногострочныхЧастей;
	
	ИнициализироватьПодчиненныеРазделы(ИмяФормы,
									   ИмяРаздела,
									   ТекВетка,
									   СтруктураМногоуровневыхРазделов,
									   ТабличныйДокумент,
									   СтруктураРеквизитовФормы);
	
	Если НЕ СтруктураРеквизитовФормы.Свойство("АдресВоВрХранилищеДеревоДанных" + ИмяРаздела) Тогда
		СтруктураРеквизитовФормы.Вставить("АдресВоВрХранилищеДеревоДанных" + ИмяРаздела, Неопределено);
	КонецЕсли;
	
	РегламентированнаяОтчетность.ПоместитьВКэш(ДеревоДанныхРаздела, Новый УникальныйИдентификатор,
	СтруктураРеквизитовФормы["АдресВоВрХранилищеДеревоДанных" + ИмяРаздела]);
	
КонецПроцедуры

Процедура СформироватьДеревоМногострочнойЧастиПоДаннымТабличногоДокумента(ИмяФормы,
																		  СтруктураРеквизитовФормы,
																		  ТабличныйДокумент,
																		  ИмяГруппы,
																		  ДеревоДанных,
																		  Координаты = "")
	
	Если НЕ СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей.Свойство(ИмяГруппы) Тогда
		Возврат;
	КонецЕсли;
	
	МассивИменГраф = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппы]["ИменаГраф"];
	ИмяПервойГрафы = МассивИменГраф[0];
	
	Инд_Число = 1;
	Пока ТабличныйДокумент.Области.Найти(ИмяПервойГрафы + Координаты
		+ РегламентированнаяОтчетностьКлиентСервер.СтрокаСИндексомПоказателя(Инд_Число)) <> Неопределено Цикл
		НовВетка = ДеревоДанных.Строки.Добавить();
		
		// Заполнение данными из текущей строки многострочной части.
		Данные = Новый Структура;
		Инд = РегламентированнаяОтчетностьКлиентСервер.СтрокаСИндексомПоказателя(Инд_Число);
		Для каждого ИмяГрафы Из МассивИменГраф Цикл
			Обл = ТабличныйДокумент.Области.Найти(ИмяГрафы + Координаты + Инд);
			Если Обл <> Неопределено Тогда
				Данные.Вставить(ИмяГрафы, Обл.Значение);
			КонецЕсли;
		КонецЦикла;
		НовВетка.Данные = Данные;
		
		// Заполнение данными из строк многострочных частей, подчиненных текущей строке многострочной части.
		ДанныеМногострочныхЧастей = Новый Структура;
		ИменаПодчГрупп = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппы]["ИменаПодчиненныхГрупп"];
		Для каждого ИмяПодчГруппы Из ИменаПодчГрупп Цикл
			ДеревоПодчСтрок = Новый ДеревоЗначений;
			ДеревоПодчСтрок.Колонки.Добавить("Данные");
			ДеревоПодчСтрок.Колонки.Добавить("ДанныеМногострочныхЧастей");
			ПодчКоординаты = Координаты + Инд;
			СформироватьДеревоМногострочнойЧастиПоДаннымТабличногоДокумента(
			 ИмяФормы, СтруктураРеквизитовФормы, ТабличныйДокумент, ИмяПодчГруппы, ДеревоПодчСтрок, ПодчКоординаты);
			ДанныеМногострочныхЧастей.Вставить(ИмяПодчГруппы, ДеревоПодчСтрок);
		КонецЦикла;
		НовВетка.ДанныеМногострочныхЧастей = ДанныеМногострочныхЧастей;
		
		Инд_Число = Инд_Число + 1;
	КонецЦикла;
	
КонецПроцедуры

Процедура ЗаполнитьРеглОтчет(ИмяФормы,
							 ПараметрыАвтоформирования,
							 КорректирующийОтчет,
							 РазделыОтчета,
							 ДанныеРеглОтчета)
	
	ИсточникОтчета = ПараметрыАвтоформирования.ИсточникОтчета;
	ИмяФормыОтчета = ПараметрыАвтоформирования.ИмяФормыОтчета;
	
	Организация = ПараметрыАвтоформирования.Организация;
	
	ДопПараметры = Новый Структура;
	ДопПараметры.Вставить("ДатаНачала", ПараметрыАвтоформирования.ДатаНачала);
	ДопПараметры.Вставить("ДатаОкончания", ПараметрыАвтоформирования.ДатаОкончания);
	
	ДанныеРеглОтчета.Вставить("СтруктураРеквизитовФормы");
	ДанныеРеглОтчета.Вставить("СтруктураМногоуровневыхРазделов");
	
	СтруктураДанныхРазделов = СтруктураДанныхРазделов(ИмяФормы);
	
	СформироватьСтруктуруРеквизитовФормы(ИмяФормы, ДанныеРеглОтчета.СтруктураРеквизитовФормы);
	
	ИнициализироватьМногострочныеЧасти(ИмяФормы, ДанныеРеглОтчета.СтруктураРеквизитовФормы);
	
	ИнициализироватьМногоуровневыеРазделы(ИмяФормы,
										  ДанныеРеглОтчета.СтруктураРеквизитовФормы,
										  ДанныеРеглОтчета.СтруктураМногоуровневыхРазделов);
	
	ИнициализироватьОбычныеРазделы(ИмяФормы,
								   ДанныеРеглОтчета.СтруктураРеквизитовФормы,
								   ДанныеРеглОтчета.СтруктураМногоуровневыхРазделов,
								   СтруктураДанныхРазделов);
	
	ДанныеРеглОтчета.СтруктураРеквизитовФормы.Организация = ПараметрыАвтоформирования.Организация;
	
	ДанныеРеглОтчета.СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета = ПараметрыАвтоформирования.ДатаНачала;
	ДанныеРеглОтчета.СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета  = ПараметрыАвтоформирования.ДатаОкончания;
	
	ЗаполнитьЗначенияПоУмолчанию(ИмяФормы, ДанныеРеглОтчета.СтруктураРеквизитовФормы, СтруктураДанныхРазделов);
	
	РазделыОтчета.Титульный = СтруктураДанныхРазделов.СтруктураДанныхТитульный;
	
	РегламентированнаяОтчетность.ПоместитьВКэш(Неопределено, Новый УникальныйИдентификатор,
	ДанныеРеглОтчета.СтруктураРеквизитовФормы.АдресВоВременномХранилище);
	
	ПараметрыОтчета = Новый Структура();
	ПараметрыОтчета.Вставить("НастройкиАвтозаполнения", ?(ПараметрыАвтоформирования.Свойство("НастройкиАвтозаполнения"),
		ПараметрыАвтоформирования.НастройкиАвтозаполнения, Неопределено));
	ПараметрыОтчета.Вставить("Организация",             ПараметрыАвтоформирования.Организация);
	ПараметрыОтчета.Вставить("ДатаНачалаПериодаОтчета", НачалоДня(ПараметрыАвтоформирования.ДатаНачала));
	ПараметрыОтчета.Вставить("ДатаКонцаПериодаОтчета",  КонецДня(ПараметрыАвтоформирования.ДатаОкончания));
	ПараметрыОтчета.Вставить("АдресВоВременномХранилище",
	ДанныеРеглОтчета.СтруктураРеквизитовФормы.АдресВоВременномХранилище);
	
	Контейнер = Новый Структура;
	Контейнер.Вставить("Титульный", РазделыОтчета.Титульный);
	
	Для Каждого Раздел Из ДанныеРеглОтчета.СтруктураМногоуровневыхРазделов Цикл
		
		Если НЕ Раздел.Значение.Свойство("Подчиненность") Тогда
			
			Контейнер.Вставить(Раздел.Ключ, ПолучитьИзВременногоХранилища(
			ДанныеРеглОтчета.СтруктураРеквизитовФормы["АдресВоВрХранилищеДеревоДанных" + Раздел.Ключ]));
			
		КонецЕсли;
		
	КонецЦикла;
	
	Если ПараметрыАвтоформирования.Свойство("ЗаполнятьВнешнимиДанными")
	   И ПараметрыАвтоформирования.ЗаполнятьВнешнимиДанными = Истина Тогда
		
		ЗаполнитьРеглОтчетВнешнимиДанными(ИмяФормы,
										  Контейнер,
										  ПараметрыАвтоформирования.ВнешниеДанные);
		
	Иначе
		
		РегламентированнаяОтчетностьПереопределяемый.ЗаполнитьОтчет(ИсточникОтчета,
																	ИмяФормыОтчета,
																	ПараметрыОтчета,
																	Контейнер);
		
		РассчитатьИтоги(
		ИмяФормы, Контейнер, ДанныеРеглОтчета.СтруктураРеквизитовФормы, ДанныеРеглОтчета.СтруктураМногоуровневыхРазделов);
		
	КонецЕсли;
	
КонецПроцедуры

Процедура ЗаполнитьРеглОтчетВнешнимиДанными(ИмяФормы, Приемник, Источник)
	
	Возврат;
	
КонецПроцедуры

Процедура РассчитатьИтоги(ИмяФормы, Контейнер, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов)
	
	ИмяРаздела = "Приложение1Расчет";
	ИмяГлРаздела = ИмяГлРаздела(ИмяФормы, ИмяРаздела, СтруктураМногоуровневыхРазделов);
	ДеревоДанных = Контейнер[ИмяГлРаздела];
	
	ИмяГруппыП1РМ1 = СтруктураРеквизитовФормы.мИдГруппыП1РМ1;
	СтруктураГруппыП1РМ1 = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппыП1РМ1];
	ИменаГрафП1РМ1 = СтруктураГруппыП1РМ1["ИменаГраф"];
	
	Ветка = ДеревоДанных.Строки[0];
	
	ДеревоМнЧП1РМ1 = Ветка.ДанныеМногострочныхЧастей[ИмяГруппыП1РМ1];
	
	Для каждого СтрокаМнЧ Из ДеревоМнЧП1РМ1.Строки Цикл
		Если СокрЛП(СтрокаМнЧ.Данные["П00П1РМ101003"]) = "1" Тогда
			СтрокаМнЧ.Данные.Вставить("П00П1РМ105003", Окр(Окр(СтрокаМнЧ.Данные["П00П1РМ103003"], 2) * 0.7, 2));
		Иначе
			СтрокаМнЧ.Данные.Вставить("П00П1РМ105003", 0);
		КонецЕсли;
		СтрокаМнЧ.Данные.Вставить("П00П1РМ106003", Макс(0,
			Окр(СтрокаМнЧ.Данные["П00П1РМ104003"], 2), Окр(СтрокаМнЧ.Данные["П00П1РМ105003"], 2)));
	КонецЦикла;
	
	ИмяРаздела = "Приложение8";
	ИмяГлРаздела = ИмяГлРаздела(ИмяФормы, ИмяРаздела, СтруктураМногоуровневыхРазделов);
	ДеревоДанных = Контейнер[ИмяГлРаздела];
	
	Для каждого Ветка Из ДеревоДанных.Строки Цикл
		
		Ветка.Данные.Вставить("П000П80009003"
			, Окр(Ветка.Данные["П000П80006003"], 2) + Окр(Ветка.Данные["П000П80007003"], 2)
			+ Окр(Ветка.Данные["П000П80008003"], 2));
		
	КонецЦикла;
	
	ИмяРаздела = "Приложение6";
	ИмяГлРаздела = ИмяГлРаздела(ИмяФормы, ИмяРаздела, СтруктураМногоуровневыхРазделов);
	ДеревоДанных = Контейнер[ИмяГлРаздела];
	
	Ветка = ДеревоДанных.Строки[0];
	
	Ветка.Данные.Вставить("П000П60016003"
		, Окр(Ветка.Данные["П000П60001003"], 2) + Окр(Ветка.Данные["П000П60002003"], 2)
		+ Окр(Ветка.Данные["П000П60003003"], 2) + Окр(Ветка.Данные["П000П60004003"], 2)
		+ Окр(Ветка.Данные["П000П60005003"], 2) + Окр(Ветка.Данные["П000П60006003"], 2)
		+ Окр(Ветка.Данные["П000П60007003"], 2) + Окр(Ветка.Данные["П000П60008003"], 2)
		+ Окр(Ветка.Данные["П000П60009003"], 2) + Окр(Ветка.Данные["П000П60010003"], 2)
		+ Окр(Ветка.Данные["П000П60011003"], 2) + Окр(Ветка.Данные["П000П60011503"], 2)
		+ Окр(Ветка.Данные["П000П60012003"], 2) + Окр(Ветка.Данные["П000П60013003"], 2)
		+ Окр(Ветка.Данные["П000П60014003"], 2) + Окр(Ветка.Данные["П000П60015003"], 2)
		+ Окр(Ветка.Данные["П000П60015503"], 2));
	
	ИмяРаздела = "Приложение5";
	ИмяГлРаздела = ИмяГлРаздела(ИмяФормы, ИмяРаздела, СтруктураМногоуровневыхРазделов);
	ДеревоДанных = Контейнер[ИмяГлРаздела];
	
	Ветка = ДеревоДанных.Строки[0];
	
	ОбщСумСтандНалВыч
		= Окр(Ветка.Данные["П000П50007003"], 2) - Окр(Ветка.Данные["П000П50001003"], 2)
		- Окр(Ветка.Данные["П000П50002003"], 2) - Окр(Ветка.Данные["П000П50002503"], 2)
		- Окр(Ветка.Данные["П000П50003003"], 2) - Окр(Ветка.Данные["П000П50004003"], 2)
		- Окр(Ветка.Данные["П000П50005003"], 2) - Окр(Ветка.Данные["П000П50006003"], 2);
	
	Ветка.Данные.Вставить("П000П50007103", Макс(0, ОбщСумСтандНалВыч));
	
	Ветка.Данные.Вставить("П000П50008003", -Мин(0, ОбщСумСтандНалВыч));
	
	Ветка.Данные.Вставить("П000П50012003"
		, Окр(Ветка.Данные["П000П50009003"], 2) + Окр(Ветка.Данные["П000П50010003"], 2)
		+ Окр(Ветка.Данные["П000П50010503"], 2) + Окр(Ветка.Данные["П000П50011003"], 2));
	
	// Поставка данных из Расчета к Приложению 5. Начало.
	ДеревоДанныхП5Р = Контейнер["Приложение5Расчет"];
	
	ИмяГруппыП5РМ1 = СтруктураРеквизитовФормы.мИдГруппыП5РМ1;
	СтруктураГруппыП5РМ1 = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппыП5РМ1];
	ИменаГрафП5РМ1 = СтруктураГруппыП5РМ1["ИменаГраф"];
	
	ВеткаП5Р = ДеревоДанныхП5Р.Строки[0];
	
	ДеревоМнЧП5РМ1 = ВеткаП5Р.ДанныеМногострочныхЧастей[ИмяГруппыП5РМ1];
	
	Стр161 = 0;
	Для каждого СтрокаМнЧ Из ДеревоМнЧП5РМ1.Строки Цикл
		ТекКодВидДог = СокрЛП(СтрокаМнЧ.Данные["П00П5РМ102103"]);
		Если ТекКодВидДог = "2" ИЛИ ТекКодВидДог = "3" Тогда
			Стр161 = Стр161 + Окр(СтрокаМнЧ.Данные["П00П5РМ106003"], 2);
		КонецЕсли;
	КонецЦикла;
	
	Ветка.Данные.Вставить("П000П50016003", Стр161);
	
	Ветка.Данные.Вставить("П000П50016103", Окр(ВеткаП5Р.Данные["П00П5Р0007003"], 2));
	// Поставка данных из Расчета к Приложению 5. Окончание.
	
	Ветка.Данные.Вставить("П000П50018003", Мин(150000
		, Окр(Ветка.Данные["П000П50013003"], 2) + Окр(Ветка.Данные["П000П50013503"], 2)
		+ Окр(Ветка.Данные["П000П50014003"], 2) + Окр(Ветка.Данные["П000П50014103"], 2)
		+ Окр(Ветка.Данные["П000П50015003"], 2) + Окр(Ветка.Данные["П000П50016003"], 2)
		+ Окр(Ветка.Данные["П000П50016103"], 2) + Окр(Ветка.Данные["П000П50017003"], 2)
		+ Окр(Ветка.Данные["П000П50017103"], 2)));
	
	Ветка.Данные.Вставить("П000П50019003", Макс(0
		, Окр(Ветка.Данные["П000П50012003"], 2) + Окр(Ветка.Данные["П000П50018003"], 2)
		- Окр(Ветка.Данные["П000П50018103"], 2) - Окр(Ветка.Данные["П000П50018203"], 2)));
	
	Ветка.Данные.Вставить("П000П50020003"
		, Окр(Ветка.Данные["П000П50008003"], 2) + Окр(Ветка.Данные["П000П50019003"], 2));
	
	ИмяРаздела = "Приложение4";
	ИмяГлРаздела = ИмяГлРаздела(ИмяФормы, ИмяРаздела, СтруктураМногоуровневыхРазделов);
	ДеревоДанных = Контейнер[ИмяГлРаздела];
	
	Ветка = ДеревоДанных.Строки[0];
	
	Ветка.Данные.Вставить("П000П40012003"
		, Окр(Ветка.Данные["П000П40001003"], 2) + Окр(Ветка.Данные["П000П40002003"], 2)
		+ Окр(Ветка.Данные["П000П40003003"], 2) + Окр(Ветка.Данные["П000П40004003"], 2)
		+ Окр(Ветка.Данные["П000П40005003"], 2) + Окр(Ветка.Данные["П000П40006003"], 2)
		+ Окр(Ветка.Данные["П000П40007003"], 2) + Окр(Ветка.Данные["П000П40008003"], 2)
		+ Окр(Ветка.Данные["П000П40009003"], 2) + Окр(Ветка.Данные["П000П40010003"], 2)
		+ Окр(Ветка.Данные["П000П40010503"], 2) + Окр(Ветка.Данные["П000П40011003"], 2));
	
	ИмяРаздела = "Приложение3Продолжение";
	ИмяГлРаздела = ИмяГлРаздела(ИмяФормы, ИмяРаздела, СтруктураМногоуровневыхРазделов);
	ДеревоДанных = Контейнер[ИмяГлРаздела];
	
	Ветка = ДеревоДанных.Строки[0];
	
	Стр190 = Макс(0
		, Окр(Ветка.Данные["П000П30016003"])
		- Окр(Ветка.Данные["П000П30017003"])
		- Окр(Ветка.Данные["П000П30018003"]));
	Стр191 = Макс(0
		, Окр(Ветка.Данные["П000П30016103"])
		- Окр(Ветка.Данные["П000П30017103"])
		- Окр(Ветка.Данные["П000П30018103"]));
	Стр192 = Макс(0
		, Окр(Ветка.Данные["П000П30016203"])
		- Окр(Ветка.Данные["П000П30017203"])
		- Окр(Ветка.Данные["П000П30018203"]));
	
	Ветка.Данные.Вставить("П000П30019003", Стр190);
	Ветка.Данные.Вставить("П000П30019103", Стр191);
	Ветка.Данные.Вставить("П000П30019203", Стр192);
	
	Ветка.Данные.Вставить("П000П30020003", СуммаНалогаПоПрогрессивнойШкале(Стр190));
	Ветка.Данные.Вставить("П000П30020103", СуммаНалогаПоПрогрессивнойШкале(Стр191));
	Ветка.Данные.Вставить("П000П30020203", СуммаНалогаПоПрогрессивнойШкале(Стр192));
	
	ИмяРаздела = "Приложение3";
	ИмяГлРаздела = ИмяГлРаздела(ИмяФормы, ИмяРаздела, СтруктураМногоуровневыхРазделов);
	ДеревоДанных = Контейнер[ИмяГлРаздела];
	
	ИмяГруппыП3М1 = СтруктураРеквизитовФормы.мИдГруппыП3М1;
	СтруктураГруппыП3М1 = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппыП3М1];
	ИменаГрафП3М1 = СтруктураГруппыП3М1["ИменаГраф"];
	
	ИмяГруппыП3М2 = СтруктураРеквизитовФормы.мИдГруппыП3М2;
	СтруктураГруппыП3М2 = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппыП3М2];
	ИменаГрафП3М2 = СтруктураГруппыП3М2["ИменаГраф"];
	
	Ветка = ДеревоДанных.Строки[0];
	
	ДеревоМнЧП3М1 = Ветка.ДанныеМногострочныхЧастей[ИмяГруппыП3М1];
	ДеревоМнЧП3М2 = Ветка.ДанныеМногострочныхЧастей[ИмяГруппыП3М2];
	
	Стр050 = 0;
	Стр060_СуммаСтр030 = 0;
	Стр060_СуммаСтр040 = 0;
	Для каждого СтрокаМнЧ Из ДеревоМнЧП3М1.Строки Цикл
		ТекСтр030 = Окр(СтрокаМнЧ.Данные["П000П3М103003"], 2);
		Стр050 = Стр050 + ТекСтр030;
		ТекСтр040
			= Окр(СтрокаМнЧ.Данные["П000П3М104103"], 2)
			+ Окр(СтрокаМнЧ.Данные["П000П3М104203"], 2)
			+ Окр(СтрокаМнЧ.Данные["П000П3М104303"], 2)
			+ Окр(СтрокаМнЧ.Данные["П000П3М104403"], 2)
			+ Окр(СтрокаМнЧ.Данные["П000П3М104503"], 2);
		СтрокаМнЧ.Данные.Вставить("П000П3М104003", ТекСтр040);
		Если ТекСтр040 = 0 Тогда
			Стр060_СуммаСтр030 = Стр060_СуммаСтр030 + ТекСтр030;
		Иначе
			Стр060_СуммаСтр040 = Стр060_СуммаСтр040 + ТекСтр040;
		КонецЕсли;
	КонецЦикла;
	
	Ветка.Данные.Вставить("П000П30005003", Стр050);
	Ветка.Данные.Вставить("П000П30006003", Окр(Стр060_СуммаСтр030 * 0.2, 2) + Стр060_СуммаСтр040);
	
	Для каждого СтрокаМнЧ Из ДеревоМнЧП3М2.Строки Цикл
		СтрокаМнЧ.Данные.Вставить("П000П3М215003"
			, Окр(СтрокаМнЧ.Данные["П000П3М212003"], 2)
			+ Окр(СтрокаМнЧ.Данные["П000П3М213003"], 2)
			+ Окр(СтрокаМнЧ.Данные["П000П3М214003"], 2));
	КонецЦикла;
	
	ИмяРаздела = "Приложение2";
	ИмяГлРаздела = ИмяГлРаздела(ИмяФормы, ИмяРаздела, СтруктураМногоуровневыхРазделов);
	ДеревоДанных = Контейнер[ИмяГлРаздела];
	
	Для каждого Ветка Из ДеревоДанных.Строки Цикл
		
		Ветка.Данные.Вставить("П000П20007003", Окр(
			Окр(Ветка.Данные["П000П20005003"], 9) * Окр(Ветка.Данные["П000П20006003"], 2), 2));
		
		Ветка.Данные.Вставить("П000П20014003", Окр(
			Окр(Ветка.Данные["П000П20012003"], 9) * Окр(Ветка.Данные["П000П20013003"], 2), 2));
		
	КонецЦикла;
	
	ИмяРаздела = "Приложение7";
	ИмяГлРаздела = ИмяГлРаздела(ИмяФормы, ИмяРаздела, СтруктураМногоуровневыхРазделов);
	ДеревоДанных = Контейнер[ИмяГлРаздела];
	
	ИмяГруппыП7М1 = СтруктураРеквизитовФормы.мИдГруппыП7М1;
	СтруктураГруппыП7М1 = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппыП7М1];
	ИменаГрафП7М1 = СтруктураГруппыП7М1["ИменаГраф"];
	
	Ветка = ДеревоДанных.Строки[0];
	
	ДеревоМнЧП7М1 = Ветка.ДанныеМногострочныхЧастей[ИмяГруппыП7М1];
	
	// Расчет строки 140. Начало.
	Стр140 = 0;
	
	// Поставка данных из других разделов. Начало.
	// Поставка из Раздела 2.
	ДеревоДанныхДрРазд = Контейнер["Раздел2"];
	
	Для каждого ВеткаДрРазд Из ДеревоДанныхДрРазд.Строки Цикл
		ТекКГД = СокрЛП(ВеткаДрРазд.Данные["П000020000103"]);
		Если ТекКГД = "01" ИЛИ ТекКГД = "03" Тогда
			Стр140 = Стр140 + Окр(ВеткаДрРазд.Данные["П000020001003"], 2);
		КонецЕсли;
	КонецЦикла;
	
	// Поставка из Приложения 1.
	ДеревоДанныхДрРазд = Контейнер["Приложение1"];
	
	ИмяГруппыДрРазд = СтруктураРеквизитовФормы.мИдГруппыП1М1;
	СтруктураГруппыДрРазд = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппыДрРазд];
	ИменаГрафДрРазд = СтруктураГруппыДрРазд["ИменаГраф"];
	
	ВеткаДрРазд = ДеревоДанныхДрРазд.Строки[0];
	
	ДеревоМнЧДрРазд = ВеткаДрРазд.ДанныеМногострочныхЧастей[ИмяГруппыДрРазд];
	
	Для каждого СтрокаМнЧДрРазд Из ДеревоМнЧДрРазд.Строки Цикл
		ТекКВД = СокрЛП(СтрокаМнЧДрРазд.Данные["П000П1М101003"]);
		Если ТекКВД = "018" Тогда
			Стр140 = Стр140 + Окр(СтрокаМнЧДрРазд.Данные["П000П1М107003"], 2);
		КонецЕсли;
	КонецЦикла;
	
	// Поставка из Приложения 2.
	ДеревоДанныхДрРазд = Контейнер["Приложение2"];
	
	Для каждого ВеткаДрРазд Из ДеревоДанныхДрРазд.Строки Цикл
		ТекКВД = СокрЛП(ВеткаДрРазд.Данные["П000П20003103"]);
		Если ТекКВД = "018" Тогда
			Стр140 = Стр140 + Окр(ВеткаДрРазд.Данные["П000П20007003"], 2);
		КонецЕсли;
	КонецЦикла;
	
	// Поставка из Приложения 3.
	ДеревоДанныхДрРазд = Контейнер["Приложение3"];
	
	ИмяГруппыДрРазд = СтруктураРеквизитовФормы.мИдГруппыП3М2;
	СтруктураГруппыДрРазд = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппыДрРазд];
	ИменаГрафДрРазд = СтруктураГруппыДрРазд["ИменаГраф"];
	
	ВеткаДрРазд = ДеревоДанныхДрРазд.Строки[0];
	
	ДеревоМнЧДрРазд = ВеткаДрРазд.ДанныеМногострочныхЧастей[ИмяГруппыДрРазд];
	
	Стр140 = Стр140 - Окр(ВеткаДрРазд.Данные["П000П30006003"], 2);
	
	Для каждого СтрокаМнЧДрРазд Из ДеревоМнЧДрРазд.Строки Цикл
		Стр140 = Стр140 - Окр(СтрокаМнЧДрРазд.Данные["П000П3М215003"], 2);
	КонецЦикла;
	
	// Поставка из Приложения 4.
	ДеревоДанныхДрРазд = Контейнер["Приложение4"];
	
	ВеткаДрРазд = ДеревоДанныхДрРазд.Строки[0];
	
	Стр140 = Стр140 - Окр(ВеткаДрРазд.Данные["П000П40012003"], 2);
	
	// Поставка из Приложения 5.
	ДеревоДанныхДрРазд = Контейнер["Приложение5"];
	
	ВеткаДрРазд = ДеревоДанныхДрРазд.Строки[0];
	
	Стр140 = Стр140
		- Окр(ВеткаДрРазд.Данные["П000П50007003"], 2) - Окр(ВеткаДрРазд.Данные["П000П50008003"], 2)
		+ Окр(ВеткаДрРазд.Данные["П000П50007103"], 2) - Окр(ВеткаДрРазд.Данные["П000П50012003"], 2)
		- Окр(ВеткаДрРазд.Данные["П000П50018003"], 2) - Окр(ВеткаДрРазд.Данные["П000П50021003"], 2)
		- Окр(ВеткаДрРазд.Данные["П000П50023503"], 2) - Окр(ВеткаДрРазд.Данные["П000П50024003"], 2)
		- Окр(ВеткаДрРазд.Данные["П000П50025003"], 2);
	
	// Поставка из Приложения 6.
	ДеревоДанныхДрРазд = Контейнер["Приложение6"];
	
	ВеткаДрРазд = ДеревоДанныхДрРазд.Строки[0];
	
	Стр140 = Стр140 - Окр(ВеткаДрРазд.Данные["П000П60016003"], 2);
	
	// Поставка из Приложения 8.
	ДеревоДанныхДрРазд = Контейнер["Приложение8"];
	
	ВеткаДрРазд = ДеревоДанныхДрРазд.Строки[0];
	
	Стр140 = Стр140 - Окр(ВеткаДрРазд.Данные["П000П80006003"], 2)
		- Окр(ВеткаДрРазд.Данные["П000П80007003"], 2) - Окр(ВеткаДрРазд.Данные["П000П80008003"], 2);
	// Поставка данных из других разделов. Окончание.
	
	// Учет данных из Приложения 7.
	Стр140 = Стр140
		- Окр(Ветка.Данные["П000П70012003"], 2) - Окр(Ветка.Данные["П000П70012103"], 2)
		- Окр(Ветка.Данные["П000П70013003"], 2) - Окр(Ветка.Данные["П000П70013103"], 2);
	
	Ветка.Данные.Вставить("П000П70014003", Стр140);
	// Расчет строки 140. Окончание.
	
	Стр080 = 0;
	Стр090 = 0;
	Для каждого СтрокаМнЧ Из ДеревоМнЧП7М1.Строки Цикл
		Стр080 = Стр080 + Окр(СтрокаМнЧ.Данные["П000П7М108003"], 2);
		Стр090 = Стр090 + Окр(СтрокаМнЧ.Данные["П000П7М109003"], 2);
	КонецЦикла;
	
	Ветка.Данные.Вставить("П000П70017003", Мин(2000000, Макс(0, Стр080
		- Окр(Ветка.Данные["П000П70010003"], 2) - Окр(Ветка.Данные["П000П70012003"], 2)
		- Окр(Ветка.Данные["П000П70012103"], 2) - Окр(Ветка.Данные["П000П70015003"], 2))));
	
	Ветка.Данные.Вставить("П000П70018003", Мин(3000000, Макс(0, Стр090
		- Окр(Ветка.Данные["П000П70011003"], 2) - Окр(Ветка.Данные["П000П70013003"], 2)
		- Окр(Ветка.Данные["П000П70013103"], 2) - Окр(Ветка.Данные["П000П70016003"], 2))));
	
КонецПроцедуры

Функция СуммаНалогаПоПрогрессивнойШкале(НалБаза)
	
	Если НалБаза <= 2400000 Тогда
		Возврат Окр(НалБаза * 13 / 100);
	ИначеЕсли НалБаза <= 5000000 Тогда
		Возврат 312000 + Окр((НалБаза - 2400000) * 15 / 100);
	ИначеЕсли НалБаза <= 20000000 Тогда
		Возврат 702000 + Окр((НалБаза - 5000000) * 18 / 100);
	ИначеЕсли НалБаза <= 50000000 Тогда
		Возврат 3402000 + Окр((НалБаза - 20000000) * 20 / 100);
	Иначе// НалБаза > 50000000
		Возврат 9402000 + Окр((НалБаза - 50000000) * 22 / 100);
	КонецЕсли;
	
КонецФункции

Функция ИмяГлРаздела(ИмяФормы, ИмяРаздела, СтруктураМногоуровневыхРазделов)
	
	ИмяГлРаздела = ИмяРаздела;
	СтруктураРаздела = СтруктураМногоуровневыхРазделов[ИмяРаздела];
	Если СтруктураРаздела.Свойство("ИмяГлавногоРаздела") Тогда
		ИмяГлРаздела = СтруктураРаздела["ИмяГлавногоРаздела"];
	КонецЕсли;
	
	Возврат ИмяГлРаздела;
	
КонецФункции

Функция ЗаписатьРеглОтчет(ИмяФормы, ПараметрыЗаписи)
	
	Если НЕ ПараметрыЗаписи.СохраняемыйРеглОтчет = Неопределено Тогда
		
		Если ТипЗнч(ПараметрыЗаписи.СохраняемыйРеглОтчет) = Тип("ДокументСсылка.РегламентированныйОтчет")
			И НЕ ПараметрыЗаписи.СохраняемыйРеглОтчет.Пустая() Тогда
			
			ДокументРегламентированныйОтчет = ПараметрыЗаписи.СохраняемыйРеглОтчет.ПолучитьОбъект();
			
			РегламентированнаяОтчетность.ЗаблокироватьДокумент(ДокументРегламентированныйОтчет);
			
		ИначеЕсли ТипЗнч(ПараметрыЗаписи.СохраняемыйРеглОтчет) = Тип("ДокументОбъект.РегламентированныйОтчет") Тогда
			
			ДокументРегламентированныйОтчет = ПараметрыЗаписи.СохраняемыйРеглОтчет;
			
			РегламентированнаяОтчетность.ЗаблокироватьДокумент(ДокументРегламентированныйОтчет);
			
		Иначе
			
			РегламентированнаяОтчетность.ДобавитьОшибкуФормированияРеглОтчета(ПараметрыЗаписи,
			СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
			НСтр("ru = 'Неверный тип входящего параметра (%1) при автоматическом формировании формы %2';
				|en = 'Неверный тип входящего параметра (%1) при автоматическом формировании формы %2'"),
			ТипЗнч(ПараметрыЗаписи.СохраняемыйРеглОтчет), ПараметрыЗаписи.НаименованиеОтчета));
			
			Возврат Неопределено;
			
		КонецЕсли
		
	Иначе
		
		ДокументРегламентированныйОтчет = Документы.РегламентированныйОтчет.СоздатьДокумент();
		
		РегламентированнаяОтчетность.ЗаблокироватьДокумент(ДокументРегламентированныйОтчет);
		
		ДокументРегламентированныйОтчет.Дата = ПараметрыЗаписи.ДатаОкончания;
		ДокументРегламентированныйОтчет.УстановитьВремя();
		ДокументРегламентированныйОтчет.УстановитьНовыйНомер();
		
	КонецЕсли;
	
	ПараметрыЗаписи.СохраняемыйРеглОтчет = ДокументРегламентированныйОтчет;
	
	Если ЗаписатьДокумент(ИмяФормы, ПараметрыЗаписи) = Ложь Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	Возврат ДокументРегламентированныйОтчет.Ссылка;
	
КонецФункции

#КонецОбласти

#Область ВыгрузкаРегламентированногоОтчета

Функция УниверсальнаяВыгрузка(Параметры, ПроверятьВозможностьВыгрузки = Истина) Экспорт
	
	Перем ДанныеОтчета;
	Перем СтруктураРеквизитовФормы;
	Перем СтруктураМногоуровневыхРазделов;
	
	СохраненныйОтчет  = Параметры.СохраненныйОтчет;
	ИсточникОтчета    = Параметры.ИсточникОтчета;
	ИмяФормы	      = Параметры.ВыбраннаяФорма;
	РезультатВыгрузки = Параметры.РезультатВыгрузки;
	
	СформироватьСтруктуруРеквизитовФормы(ИмяФормы, СтруктураРеквизитовФормы);
	
	ИнициализироватьМногострочныеЧасти(ИмяФормы, СтруктураРеквизитовФормы);
	
	ИнициализироватьМногоуровневыеРазделы(
	ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов);
	
	СтруктураРеквизитовФормы.мСохраненныйДок = СохраненныйОтчет;
	
	СформироватьСтруктуруПоказателей(
	ИмяФормы, ДанныеОтчета, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов);
	
	ПараметрыВыгрузки = СформироватьСтруктуруПараметров(ИмяФормы, ДанныеОтчета, СтруктураРеквизитовФормы);
	
	ДеревоВыгрузки = ИзвлечьСтруктуруXML(ИмяФормы);
	
	Если ПроверятьВозможностьВыгрузки И НЕ ПроверитьВозможностьВыгрузки(ИмяФормы,
										 ПараметрыВыгрузки,
										 ДеревоВыгрузки,
										 РезультатВыгрузки,
										 СтруктураРеквизитовФормы,
										 СтруктураМногоуровневыхРазделов) Тогда
		
		РезультатВыгрузки.Вставить("РеглОтчетВыгружен", Ложь);
		
		Возврат РезультатВыгрузки;
		
	КонецЕсли;
	
	ЗаполнитьДанными(ИмяФормы,
					 ДанныеОтчета,
					 ПараметрыВыгрузки,
					 ДеревоВыгрузки,
					 РезультатВыгрузки,
					 СтруктураРеквизитовФормы,
					 СтруктураМногоуровневыхРазделов);
	
	КодировкаФайлаВыгрузки = "windows-1251";
	
	ТекстФайлаВыгрузки = ВыгрузитьДеревоВXML(ИмяФормы,
											 ДеревоВыгрузки,
											 ПараметрыВыгрузки,
											 КодировкаФайлаВыгрузки,
											 СтруктураРеквизитовФормы,
											 СтруктураМногоуровневыхРазделов);
	
	ИмяВременногоФайла = ПолучитьИмяВременногоФайла("xml");
	ЗаписьТекста = Новый ЗаписьТекста(ИмяВременногоФайла, КодировкаФайлаВыгрузки);
	ЗаписьТекста.Записать(ТекстФайлаВыгрузки);
	ЗаписьТекста.Закрыть();
	ЗаписьТекста = Неопределено;
	
	ФайлВыгрузки = Новый ДвоичныеДанные(ИмяВременногоФайла);
	
	АдресВоВременномХранилище = ПоместитьВоВременноеХранилище(ФайлВыгрузки, Новый УникальныйИдентификатор);
	
	УдалитьФайлы(ИмяВременногоФайла);
	
	РезультатВыгрузки.Вставить("ИмяФайлаВыгрузки", ПараметрыВыгрузки.ИдФайл + ".xml");
	РезультатВыгрузки.Вставить("АдресФайлаВыгрузки", АдресВоВременномХранилище);
	РезультатВыгрузки.Вставить("КодировкаФайлаВыгрузки", КодировкаФайлаВыгрузки);
	РезультатВыгрузки.Вставить("ТипФайлаВыгрузки", "3_НДФЛ");
	РезультатВыгрузки.Вставить("РеглОтчетВыгружен", Истина);
	
	Возврат РезультатВыгрузки;
	
КонецФункции

Процедура СформироватьСтруктуруПоказателей(ИмяФормы,
										   ДанныеОтчета,
										   СтруктураРеквизитовФормы,
										   СтруктураМногоуровневыхРазделов) Экспорт
	
	ДанныеОтчета = Новый Структура;
	
	СохрСтруктура = СохраненныеДанныеОтчета(
	ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов);
	
	ПоказателиОтчета = СохрСтруктура.ПоказателиОтчета;
	
	Для Каждого Раздел Из ПоказателиОтчета Цикл
		
		ДанныеОтчета.Вставить(СтрЗаменить(Раздел.Ключ, "ПолеТабличногоДокумента", ""),
		РегламентированнаяОтчетность.СвернутьДанныеТабличногоПоля(Раздел.Значение));
		
	КонецЦикла;
	
	Для Каждого Раздел Из СтруктураМногоуровневыхРазделов Цикл
		
		ДанныеОтчета.Вставить(Раздел.Ключ);
		
	КонецЦикла;
	
КонецПроцедуры

Функция СохраненныеДанныеОтчета(ИмяФормы,
								СтруктураРеквизитовФормы,
								СтруктураМногоуровневыхРазделов) Экспорт
	
	СохраненныеДанныеОтчета = СтруктураРеквизитовФормы.мСохраненныйДок.ДанныеОтчета.Получить();
	
	Если СохраненныеДанныеОтчета.Свойство("ОкружениеСохранения") Тогда
		ВосстановитьСохраненныеДанныеОтчетаСтарогоОбразца(ИмяФормы,
		СохраненныеДанныеОтчета, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов);
	КонецЕсли;
	
	Возврат СохраненныеДанныеОтчета;
	
КонецФункции

Функция СформироватьСтруктуруПараметров(ИмяФормы,
										ДанныеОтчета,
										СтруктураРеквизитовФормы) Экспорт
	
	Титульный = ДанныеОтчета.Титульный;
	
	ПараметрыВыгрузки = Новый Структура;
	
	ПараметрыВыгрузки.Вставить("ВерсПрог", РегламентированнаяОтчетность.НазваниеИВерсияПрограммы());
	ПараметрыВыгрузки.Вставить("ДатаДок",  Формат(ТекущаяДатаСеанса(), "ДФ=дд.ММ.гггг"));
	ПараметрыВыгрузки.Вставить("Период",   СокрЛП(Титульный.Период));
	ПараметрыВыгрузки.Вставить("ОтчетГод", Формат(СтруктураРеквизитовФормы.мСохраненныйДок.ДатаОкончания, "ДФ=гггг"));
	ПараметрыВыгрузки.Вставить("КодНО",    СокрЛП(Титульный.НалоговыйОрган));
	ПараметрыВыгрузки.Вставить("НомКорр",  Строка(СтруктураРеквизитовФормы.мСохраненныйДок.Вид));
	
	ПараметрыВыгрузки.Вставить("КодКатегории", СокрЛП(Титульный.КодКатегорииНалогоплательщика));
	ПараметрыВыгрузки.Вставить("КодСтатуса",   СокрЛП(Титульный.КодСтатусаНалогоплательщика));
	ПараметрыВыгрузки.Вставить("Тлф",          СокрЛП(Титульный.НомерТелефона));
	
	ПараметрыВыгрузки.Вставить("Фамилия",  СокрЛП(Титульный.Фамилия));
	ПараметрыВыгрузки.Вставить("Имя",      СокрЛП(Титульный.Имя));
	ПараметрыВыгрузки.Вставить("Отчество", СокрЛП(Титульный.Отчество));
	
	ПараметрыВыгрузки.Вставить("ИННФЛ",     "");
	ПараметрыВыгрузки.Вставить("ИдЕРН",     "");
	ПараметрыВыгрузки.Вставить("ДатаРожд",  '00010101');
	ПараметрыВыгрузки.Вставить("ОКСМ",      "");
	ПараметрыВыгрузки.Вставить("КодВидДок", "");
	ПараметрыВыгрузки.Вставить("СерНомДок", "");
	
	Если ЗначениеЗаполнено(Титульный.ИНН) Тогда
		ПараметрыВыгрузки.Вставить("ИННФЛ", СокрЛП(Титульный.ИНН));
	ИначеЕсли ЗначениеЗаполнено(Титульный.ИдЕРН) Тогда
		ПараметрыВыгрузки.Вставить("ИдЕРН", СокрЛП(Титульный.ИдЕРН));
	Иначе
		ПараметрыВыгрузки.Вставить("ДатаРожд",  Титульный.ДатаРождения);
		ПараметрыВыгрузки.Вставить("ОКСМ",      СокрЛП(Титульный.КодСтраны));
		ПараметрыВыгрузки.Вставить("КодВидДок", СокрЛП(Титульный.КодВидаДокумента));
		ПараметрыВыгрузки.Вставить("СерНомДок", СокрЛП(Титульный.СерияИНомерДокумента));
	КонецЕсли;
	
	ПараметрыВыгрузки.Вставить("ПрПодп", СокрЛП(Титульный.ПрПодп));
	ПараметрыВыгрузки.Вставить("ФамилияПодписанта",  СокрЛП(Титульный.ФамилияПодписанта));
	ПараметрыВыгрузки.Вставить("ИмяПодписанта",      СокрЛП(Титульный.ИмяПодписанта));
	ПараметрыВыгрузки.Вставить("ОтчествоПодписанта", СокрЛП(Титульный.ОтчествоПодписанта));
	
	ПараметрыВыгрузки.Вставить("НаимДокПред", СокрЛП(Титульный.ДокУпПред));
	
	ПараметрыВыгрузки.Вставить("НаимДокПред", СокрЛП(Титульный.ДокУпПред));
	
	СтруктураПараметров = Новый Структура("Организация, ДатаЗначения",
	СтруктураРеквизитовФормы.мСохраненныйДок.Организация, СтруктураРеквизитовФормы.мСохраненныйДок.ДатаОкончания);
	ПараметрыВыгрузки.Вставить("КодИФНСПосредника",
	РегламентированнаяОтчетность.КодНалоговогоОрганаПолучателяОтчетности(СтруктураПараметров));
	
	ПараметрыВыгрузки.Вставить("ИдФайл", ИдентификаторФайлаВыгрузки(ИмяФормы, ПараметрыВыгрузки, "NO_NDFL3"));
	
	ПараметрыВыгрузки.Вставить("ИмяКлючевогоУзлаСодержательнойЧасти", "НДФЛ3");
	
	Возврат ПараметрыВыгрузки;
	
КонецФункции

Функция ИзвлечьСтруктуруXML(ИмяФормы) Экспорт
	
	ДеревоСтруктуры = Новый ДеревоЗначений;
	ДеревоСтруктуры.Колонки.Добавить("Код");
	ДеревоСтруктуры.Колонки.Добавить("Тип");
	ДеревоСтруктуры.Колонки.Добавить("Формат");
	ДеревоСтруктуры.Колонки.Добавить("МинРазмерность");
	ДеревоСтруктуры.Колонки.Добавить("МаксРазмерность");
	ДеревоСтруктуры.Колонки.Добавить("Обязательность");
	ДеревоСтруктуры.Колонки.Добавить("Многостраничность");
	ДеревоСтруктуры.Колонки.Добавить("Многострочность");
	ДеревоСтруктуры.Колонки.Добавить("Раздел");
	ДеревоСтруктуры.Колонки.Добавить("Ключ");
	ДеревоСтруктуры.Колонки.Добавить("Условие");
	ДеревоСтруктуры.Колонки.Добавить("ЗначениеПоУмолчанию");
	ДеревоСтруктуры.Колонки.Добавить("Значение");
	ДеревоСтруктуры.Колонки.Добавить("Представление");
	ДеревоСтруктуры.Колонки.Добавить("Показатели");
	
	Макет = ЭтотОбъект.ПолучитьМакет("СхемаВыгрузки520");
	
	ВысотаТаблицы = Макет.ВысотаТаблицы;
	
	УчтенныеГруппы = Новый Соответствие;
	
	Для Уровень = 0 По Макет.КоличествоУровнейГруппировокСтрок() - 1 Цикл
		Макет.ПоказатьУровеньГруппировокСтрок(Уровень);
		Для НомерСтроки = 2 По ВысотаТаблицы Цикл
			НомСтр = ВысотаТаблицы - НомерСтроки + 2;
			Если Макет.Область(НомСтр, 0, НомСтр, 0).Видимость И УчтенныеГруппы.Получить(НомСтр) = Неопределено Тогда
				
				РодительскийУзел = ДеревоСтруктуры;
				Если Уровень <> 0 Тогда
					Для Инд = 1 По НомСтр - 2 Цикл
						Узел = УчтенныеГруппы.Получить(НомСтр - Инд);
						Если Узел <> Неопределено Тогда
							РодительскийУзел = Узел;
							Прервать;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
				
				НовСтр = РодительскийУзел.Строки.Вставить(0);
				НовСтр.Код = СокрЛП(Макет.Область(НомСтр, 1, НомСтр, 1).Текст);
				НовСтр.Раздел = СокрЛП(Макет.Область(НомСтр, 2, НомСтр, 2).Текст);
				НовСтр.Ключ = СокрЛП(Макет.Область(НомСтр, 3, НомСтр, 3).Текст);
				НовСтр.Тип = СокрЛП(Макет.Область(НомСтр, 4, НомСтр, 4).Текст);
				НовСтр.Формат = СокрЛП(Макет.Область(НомСтр, 5, НомСтр, 5).Текст);
				МинРазмерность = СокрЛП(Макет.Область(НомСтр, 6, НомСтр, 6).Текст);
				НовСтр.МинРазмерность = ?(ПустаяСтрока(МинРазмерность), ?(НовСтр.Формат = "N", 99999, 0), Число(МинРазмерность));
				МаксРазмерность = СокрЛП(Макет.Область(НомСтр, 7, НомСтр, 7).Текст);
				НовСтр.МаксРазмерность = ?(ПустаяСтрока(МаксРазмерность), 99999, Число(МаксРазмерность));
				НовСтр.Обязательность = СокрЛП(Макет.Область(НомСтр, 8, НомСтр, 8).Текст);
				НовСтр.Многостраничность = НЕ ПустаяСтрока(Макет.Область(НомСтр, 9, НомСтр, 9).Текст);
				НовСтр.Многострочность = НЕ ПустаяСтрока(Макет.Область(НомСтр, 10, НомСтр, 10).Текст);
				НовСтр.Условие = СокрЛП(Макет.Область(НомСтр, 11, НомСтр, 11).Текст);
				НовСтр.ЗначениеПоУмолчанию = СокрЛП(Макет.Область(НомСтр, 12, НомСтр, 12).Текст);
				НовСтр.Представление = СокрЛП(Макет.Область(НомСтр, 13, НомСтр, 13).Текст);
				
				УчтенныеГруппы.Вставить(НомСтр, НовСтр);
				
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	Возврат ДеревоСтруктуры;
	
КонецФункции

Функция ПроверитьВозможностьВыгрузки(ИмяФормы,
									 ПараметрыВыгрузки,
									 ДеревоВыгрузки,
									 РезультатВыгрузки,
									 СтруктураРеквизитовФормы,
									 СтруктураМногоуровневыхРазделов) Экспорт
	
	СтатусПроверки = Истина;
	
	ДанныеМногоуровневыхРазделов = Новый Структура;
	СохрСтруктура = СохраненныеДанныеОтчета(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов);
	Для каждого ЭлементСтруктуры Из СохрСтруктура.ДанныеМногоуровневыхРазделов Цикл
		ДанныеМногоуровневыхРазделов.Вставить(ЭлементСтруктуры.Ключ, ЭлементСтруктуры.Значение);
	КонецЦикла;
	
	// Титульный лист.
	//
	Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.Период) Тогда
		СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Не задан код налогового периода", "Титульный", "Период");
		СтатусПроверки = Ложь;
	Иначе
		ВозмКодыПериода = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыПериода");
		Если ВозмКодыПериода.МассивЗначений.Найти(ПараметрыВыгрузки.Период) = Неопределено Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Задан некорректный код налогового периода. Возможны значения: "
				+ ВозмКодыПериода.СтрокаЗначений, "Титульный", "Период");
			СтатусПроверки = Ложь;
		КонецЕсли;
	КонецЕсли;
	
	Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.ОтчетГод) Тогда
		СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Не задан отчетный год", "Титульный", "ОтчетГод");
		СтатусПроверки = Ложь;
	ИначеЕсли НЕ (СтрДлина(ПараметрыВыгрузки.ОтчетГод) = 4
		И СтроковыеФункцииКлиентсервер.ТолькоЦифрыВСтроке(ПараметрыВыгрузки.ОтчетГод)) Тогда
		СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Задан отчетный год, не состоящй из 4 цифр", "Титульный", "ОтчетГод");
		СтатусПроверки = Ложь;
	КонецЕсли;
	
	Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.КодНО) Тогда
		СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Не задан код налогового органа", "Титульный", "НалоговыйОрган");
		СтатусПроверки = Ложь;
	ИначеЕсли НЕ (СтрДлина(ПараметрыВыгрузки.КодНО) = 4
		И СтроковыеФункцииКлиентсервер.ТолькоЦифрыВСтроке(ПараметрыВыгрузки.КодНО)) Тогда
		СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Задан код налогового органа, не состоящий из 4 цифр",
			"Титульный", "НалоговыйОрган");
		СтатусПроверки = Ложь;
	КонецЕсли;
	
	Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.КодКатегории) Тогда
		СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Не задан код категории налогоплательщика",
			"Титульный", "КодКатегорииНалогоплательщика");
		СтатусПроверки = Ложь;
	Иначе
		ВозмКодыКатегории = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыКатегории");
		Если ВозмКодыКатегории.МассивЗначений.Найти(ПараметрыВыгрузки.КодКатегории) = Неопределено Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Задан некорректный код категории налогоплательщика. Возможны значения: "
				+ ВозмКодыКатегории.СтрокаЗначений, "Титульный", "КодКатегорииНалогоплательщика");
			СтатусПроверки = Ложь;
		КонецЕсли;
	КонецЕсли;
	
	Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.КодСтатуса) Тогда
		СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Не задан код статуса налогоплательщика",
			"Титульный", "КодСтатусаНалогоплательщика");
		СтатусПроверки = Ложь;
	Иначе
		ВозмКодыСтатусаНал = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "СтатусыНалогоплательщика");
		Если ВозмКодыСтатусаНал.МассивЗначений.Найти(ПараметрыВыгрузки.КодСтатуса) = Неопределено Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Задан некорректный код статуса налогоплательщика. Возможны значения: "
				+ ВозмКодыСтатусаНал.СтрокаЗначений, "Титульный", "КодСтатусаНалогоплательщика");
			СтатусПроверки = Ложь;
		КонецЕсли;
	КонецЕсли;
	
	Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.Фамилия) Тогда
		СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Не задана фамилия налогоплательщика", "Титульный", "Фамилия");
		СтатусПроверки = Ложь;
	КонецЕсли;
	Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.Имя) Тогда
		СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Не задано имя налогоплательщика", "Титульный", "Имя");
		СтатусПроверки = Ложь;
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ПараметрыВыгрузки.ИННФЛ) Тогда
		
		Если НЕ (СтрДлина(ПараметрыВыгрузки.ИННФЛ) = 12
			И СтроковыеФункцииКлиентсервер.ТолькоЦифрыВСтроке(ПараметрыВыгрузки.ИННФЛ)) Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки,
				"Задан ИНН налогоплательщика, не состоящий из 12 цифр", "Титульный", "ИНН");
			СтатусПроверки = Ложь;
		КонецЕсли;
		
	ИначеЕсли ЗначениеЗаполнено(ПараметрыВыгрузки.ИдЕРН) Тогда
		
		Если НЕ (СтрДлина(ПараметрыВыгрузки.ИдЕРН) = 12
			И СтроковыеФункцииКлиентсервер.ТолькоЦифрыВСтроке(ПараметрыВыгрузки.ИдЕРН)) Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки,
				"Задан номер записи в ЕРН, не состоящий из 12 цифр", "Титульный", "ИНН");
			СтатусПроверки = Ложь;
		КонецЕсли;
		
	Иначе// сведения о физическом лице (отсутствует ИНН физического лица и номер записи в ЕРН)
		
		Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.ДатаРожд) Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Не задана дата рождения налогоплательщика", "Титульный", "ДатаРождения");
			СтатусПроверки = Ложь;
		ИначеЕсли НЕ ДатаВходитВРазрешенныйПериод(ИмяФормы, ПараметрыВыгрузки.ДатаРожд) Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки,
				"Задана дата рождения налогоплательщика, выходящая за пределы периода с 01.01.1900 по 31.12.2099",
				"Титульный", "ДатаРождения");
			СтатусПроверки = Ложь;
		КонецЕсли;
		
		Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.ОКСМ) Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Не задан код страны", "Титульный", "КодСтраны");
			СтатусПроверки = Ложь;
		ИначеЕсли НЕ (СтрДлина(ПараметрыВыгрузки.ОКСМ) = 3
			И СтроковыеФункцииКлиентсервер.ТолькоЦифрыВСтроке(ПараметрыВыгрузки.ОКСМ)) Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Задан код страны, не состоящий из 3 цифр", "Титульный", "КодСтраны");
			СтатусПроверки = Ложь;
		КонецЕсли;
		
		Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.КодВидДок) Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Не задан код вида документа, удостоверяющего личность налогоплательщика",
				"Титульный", "КодВидаДокумента");
			СтатусПроверки = Ложь;
		Иначе
			ВозмКодыВидаДокумента = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыВидаДокумента");
			Если ВозмКодыВидаДокумента.МассивЗначений.Найти(ПараметрыВыгрузки.КодВидДок) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки,
					"Задан некорректный код вида документа, удостоверяющего личность налогоплательщика. Возможны значения: "
					+ ВозмКодыВидаДокумента.СтрокаЗначений, "Титульный", "КодВидаДокумента");
				СтатусПроверки = Ложь;
			КонецЕсли;
		КонецЕсли;
		
		Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.СерНомДок) Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки,
				"Не заданы серия и номер документа, удостоверяющего личность налогоплательщика",
				"Титульный", "СерияИНомерДокумента");
			СтатусПроверки = Ложь;
		КонецЕсли;
		
	КонецЕсли;
	
	Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.ПрПодп) Тогда
		СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Не задан признак лица, подписавшего документ", "Титульный", "ПрПодп");
		СтатусПроверки = Ложь;
		
	Иначе
		ВозмКодыПрПодп = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "ПризнакиПодписанта");
		Если ВозмКодыПрПодп.МассивЗначений.Найти(ПараметрыВыгрузки.ПрПодп) = Неопределено Тогда
			
			СообщитьВТС(ИмяФормы, РезультатВыгрузки,
				"Задан некорректный признак лица, подписавшего документ. Возможны значения: "
				+ ВозмКодыПрПодп.СтрокаЗначений, "Титульный", "ПрПодп");
			СтатусПроверки = Ложь;
			
		ИначеЕсли ПараметрыВыгрузки.ПрПодп = "2" Тогда
			
			Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.ФамилияПодписанта) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Не задана фамилия подписанта", "Титульный", "ФамилияПодписанта");
				СтатусПроверки = Ложь;
			КонецЕсли;
			Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.ИмяПодписанта) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Не задано имя подписанта", "Титульный", "ИмяПодписанта");
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			Если НЕ ЗначениеЗаполнено(ПараметрыВыгрузки.НаимДокПред) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки,
					"Не заданы наименование и реквизиты документа, подтверждающего полномочия представителя налогоплательщика",
					"Титульный", "ДокУпПред");
				СтатусПроверки = Ложь;
			КонецЕсли;
			
		КонецЕсли;
		
	КонецЕсли;
	
	// Раздел 1.
	//
	ИмяРаздела = "Раздел1";
	ДеревоРаздела = ДанныеМногоуровневыхРазделов[ИмяРаздела];
	Ветка = ДеревоРаздела.Строки[0];
	НомСтраницы = "1";
	
	Если ЗаполненаСтраницаРаздела(
		ИмяФормы, Ветка, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыР1М1];
		Если ЗаполненаМногострочнаяЧасть(ИмяФормы,
			ДанныеМнЧ, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
			Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
				ИндСтрокиМнЧ = ДанныеМнЧ.Строки.Индекс(СтрокаМнЧ);
				НомСтроки = Формат(ИндСтрокиМнЧ + 1, "ЧГ=");
				Преф = "Раздел 1 -> пункт 1:" + ?(ДанныеМнЧ.Строки.Количество() > 1,
					" в группе " + НомСтроки + " строк 020-050", "");
				
				ИмяПок = "П00001М102003";
				ДлинаЗначПок = СтрДлина(СокрЛП(СтрокаМнЧ.Данные[ИмяПок]));
				Если ДлинаЗначПок <> 20 Тогда
					СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + ?(ДлинаЗначПок = 0, " не", "")
						+ " задан код бюджетной классификации" + ?(ДлинаЗначПок = 0, "", ", не состоящий из 20 символов"),
						ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
					СтатусПроверки = Ложь;
				КонецЕсли;
				
				ИмяПок = "П00001М103003";
				ДлинаЗначПок = СтрДлина(СокрЛП(СтрокаМнЧ.Данные[ИмяПок]));
				Если ДлинаЗначПок <> 8 И ДлинаЗначПок <> 11 Тогда
					СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + ?(ДлинаЗначПок = 0, " не", "")
						+ " задан код по ОКТМО" + ?(ДлинаЗначПок = 0, "", ", не состоящий из 8 или 11 цифр"),
						ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
					СтатусПроверки = Ложь;
				КонецЕсли;
				
			КонецЦикла;
		КонецЕсли;
		
		ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыР1М2];
		Если ЗаполненаМногострочнаяЧасть(ИмяФормы,
			ДанныеМнЧ, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
			Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
				ИндСтрокиМнЧ = ДанныеМнЧ.Строки.Индекс(СтрокаМнЧ);
				НомСтроки = Формат(ИндСтрокиМнЧ + 1, "ЧГ=");
				Преф = "Раздел 1 -> пункт 2:" + ?(ДанныеМнЧ.Строки.Количество() > 1,
					" в группе " + НомСтроки + " строк 060-170", "");
				
				ИмяПок = "П00001М206003";
				ДлинаЗначПок = СтрДлина(СокрЛП(СтрокаМнЧ.Данные[ИмяПок]));
				Если ДлинаЗначПок <> 20 Тогда
					СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + ?(ДлинаЗначПок = 0, " не", "")
						+ " задан код бюджетной классификации" + ?(ДлинаЗначПок = 0, "", ", не состоящий из 20 символов"),
						ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
					СтатусПроверки = Ложь;
				КонецЕсли;
				
				ИмяПок = "П00001М207003";
				ДлинаЗначПок = СтрДлина(СокрЛП(СтрокаМнЧ.Данные[ИмяПок]));
				Если ДлинаЗначПок <> 0 ИЛИ Окр(СтрокаМнЧ.Данные["П00001М208003"]) <> 0 Тогда
					Если ДлинаЗначПок <> 8 И ДлинаЗначПок <> 11 Тогда
						СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + ?(ДлинаЗначПок = 0, " не", "") + " задан код по ОКТМО"
							+ ?(ДлинаЗначПок = 0, "", ", не состоящий из 8 или 11 цифр,") + " в строке 070",
							ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
						СтатусПроверки = Ложь;
					КонецЕсли;
				КонецЕсли;
				
				ИмяПок = "П00001М209003";
				ДлинаЗначПок = СтрДлина(СокрЛП(СтрокаМнЧ.Данные[ИмяПок]));
				Если ДлинаЗначПок <> 0
					ИЛИ Окр(СтрокаМнЧ.Данные["П00001М210003"]) - Окр(СтрокаМнЧ.Данные["П00001М211003"]) <> 0 Тогда
					Если ДлинаЗначПок <> 8 И ДлинаЗначПок <> 11 Тогда
						СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + ?(ДлинаЗначПок = 0, " не", "") + " задан код по ОКТМО"
							+ ?(ДлинаЗначПок = 0, "", ", не состоящий из 8 или 11 цифр,") + " в строке 090",
							ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
						СтатусПроверки = Ложь;
					КонецЕсли;
				КонецЕсли;
				
				ИмяПок = "П00001М212003";
				ДлинаЗначПок = СтрДлина(СокрЛП(СтрокаМнЧ.Данные[ИмяПок]));
				Если ДлинаЗначПок <> 0
					ИЛИ Окр(СтрокаМнЧ.Данные["П00001М213003"]) - Окр(СтрокаМнЧ.Данные["П00001М214003"]) <> 0 Тогда
					Если ДлинаЗначПок <> 8 И ДлинаЗначПок <> 11 Тогда
						СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + ?(ДлинаЗначПок = 0, " не", "") + " задан код по ОКТМО"
							+ ?(ДлинаЗначПок = 0, "", ", не состоящий из 8 или 11 цифр,") + " в строке 120",
							ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
						СтатусПроверки = Ложь;
					КонецЕсли;
				КонецЕсли;
				
				ИмяПок = "П00001М215003";
				ДлинаЗначПок = СтрДлина(СокрЛП(СтрокаМнЧ.Данные[ИмяПок]));
				Если ДлинаЗначПок <> 8 И ДлинаЗначПок <> 11 Тогда
					СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + ?(ДлинаЗначПок = 0, " не", "") + " задан код по ОКТМО"
						+ ?(ДлинаЗначПок = 0, "", ", не состоящий из 8 или 11 цифр,") + " в строке 150",
						ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
					СтатусПроверки = Ложь;
				КонецЕсли;
				
			КонецЦикла;
			
		КонецЕсли;
		
	Иначе
		
		СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Раздел 1: должен быть заполнен п.1 и (или) п.2",
			ИмяРаздела, "П00001М102003_1", НомСтраницы);
		СтатусПроверки = Ложь;
		
	КонецЕсли;
	
	// Приложение к Разделу 1.
	//
	ИмяРаздела = "Раздел1Приложение";
	ДеревоРаздела = ДанныеМногоуровневыхРазделов[ИмяРаздела];
	Ветка = ДеревоРаздела.Строки[0];
	НомСтраницы = "1";
	
	Если ЗаполненаСтраницаРаздела(
		ИмяФормы, Ветка, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ИмяПок = "П0001П0002003";
		ДлинаЗначПок = СтрДлина(СокрЛП(Ветка.Данные[ИмяПок]));
		Если ДлинаЗначПок <> 9 Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение к Разделу 1:" + ?(ДлинаЗначПок = 0, " не", "")
				+ " задан банковский идентификационный код" + ?(ДлинаЗначПок = 0, "", ", не состоящий из 9 цифр"),
				ИмяРаздела, ИмяПок, НомСтраницы);
			СтатусПроверки = Ложь;
		КонецЕсли;
		
		ИмяПок = "П0001П0003003";
		ДлинаЗначПок = СтрДлина(СокрЛП(Ветка.Данные[ИмяПок]));
		Если ДлинаЗначПок <> 20 Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение к Разделу 1:" + ?(ДлинаЗначПок = 0, " не", "")
				+ " задан номер счета для возврата" + ?(ДлинаЗначПок = 0, "", ", не состоящий из 20 цифр"),
				ИмяРаздела, ИмяПок, НомСтраницы);
			СтатусПроверки = Ложь;
		КонецЕсли;
		
	КонецЕсли;
	
	// Раздел 2.
	//
	ИмяРаздела = "Раздел2";
	ДеревоРаздела = ДанныеМногоуровневыхРазделов[ИмяРаздела];
	
	Если ЗаполненРаздел(ИмяФормы, ДанныеМногоуровневыхРазделов[ИмяРаздела],
		ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ВозмКодыГруппДоходов = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыГруппДоходов");
		
		Для Каждого Ветка Из ДеревоРаздела.Строки Цикл
			
			НомСтраницы = Формат(ДеревоРаздела.Строки.Индекс(Ветка) + 1, "ЧГ=");
			
			ИмяПок = "П000020000103";
			ЗначПок = СокрЛП(Ветка.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Раздел 2 -> Страница " + НомСтраницы
					+ ": не задан код группы доходов", ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмКодыГруппДоходов.МассивЗначений.Найти(ЗначПок) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Раздел 2 -> Страница " + НомСтраницы
					+ ": задан некорректный код группы доходов. Возможны значения: "
					+ ВозмКодыГруппДоходов.СтрокаЗначений, ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
		КонецЦикла;
		
	Иначе
		
		СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Раздел 2 должен быть заполнен", ИмяРаздела, "П000020000103", "1");
		СтатусПроверки = Ложь;
		
	КонецЕсли;
	
	// Приложение 1.
	//
	ИмяРаздела = "Приложение1";
	ДеревоРаздела = ДанныеМногоуровневыхРазделов[ИмяРаздела];
	Ветка = ДеревоРаздела.Строки[0];
	НомСтраницы = "1";
	
	Если ЗаполненаСтраницаРаздела(
		ИмяФормы, Ветка, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ВозмКодыВидаДохода = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыВидаДохода");
		
		ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП1М1];
		Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
			ИндСтрокиМнЧ = ДанныеМнЧ.Строки.Индекс(СтрокаМнЧ);
			НомСтроки = Формат(ИндСтрокиМнЧ + 1, "ЧГ=");
			Преф = "Приложение 1:" + ?(ДанныеМнЧ.Строки.Количество() > 1, " в группе " + НомСтроки + " строк 010-080", "");
			
			ИмяПок = "П000П1М101003";
			ВидДоход = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ВидДоход) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан код вида дохода",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмКодыВидаДохода.МассивЗначений.Найти(ВидДоход) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " задан некорректный код вида дохода. Возможны значения: "
					+ ВозмКодыВидаДохода.СтрокаЗначений, ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли НЕ (ВидДоход = "025" ИЛИ ВидДоход = "046") Тогда
				ИмяПок_ = "П000П1М102003";
				Если Окр(СтрокаМнЧ.Данные[ИмяПок_]) <> 0 Тогда
					СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
						+ " налоговая ставка не должна быть задана, если код вида дохода не равен 025 или 046",
						ИмяРаздела, ИмяПок_ + "_" + НомСтроки, НомСтраницы);
					СтатусПроверки = Ложь;
				КонецЕсли;
			КонецЕсли;
			
			ИмяПокИНН = "П000П1М103003";
			ДлинаЗначПокИНН = СтрДлина(СокрЛП(СтрокаМнЧ.Данные[ИмяПокИНН]));
			ИмяПокКПП = "П000П1М104003";
			ДлинаЗначПокКПП = СтрДлина(СокрЛП(СтрокаМнЧ.Данные[ИмяПокКПП]));
			
			Если НЕ ((ДлинаЗначПокИНН = 10 И ДлинаЗначПокКПП = 9)
				ИЛИ (ДлинаЗначПокИНН = 12 И ДлинаЗначПокКПП = 0)
				ИЛИ (ДлинаЗначПокИНН = 0 И ДлинаЗначПокКПП = 0)) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " задано недопустимое сочетание значений ИНН источника выплаты дохода и КПП."
					+ " Возможны либо ИНН из 10 цифр и КПП из 9 символов (юрлицо);"
					+ " либо ИНН из 12 цифр и незаполненный КПП (физлицо с ИНН); либо незаполненные ИНН и КПП (физлицо без ИНН)",
					ИмяРаздела, ИмяПокИНН + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П000П1М105003";
			ДлинаЗначПок = СтрДлина(СокрЛП(СтрокаМнЧ.Данные[ИмяПок]));
			Если ДлинаЗначПок <> 0 Тогда
				Если ДлинаЗначПок <> 8 И ДлинаЗначПок <> 11 Тогда
					СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + ?(ДлинаЗначПок = 0, " не", "") + " задан код по ОКТМО"
						+ ?(ДлинаЗначПок = 0, "", ", не состоящий из 8 или 11 цифр"), ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
					СтатусПроверки = Ложь;
				КонецЕсли;
			КонецЕсли;
			
			ИмяПок = "П000П1М106003";
			Если НЕ ЗначениеЗаполнено(СокрЛП(СтрокаМнЧ.Данные[ИмяПок])) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задано нaимeнование источника выплаты дохода",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
		КонецЦикла;
		
	КонецЕсли;
	
	// Приложение 2.
	//
	ИмяРаздела = "Приложение2";
	ДеревоРаздела = ДанныеМногоуровневыхРазделов[ИмяРаздела];
	
	Если ЗаполненРаздел(ИмяФормы, ДанныеМногоуровневыхРазделов[ИмяРаздела],
		ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ВозмКодыВидаДохода      = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыВидаДохода");
		ВозмКодыВидаОсвобОтНал  = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыВидаОсвобОтНал");
		ВозмПорядОпредПрибУбКИК = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "ПорядокОпределенияПрибУбКИК");
		
		Для Каждого Ветка Из ДеревоРаздела.Строки Цикл
			
			НомСтраницы = Формат(ДеревоРаздела.Строки.Индекс(Ветка) + 1, "ЧГ=");
			
			ИмяПок = "П000П20001003";
			ЗначПок = СокрЛП(Ветка.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": не задан код страны источника выплаты", ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли НЕ (СтрДлина(ЗначПок) = 3 И СтроковыеФункцииКлиентсервер.ТолькоЦифрыВСтроке(ЗначПок)) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": задан код страны источника выплаты, не состоящий из 3 цифр", ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П000П20001103";
			ЗначПок = СокрЛП(Ветка.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": не задан код страны зачисления выплаты", ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли НЕ (СтрДлина(ЗначПок) = 3 И СтроковыеФункцииКлиентсервер.ТолькоЦифрыВСтроке(ЗначПок)) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": задан код страны зачисления выплаты, не состоящий из 3 цифр", ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П000П20002003";
			Если НЕ ЗначениеЗаполнено(СокрЛП(Ветка.Данные[ИмяПок])) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": не задано нaимeнование источника выплаты дохода", ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П000П20003003";
			ЗначПок = СокрЛП(Ветка.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": не задан код валюты", ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли НЕ (СтрДлина(ЗначПок) = 3 И СтроковыеФункцииКлиентсервер.ТолькоЦифрыВСтроке(ЗначПок)) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": задан код валюты, не состоящий из 3 цифр", ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П000П20003103";
			ВидДоход = СокрЛП(Ветка.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ВидДоход) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": не задан код вида дохода", ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмКодыВидаДохода.МассивЗначений.Найти(ВидДоход) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": задан некорректный код вида дохода. Возможны значения: "
					+ ВозмКодыВидаДохода.СтрокаЗначений, ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли НЕ (ВидДоход = "025" ИЛИ ВидДоход = "046") Тогда
				ИмяПок_ = "П000П20004103";
				Если Окр(Ветка.Данные[ИмяПок_]) <> 0 Тогда
					СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
						+ ": налоговая ставка не должна быть задана, если код вида дохода не равен 025 или 046",
						ИмяРаздела, ИмяПок_, НомСтраницы);
					СтатусПроверки = Ложь;
				КонецЕсли;
			КонецЕсли;
			
			ИмяПок = "П000П20003203";
			ЗначПок = СокрЛП(Ветка.Данные[ИмяПок]);
			Если ЗначениеЗаполнено(ЗначПок) И НЕ (СтрДлина(ЗначПок) = 8 И Сред(ЗначПок, 3, 1) = "-") Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": задан номер контролируемой иностранной компании, не состоящий из 8 символов, 3-й из которых равен ""-""",
					ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П000П20004003";
			ЗначПок = Ветка.Данные[ИмяПок];
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": не задана дата получения дохода", ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли НЕ ДатаВходитВРазрешенныйПериод(ИмяФормы, ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": задана дата получения дохода, выходящая за пределы периода с 01.01.1900 по 31.12.2099",
					ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П000П20009003";
			ЗначПок = СокрЛП(Ветка.Данные[ИмяПок]);
			Если ЗначениеЗаполнено(ЗначПок) И ВозмКодыВидаОсвобОтНал.МассивЗначений.Найти(ЗначПок) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": задан некорректный код вида освобождения от налогообложения. Возможны значения: "
					+ ВозмКодыВидаОсвобОтНал.СтрокаЗначений, ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П000П20010003";
			ЗначПок = СокрЛП(Ветка.Данные[ИмяПок]);
			Если ЗначениеЗаполнено(ЗначПок) И ВозмПорядОпредПрибУбКИК.МассивЗначений.Найти(ЗначПок) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": задан некорректный применяемый порядок определения прибыли (убытка) контролируемой иностранной компании."
					+ " Возможны значения: " + ВозмПорядОпредПрибУбКИК.СтрокаЗначений, ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П000П20011003";
			ЗначПок = Ветка.Данные[ИмяПок];
			Если ЗначениеЗаполнено(ЗначПок) И НЕ ДатаВходитВРазрешенныйПериод(ИмяФормы, ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 2 -> Страница " + НомСтраницы
					+ ": задана дата уплаты налога, выходящая за пределы периода с 01.01.1900 по 31.12.2099",
					ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
		КонецЦикла;
		
	КонецЕсли;
	
	// Приложение 3.
	//
	ИмяРаздела = "Приложение3";
	ДеревоРаздела = ДанныеМногоуровневыхРазделов[ИмяРаздела];
	Ветка = ДеревоРаздела.Строки[0];
	НомСтраницы = "1";
	
	// Особая обработка: строки 160-202 выгружаются в составе Приложения 3.
	ИмяРазделаПрод = "Приложение3Продолжение";
	ДеревоРазделаПрод = ДанныеМногоуровневыхРазделов[ИмяРазделаПрод];
	ВеткаПрод = ДеревоРазделаПрод.Строки[0];
	
	// Особая обработка: строки 110-150 выгружаются отдельно от Приложения 3.
	ДопПараметры = СтрРазделить("П000П3М211003,П000П3М212003,П000П3М213003,П000П3М214003,П000П3М215003", ",", Ложь);
	
	ЗаполненоПриложение3 = ЗаполненаСтраницаРаздела(ИмяФормы,
		Ветка, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов, ДопПараметры)
		ИЛИ ЗаполненаСтраницаРаздела(ИмяФормы,
		ВеткаПрод, ИмяРазделаПрод, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов);
	
	Если ЗаполненоПриложение3 Тогда
		
		ВозмКодыВидовДеят = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыВидовДеятельности");
		
		ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП3М1];
		Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
			ИндСтрокиМнЧ = ДанныеМнЧ.Строки.Индекс(СтрокаМнЧ);
			НомСтроки = Формат(ИндСтрокиМнЧ + 1, "ЧГ=");
			Преф = "Приложение 3:" + ?(ДанныеМнЧ.Строки.Количество() > 1, " в группе " + НомСтроки + " строк 010-045", "");
			
			ИмяПок = "П000П3М101003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан код вида деятельности",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмКодыВидовДеят.МассивЗначений.Найти(ЗначПок) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " задан некорректный код вида деятельности. Возможны значения: "
					+ ВозмКодыВидовДеят.СтрокаЗначений, ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
		КонецЦикла;
		
		ИмяПок = "П000П30008003";
		ЗначПок = СокрЛП(Ветка.Данные[ИмяПок]);
		Если ЗначениеЗаполнено(ЗначПок)
			И НЕ (СтрДлина(ЗначПок) = 4 И СтроковыеФункцииКлиентсервер.ТолькоЦифрыВСтроке(ЗначПок)) Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки,
				"Приложение 3: задан год регистрации крестьянского (фермерского) хозяйства, не состоящий из 4 цифр",
				ИмяРаздела, ИмяПок, НомСтраницы);
			СтатусПроверки = Ложь;
		КонецЕсли;
		
	КонецЕсли;
	
	// Особая обработка: строки 110-150 выгружаются отдельно от Приложения 3.
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП3М2];
	Если ЗаполненаМногострочнаяЧасть(ИмяФормы,
		ДанныеМнЧ, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ВозмКодыИстДохода = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыИсточникаДохода");
		
		Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
			ИндСтрокиМнЧ = ДанныеМнЧ.Строки.Индекс(СтрокаМнЧ);
			НомСтроки = Формат(ИндСтрокиМнЧ + 1, "ЧГ=");
			Преф = "Приложение 3:" + ?(ДанныеМнЧ.Строки.Количество() > 1, " в группе " + НомСтроки + " строк 110-150", "");
			
			ИмяПок = "П000П3М211003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан код источника дохода",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмКодыИстДохода.МассивЗначений.Найти(ЗначПок) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " задан некорректный код источника дохода. Возможны значения: "
					+ ВозмКодыИстДохода.СтрокаЗначений, ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
		КонецЦикла;
	КонецЕсли;
	
	// Приложение 4.
	//
	ИмяРаздела = "Приложение4";
	ДеревоРаздела = ДанныеМногоуровневыхРазделов[ИмяРаздела];
	Ветка = ДеревоРаздела.Строки[0];
	НомСтраницы = "1";
	
	Если ЗаполненаСтраницаРаздела(
		ИмяФормы, Ветка, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ИменаПоказателей = СтрРазделить(
			"П000П40002003,П000П40003003,П000П40004003,П000П40005003,П000П40006003,П000П40007003,П000П40008003,П000П40009003",
			",", Ложь);
		Для каждого ИмяПок Из ИменаПоказателей Цикл
			Если Окр(Ветка.Данные[ИмяПок], 2) > 4000 Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 4: значение в строке "
					+ Сред(ИмяПок, 9, 3) + " не должно превышать 4 000", ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
		КонецЦикла;
		
		ИмяПок = "П000П40010003";
		Если Окр(Ветка.Данные[ИмяПок], 2) > 12000 Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 4: значение в строке "
				+ Сред(ИмяПок, 9, 3) + " не должно превышать 12 000", ИмяРаздела, ИмяПок, НомСтраницы);
			СтатусПроверки = Ложь;
		КонецЕсли;
		
		ИмяПок = "П000П40010503";
		Если Окр(Ветка.Данные[ИмяПок], 2) > 50000000 Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 4: значение в строке "
				+ Сред(ИмяПок, 9, 3) + " не должно превышать 50 000 000", ИмяРаздела, ИмяПок, НомСтраницы);
			СтатусПроверки = Ложь;
		КонецЕсли;
		
	КонецЕсли;
	
	// Приложение 5.
	//
	ИмяРаздела = "Приложение5";
	ДеревоРаздела = ДанныеМногоуровневыхРазделов[ИмяРаздела];
	Ветка = ДеревоРаздела.Строки[0];
	НомСтраницы = "1";
	
	Если ЗаполненаСтраницаРаздела(
		ИмяФормы, Ветка, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ИменаПоказателей = СтрРазделить("П000П50021003,П000П50023503", ",", Ложь);
		Для каждого ИмяПок Из ИменаПоказателей Цикл
			Если Окр(Ветка.Данные[ИмяПок], 2) > 400000 Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 5: значение в строке "
					+ Сред(ИмяПок, 9, 3) + " не должно превышать 400 000", ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
		КонецЦикла;
		
	КонецЕсли;
	
	// Приложение 6.
	//
	ИмяРаздела = "Приложение6";
	ДеревоРаздела = ДанныеМногоуровневыхРазделов[ИмяРаздела];
	Ветка = ДеревоРаздела.Строки[0];
	НомСтраницы = "1";
	
	Если ЗаполненаСтраницаРаздела(
		ИмяФормы, Ветка, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ИменаПоказателей = СтрРазделить("П000П60001003,П000П60003003", ",", Ложь);
		Для каждого ИмяПок Из ИменаПоказателей Цикл
			Если Окр(Ветка.Данные[ИмяПок], 2) > 1000000 Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 6: значение в строке "
					+ Сред(ИмяПок, 9, 3) + " не должно превышать 1 000 000", ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
		КонецЦикла;
		
		ИменаПоказателей = СтрРазделить("П000П60005003,П000П60007003", ",", Ложь);
		Для каждого ИмяПок Из ИменаПоказателей Цикл
			Если Окр(Ветка.Данные[ИмяПок], 2) > 250000 Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, "Приложение 6: значение в строке "
					+ Сред(ИмяПок, 9, 3) + " не должно превышать 250 000", ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
		КонецЦикла;
		
	КонецЕсли;
	
	// Приложение 7.
	//
	ИмяРаздела = "Приложение7";
	ДеревоРаздела = ДанныеМногоуровневыхРазделов[ИмяРаздела];
	Ветка = ДеревоРаздела.Строки[0];
	НомСтраницы = "1";
	
	Если ЗаполненаСтраницаРаздела(
		ИмяФормы, Ветка, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ВозмКодыНаимОб = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыНаименованияОбъекта");
		ВозмКодыПрНал  = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыПризнакаНалогоплательщика");
		ВозмСпПриобрЖД = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "СпособыПриобретенияЖилогоДома");
		
		ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП7М1];
		Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
			ИндСтрокиМнЧ = ДанныеМнЧ.Строки.Индекс(СтрокаМнЧ);
			НомСтроки = Формат(ИндСтрокиМнЧ + 1, "ЧГ=");
			Преф = "Приложение 7:" + ?(ДанныеМнЧ.Строки.Количество() > 1, " в группе " + НомСтроки + " строк 010-090", "");
			
			ИмяПок = "П000П7М101003";
			КодНаимОб = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(КодНаимОб) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан код наименования объекта",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмКодыНаимОб.МассивЗначений.Найти(КодНаимОб) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " задан некорректный код наименования объекта. Возможны значения: " + ВозмКодыНаимОб.СтрокаЗначений,
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			Иначе
				ИмяПок_ = "П000П7М103003";
				ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок_]);
				Если КодНаимОб = "1" ИЛИ КодНаимОб = "7" Тогда
					Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
						СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
							+ " способ приобретения жилого дома должен быть задан, если код наименования объекта равен 1 или 7",
						ИмяРаздела, ИмяПок_ + "_" + НомСтроки, НомСтраницы);
						СтатусПроверки = Ложь;
					ИначеЕсли ВозмСпПриобрЖД.МассивЗначений.Найти(ЗначПок) = Неопределено Тогда
						СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
							+ " задан некорректный способ приобретения жилого дома. Возможны значения: " + ВозмСпПриобрЖД.СтрокаЗначений,
							ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
						СтатусПроверки = Ложь;
					КонецЕсли;
				Иначе// КодНаимОб <> "1" И КодНаимОб <> "7"
					Если ЗначениеЗаполнено(ЗначПок) Тогда
						СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
							+ " способ приобретения жилого дома не должен быть задан, если код наименования объекта неравен 1 или 7",
						ИмяРаздела, ИмяПок_ + "_" + НомСтроки, НомСтраницы);
						СтатусПроверки = Ложь;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			ИмяПок = "П000П7М102003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан код признака налогоплательщика",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмКодыПрНал.МассивЗначений.Найти(ЗначПок) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " задан некорректный код признака налогоплательщика. Возможны значения: " + ВозмКодыПрНал.СтрокаЗначений,
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П000П7М103203";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан кадастровый номер объекта",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П000П7М104003";
			ЗначПок = СтрокаМнЧ.Данные[ИмяПок];
			Если ЗначениеЗаполнено(ЗначПок) И НЕ ДатаВходитВРазрешенныйПериод(ИмяФормы, ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " задана дата акта о передаче квартиры,"
					+ " комнаты или доли (долей) в них, выходящая за пределы периода с 01.01.1900 по 31.12.2099",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П000П7М105003";
			ЗначПок = СтрокаМнЧ.Данные[ИмяПок];
			Если ЗначениеЗаполнено(ЗначПок) И НЕ ДатаВходитВРазрешенныйПериод(ИмяФормы, ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " задана дата регистрации права собственности на"
					+ " объект или долю (доли) в нем, выходящая за пределы периода с 01.01.1900 по 31.12.2099",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
		КонецЦикла;
		
		Стр140 = Окр(Ветка.Данные["П000П70014003"], 2);
		Стр150 = Окр(Ветка.Данные["П000П70015003"], 2);
		Стр160 = Окр(Ветка.Данные["П000П70016003"], 2);
		Если Стр150 + Стр160 > Стр140 Тогда
			СообщитьВТС(ИмяФормы, РезультатВыгрузки,
				"Приложение 7: сумма строк 150 и 160 не может превышать значение в стр 140",
				ИмяРаздела, "П000П70014003", НомСтраницы);
			СтатусПроверки = Ложь;
		КонецЕсли;
		
	КонецЕсли;
	
	// Приложение 8.
	//
	ИмяРаздела = "Приложение8";
	ДеревоРаздела = ДанныеМногоуровневыхРазделов[ИмяРаздела];
	
	Если ЗаполненРаздел(ИмяФормы, ДанныеМногоуровневыхРазделов[ИмяРаздела],
		ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ВозмКодыВидаОпер   = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыВидаОперации");
		ВозмКодыВидаОперУб = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыВидаОперацииУбыт");
		ВозмПрУчУбытков    = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "ПризнакиУчетаУбытков");
		
		Для Каждого Ветка Из ДеревоРаздела.Строки Цикл
			
			НомСтраницы = Формат(ДеревоРаздела.Строки.Индекс(Ветка) + 1, "ЧГ=");
			Преф = "Приложение 7 -> Страница " + НомСтраницы + ":";
			
			Стр052 = 0;
			
			ИмяПок = "П000П80001003";
			ЗначПок = СокрЛП(Ветка.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан код вида операции",
					ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмКодыВидаОпер.МассивЗначений.Найти(ЗначПок) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " задан некорректный код вида операции. Возможны значения: "
					+ ВозмКодыВидаОпер.СтрокаЗначений, ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П000П80005003";
			ПризУчетУбыт = СокрЛП(Ветка.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ПризУчетУбыт) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан признак учета убытков",
					ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмПрУчУбытков.МассивЗначений.Найти(ПризУчетУбыт) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " задан некорректный признак учета убытков. Возможны значения: "
					+ ВозмПрУчУбытков.СтрокаЗначений, ИмяРаздела, ИмяПок, НомСтраницы);
				СтатусПроверки = Ложь;
			Иначе
				ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП8М1];
				Если ПризУчетУбыт = "1" Тогда
					Если ДанныеМнЧ.Строки.Количество() > 3 Тогда
						СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " возможно не более 3 групп строк 051-052",
							ИмяРаздела, "П000П8М105103_4", НомСтраницы);
						СтатусПроверки = Ложь;
					ИначеЕсли НЕ ЗаполненаМногострочнаяЧасть(ИмяФормы,
						ДанныеМнЧ, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
						СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
							+ " строки 051-052 должны быть заполнены, если признак учета убытков равен 1",
							ИмяРаздела, "П000П8М105103_1", НомСтраницы);
						СтатусПроверки = Ложь
					Иначе
						Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
							ИндСтрокиМнЧ = ДанныеМнЧ.Строки.Индекс(СтрокаМнЧ);
							НомСтроки = Формат(ИндСтрокиМнЧ + 1, "ЧГ=");
							ПрефП8М1 = Преф + ?(ДанныеМнЧ.Строки.Количество() > 1, " в группе " + НомСтроки + " строк 051-052", "");
							
							ИмяПок = "П000П8М105103";
							КодНаимОб = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
							Если НЕ ЗначениеЗаполнено(КодНаимОб) Тогда
								СообщитьВТС(ИмяФормы, РезультатВыгрузки, ПрефП8М1
									+ " не задан код вида операции, по которой принимается убыток",
									ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
								СтатусПроверки = Ложь;
							ИначеЕсли ВозмКодыВидаОперУб.МассивЗначений.Найти(КодНаимОб) = Неопределено Тогда
								СообщитьВТС(ИмяФормы, РезультатВыгрузки, ПрефП8М1
									+ " задан некорректный код вида операции, по которой принимается убыток. Возможны значения: "
									+ ВозмКодыВидаОперУб.СтрокаЗначений, ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
								СтатусПроверки = Ложь;
							КонецЕсли;
							
							Стр052 = Стр052 + Окр(СтрокаМнЧ.Данные["П000П8М105203"], 2);
							
						КонецЦикла;
					КонецЕсли;
				Иначе// ПризУчетУбыт = "0"
					Если ЗаполненаМногострочнаяЧасть(ИмяФормы,
						ДанныеМнЧ, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
						СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
							+ " строки 051-052 не должны быть заполнены, если признак учета убытков равен 0",
							ИмяРаздела, "П000П8М105103_1", НомСтраницы);
						СтатусПроверки = Ложь;
					КонецЕсли;
				КонецЕсли;
				
			КонецЕсли;
			
			Стр020 = Окр(Ветка.Данные["П000П80002003"], 2);
			Стр040 = Окр(Ветка.Данные["П000П80004003"], 2);
			Стр060 = Окр(Ветка.Данные["П000П80006003"], 2);
			Стр070 = Окр(Ветка.Данные["П000П80007003"], 2);
			Стр080 = Окр(Ветка.Данные["П000П80008003"], 2);
			Если Стр040 + Стр052 + Стр060 + Стр070 + Стр080 > Стр020 Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " сумма строк 040, 052, 060, 070, 080 не может превышать значение в стр 020",
					ИмяРаздела, "П000П80002003", НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
		КонецЦикла;
		
	КонецЕсли;
	
	// Расчет к Приложению 1.
	//
	ИмяРаздела = "Приложение1Расчет";
	ДеревоРаздела = ДанныеМногоуровневыхРазделов[ИмяРаздела];
	Ветка = ДеревоРаздела.Строки[0];
	НомСтраницы = "1";
	
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП1РМ1];
	Если ЗаполненаМногострочнаяЧасть(ИмяФормы,
		ДанныеМнЧ, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ВозмВидыПолучДох = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "ВидыПолученияДохода");
		
		Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
			ИндСтрокиМнЧ = ДанныеМнЧ.Строки.Индекс(СтрокаМнЧ);
			НомСтроки = Формат(ИндСтрокиМнЧ + 1, "ЧГ=");
			Преф = "Расчет к Приложению 1 -> пункт 1:" + ?(ДанныеМнЧ.Строки.Количество() > 1,
				" в группе " + НомСтроки + " строк 010-060", "");
			
			ИмяПок = "П00П1РМ101003";
			ВидДох = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ВидДох) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан вид получения дохода",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмВидыПолучДох.МассивЗначений.Найти(ВидДох) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " задан некорректный вид получения дохода. Возможны значения: "
					+ ВозмВидыПолучДох.СтрокаЗначений, ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВидДох <> "1" Тогда
				ИмяПок_ = "П00П1РМ103003";
				Если Окр(СтрокаМнЧ.Данные[ИмяПок_], 2) <> 0 Тогда
					СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " кадастровая стоимость объекта недвижимого"
					+ " имущества, определенная в соответствии со статьей 214.10 НК РФ, не должна быть задана,"
					+ " если вид получения дохода неравен 1", ИмяРаздела, ИмяПок_ + "_" + НомСтроки, НомСтраницы);
					СтатусПроверки = Ложь;
				КонецЕсли;
				ИмяПок_ = "П00П1РМ105003";
				Если Окр(СтрокаМнЧ.Данные[ИмяПок_], 2) <> 0 Тогда
					СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " кадастровая стоимость, указанная в строке 030,"
					+ " с учетом коэффициента, установленного статьей 214.10 НК РФ, не должна быть задана,"
					+ " если вид получения дохода неравен 1", ИмяРаздела, ИмяПок_ + "_" + НомСтроки, НомСтраницы);
					СтатусПроверки = Ложь;
				КонецЕсли;
			КонецЕсли;
			
			ИмяПок = "П00П1РМ102003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан кадастровый номер объекта недвижимого имущества",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
		КонецЦикла;
	КонецЕсли;
	
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП1РМ2];
	Если ЗаполненаМногострочнаяЧасть(ИмяФормы,
		ДанныеМнЧ, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ВозмВидыПолучДох = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "ВидыПолученияДохода");
		ВозмКодыВидаТС  = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыВидаТранспортногоСредства");
		
		Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
			ИндСтрокиМнЧ = ДанныеМнЧ.Строки.Индекс(СтрокаМнЧ);
			НомСтроки = Формат(ИндСтрокиМнЧ + 1, "ЧГ=");
			Преф = "Расчет к Приложению 1 -> пункт 2:" + ?(ДанныеМнЧ.Строки.Количество() > 1,
				" в группе " + НомСтроки + " строк 070-110", "");
			
			ИмяПок = "П00П1РМ207003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан вид получения дохода",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмВидыПолучДох.МассивЗначений.Найти(ЗначПок) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " задан некорректный вид получения дохода. Возможны значения: "
					+ ВозмВидыПолучДох.СтрокаЗначений, ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П1РМ208003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан код вида транспортного средства",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмКодыВидаТС.МассивЗначений.Найти(ЗначПок) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " задан некорректный код вида транспортного средства. Возможны значения: "
					+ ВозмКодыВидаТС.СтрокаЗначений, ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П1РМ209003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не заданы марка и модель транспортного средства",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П1РМ210003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " не задан государственный регистрационный знак (номер) транспортного средства",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
		КонецЦикла;
	КонецЕсли;
	
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП1РМ3];
	Если ЗаполненаМногострочнаяЧасть(ИмяФормы,
		ДанныеМнЧ, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
			ИндСтрокиМнЧ = ДанныеМнЧ.Строки.Индекс(СтрокаМнЧ);
			НомСтроки = Формат(ИндСтрокиМнЧ + 1, "ЧГ=");
			Преф = "Расчет к Приложению 1 -> пункт 3:" + ?(ДанныеМнЧ.Строки.Количество() > 1,
				" в группе " + НомСтроки + " строк 120-140", "");
			
			ИмяПок = "П00П1РМ312003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан номер договора",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П1РМ313003";
			ЗначПок = СтрокаМнЧ.Данные[ИмяПок];
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задана дата договора",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли НЕ ДатаВходитВРазрешенныйПериод(ИмяФормы, ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " задана дата договора, выходящая за пределы периода с 01.01.1900 по 31.12.2099",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
		КонецЦикла;
	КонецЕсли;
	
	// Расчет к Приложению 5.
	//
	ИмяРаздела = "Приложение5Расчет";
	ДеревоРаздела = ДанныеМногоуровневыхРазделов[ИмяРаздела];
	Ветка = ДеревоРаздела.Строки[0];
	НомСтраницы = "1";
	
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП5РМ1];
	Если ЗаполненаМногострочнаяЧасть(ИмяФормы,
		ДанныеМнЧ, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ВозмКодыВидаДог = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "КодыВидаДоговора");
		ВозмПрПредВыч_1 = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "ПризнакиПредоставленияВычета_1");
		
		Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
			ИндСтрокиМнЧ = ДанныеМнЧ.Строки.Индекс(СтрокаМнЧ);
			НомСтроки = Формат(ИндСтрокиМнЧ + 1, "ЧГ=");
			Преф = "Расчет к Приложению 5 -> пункт 1.1:" + ?(ДанныеМнЧ.Строки.Количество() > 1,
				" в группе " + НомСтроки + " строк 010-061", "");
			
			ИмяПок = "П00П5РМ101003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " не задан ИНН негосударственного пенсионного фонда или страховой организации",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли НЕ (СтрДлина(ЗначПок) = 10 И СтроковыеФункцииКлиентсервер.ТолькоЦифрыВСтроке(ЗначПок)) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " задан ИНН негосударственного пенсионного фонда или страховой организации, не состоящий из 10 цифр",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П5РМ102003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " не задан КПП негосударственного пенсионного фонда или страховой организации",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли СтрДлина(ЗначПок) <> 9 Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " задан КПП негосударственного пенсионного фонда или страховой организации, не состоящий из 9 символов",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П5РМ102103";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан код вида договора",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмКодыВидаДог.МассивЗначений.Найти(ЗначПок) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " задан некорректный код вида договора. Возможны значения: "
					+ ВозмКодыВидаДог.СтрокаЗначений, ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П5РМ103003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " не задано нaимeнование негосударственного пенсионного фонда или страховой организации",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П5РМ104003";
			ЗначПок = СтрокаМнЧ.Данные[ИмяПок];
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задана дата договора",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли НЕ ДатаВходитВРазрешенныйПериод(ИмяФормы, ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " задана дата договора, выходящая за пределы периода с 01.01.1900 по 31.12.2099",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П5РМ105003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан номер договора",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П5РМ106103";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан признак предоставления вычета в упрощенном порядке",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмПрПредВыч_1.МассивЗначений.Найти(ЗначПок) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " задан некорректный признак предоставления вычета в упрощенном порядке. Возможны значения: "
					+ ВозмПрПредВыч_1.СтрокаЗначений, ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
		КонецЦикла;
		
	КонецЕсли;
	
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП5РМ2];
	Если ЗаполненаМногострочнаяЧасть(ИмяФормы,
		ДанныеМнЧ, ИмяРаздела, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		
		ВозмПрОснЗаявНВыч = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "ПризнакиОснЗаявленияНалВычета");
		ВозмПрПредВыч_2 = ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, "ПризнакиПредоставленияВычета_2");
		
		Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
			ИндСтрокиМнЧ = ДанныеМнЧ.Строки.Индекс(СтрокаМнЧ);
			НомСтроки = Формат(ИндСтрокиМнЧ + 1, "ЧГ=");
			Преф = "Расчет к Приложению 5 -> пункт 2:" + ?(ДанныеМнЧ.Строки.Количество() > 1,
				" в группе " + НомСтроки + " строк 080-160", "");
			
			ИмяПок = "П00П5РМ208003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан признак основания заявления налогового вычета",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмПрОснЗаявНВыч.МассивЗначений.Найти(ЗначПок) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " задан некорректный признак основания заявления налогового вычета. Возможны значения: "
					+ ВозмПрОснЗаявНВыч.СтрокаЗначений, ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П5РМ209003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " не задан ИНН профессионального участника рынка ценных бумаг, управляющей компании"
					+ " открытого паевого инвестиционного фонда", ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли НЕ (СтрДлина(ЗначПок) = 10 И СтроковыеФункцииКлиентсервер.ТолькоЦифрыВСтроке(ЗначПок)) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " задан ИНН профессионального участника рынка ценных бумаг, управляющей компании"
					+ " открытого паевого инвестиционного фонда, не состоящий из 10 цифр",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П5РМ210003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " не задан КПП профессионального участника рынка ценных бумаг, управляющей компании"
					+ " открытого паевого инвестиционного фонда",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли СтрДлина(ЗначПок) <> 9 Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " задан КПП профессионального участника рынка ценных бумаг, управляющей компании"
					+ " открытого паевого инвестиционного фонда, не состоящий из 9 символов",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П5РМ211003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задано Полное наименование профессионального"
					+ " участника рынка ценных бумаг, управляющей компании открытого паевого инвестиционного фонда",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П5РМ212003";
			ЗначПок = СтрокаМнЧ.Данные[ИмяПок];
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задана дата договора на ведение индивидуального"
					+ " инвестиционного счета", ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли НЕ ДатаВходитВРазрешенныйПериод(ИмяФормы, ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " задана дата договора на ведение индивидуального"
					+ " инвестиционного счета, выходящая за пределы периода с 01.01.1900 по 31.12.2099",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П5РМ213003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан номер договора на ведение индивидуального"
					+ " инвестиционного счета", ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П5РМ214003";
			ЗначПок = СтрокаМнЧ.Данные[ИмяПок];
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задана дата открытия индивидуального инвестиционного счета",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли НЕ ДатаВходитВРазрешенныйПериод(ИмяФормы, ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " задана дата открытия индивидуального инвестиционного счета,"
					+ " выходящая за пределы периода с 01.01.1900 по 31.12.2099", ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
			ИмяПок = "П00П5РМ216003";
			ЗначПок = СокрЛП(СтрокаМнЧ.Данные[ИмяПок]);
			Если НЕ ЗначениеЗаполнено(ЗначПок) Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф + " не задан признак предоставления вычета в упрощенном порядке",
					ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			ИначеЕсли ВозмПрПредВыч_2.МассивЗначений.Найти(ЗначПок) = Неопределено Тогда
				СообщитьВТС(ИмяФормы, РезультатВыгрузки, Преф
					+ " задан некорректный признак предоставления вычета в упрощенном порядке. Возможны значения: "
					+ ВозмПрПредВыч_2.СтрокаЗначений, ИмяРаздела, ИмяПок + "_" + НомСтроки, НомСтраницы);
				СтатусПроверки = Ложь;
			КонецЕсли;
			
		КонецЦикла;
		
	КонецЕсли;
	
	Возврат СтатусПроверки;
	
КонецФункции

Функция ВозможныеЗначенияИзСпискаВыбораПоказателя(ИмяФормы, ИмяГруппыЗначений)
	
	МакетСоставаПоказателей = ЭтотОбъект.ПолучитьМакет("СпискиВыбора2025Кв4");
	
	МассивЗначений = Неопределено;
	СтрокаЗначений = Неопределено;
	
	Область = МакетСоставаПоказателей.Области.Найти(ИмяГруппыЗначений);
	Если Область <> Неопределено Тогда
		МассивЗначений = Новый Массив;
		ВерхОбласти = Область.Верх;
		НизОбласти  = Область.Низ;
		Для НомСтр = ВерхОбласти По НизОбласти Цикл
			ТекЗначение = СокрП(МакетСоставаПоказателей.Область(НомСтр, 1).Текст);
			Если ЗначениеЗаполнено(ТекЗначение) Тогда
				МассивЗначений.Добавить(ТекЗначение);
			КонецЕсли;
		КонецЦикла;
		СтрокаЗначений = СтрСоединить(МассивЗначений, ", ");
	КонецЕсли;
	
	Возврат Новый Структура("МассивЗначений, СтрокаЗначений", МассивЗначений, СтрокаЗначений);
	
КонецФункции

Процедура СообщитьВТС(ИмяФормы, Владелец, Описание, Раздел, ИмяЯчейки, ФИО = "") Экспорт
	
	РегламентированнаяОтчетность.СообщитьВТаблицуСообщений(Владелец, Описание, Раздел, ИмяЯчейки, ФИО);
	
КонецПроцедуры

Функция ЗаполненРаздел(ИмяФормы,
					   Знач ДеревоРаздела,
					   Знач ИмяРаздела,
					   СтруктураРеквизитовФормы,
					   СтруктураМногоуровневыхРазделов,
					   ДопПараметры = Неопределено) Экспорт
	
	Для каждого СтраницаРаздела Из ДеревоРаздела.Строки Цикл
		Если ЗаполненаСтраницаРаздела(ИмяФормы,
									  СтраницаРаздела,
									  ИмяРаздела,
									  СтруктураРеквизитовФормы,
									  СтруктураМногоуровневыхРазделов,
									  ДопПараметры) Тогда
			Возврат Истина;
		КонецЕсли;
	КонецЦикла;
	
	Возврат Ложь;
	
КонецФункции

Функция ЗаполненаСтраницаРаздела(ИмяФормы,
								 Знач СтраницаРаздела,
								 Знач ИмяРаздела,
								 СтруктураРеквизитовФормы,
								 СтруктураМногоуровневыхРазделов,
								 ДопПараметры = Неопределено)
	
	ПоказателиНеанализируемыеНаЗаполненность
	= ПоказателиНеанализируемыеНаЗаполненность(ИмяФормы, ИмяРаздела, ДопПараметры);
	
	Данные = СтраницаРаздела.Данные;
	Для каждого Пок Из Данные Цикл
		Если ЗначениеЗаполнено(Пок.Значение) И ПоказателиНеанализируемыеНаЗаполненность.Найти(Пок.Ключ) = Неопределено Тогда
			Возврат Истина;
		КонецЕсли;
	КонецЦикла;
	
	Если СтруктураМногоуровневыхРазделов[ИмяРаздела].Свойство("ИменаГруппМнЧ") Тогда
		ИменаГруппМнЧ = СтруктураМногоуровневыхРазделов[ИмяРаздела]["ИменаГруппМнЧ"];
		Для каждого ИмяГруппы Из ИменаГруппМнЧ Цикл
			ДеревоМнЧ = СтраницаРаздела.ДанныеМногострочныхЧастей[ИмяГруппы];
			Если ЗаполненаМногострочнаяЧасть(ИмяФормы,
											 ДеревоМнЧ,
											 ИмяРаздела,
											 СтруктураРеквизитовФормы,
											 СтруктураМногоуровневыхРазделов,
											 ДопПараметры) Тогда
				Возврат Истина;
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	
	Если СтруктураМногоуровневыхРазделов[ИмяРаздела].Свойство("ИменаПодчиненныхРазделов") Тогда
		ИменаПодчРазделов = СтруктураМногоуровневыхРазделов[ИмяРаздела]["ИменаПодчиненныхРазделов"];
		Для ИндПодчРаздела = 0 По ИменаПодчРазделов.Количество() - 1 Цикл
			ДеревоПодчРаздела = СтраницаРаздела.Строки[ИндПодчРаздела];
			ИмяПодчРаздела = ИменаПодчРазделов[ИндПодчРаздела];
			Если ЗаполненРаздел(ИмяФормы,
								ДеревоПодчРаздела,
								ИмяПодчРаздела,
								СтруктураРеквизитовФормы,
								СтруктураМногоуровневыхРазделов,
								ДопПараметры) Тогда
				Возврат Истина;
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	
	Возврат Ложь;
	
КонецФункции

Функция ЗаполненаМногострочнаяЧасть(ИмяФормы,
									Знач ДеревоМнЧ,
									Знач ИмяРаздела,
									СтруктураРеквизитовФормы,
									СтруктураМногоуровневыхРазделов,
									ДопПараметры = Неопределено)
	
	Для Каждого СтрокаМнЧ Из ДеревоМнЧ.Строки Цикл
		Если ЗаполненаСтрокаМногострочнойЧасти(ИмяФормы,
											   СтрокаМнЧ,
											   ИмяРаздела,
											   СтруктураРеквизитовФормы,
											   СтруктураМногоуровневыхРазделов,
											   ДопПараметры) Тогда
			Возврат Истина;
		КонецЕсли;
	КонецЦикла;
	
	Возврат Ложь;
	
КонецФункции

Функция ЗаполненаСтрокаМногострочнойЧасти(ИмяФормы,
										  Знач СтрокаМнЧ,
										  Знач ИмяРаздела,
										  СтруктураРеквизитовФормы,
										  СтруктураМногоуровневыхРазделов,
										  ДопПараметры = Неопределено)
	
	ИмяГруппыМнЧ = Неопределено;
	
	ПоказателиНеанализируемыеНаЗаполненность
	= ПоказателиНеанализируемыеНаЗаполненность(ИмяФормы, ИмяРаздела, ДопПараметры);
	
	Для каждого Пок Из СтрокаМнЧ.Данные Цикл
		Если НЕ ЗначениеЗаполнено(ИмяГруппыМнЧ) Тогда
			ИмяГруппыМнЧ = Лев(Пок.Ключ, СтруктураРеквизитовФормы.ДлинаИмениГруппы);
		КонецЕсли;
		Если ЗначениеЗаполнено(Пок.Значение) И ПоказателиНеанализируемыеНаЗаполненность.Найти(Пок.Ключ) = Неопределено Тогда
			Возврат Истина;
		КонецЕсли;
	КонецЦикла;
	
	Если ЗначениеЗаполнено(ИмяГруппыМнЧ) Тогда
		ИменаПодчГруппМнЧ = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппыМнЧ]["ИменаПодчиненныхГрупп"];
		Для каждого ИмяПодчГруппыМнЧ Из ИменаПодчГруппМнЧ Цикл
			ДанныеПодчМнЧ = СтрокаМнЧ.ДанныеМногострочныхЧастей[ИмяПодчГруппыМнЧ];
			Для Каждого СтрокаПодчМнЧ Из ДанныеПодчМнЧ.Строки Цикл
				Если ЗаполненаСтрокаМногострочнойЧасти(ИмяФормы,
													   СтрокаПодчМнЧ,
													   ИмяРаздела,
													   СтруктураРеквизитовФормы,
													   СтруктураМногоуровневыхРазделов,
													   ДопПараметры) Тогда
					Возврат Истина;
				КонецЕсли;
			КонецЦикла;
		КонецЦикла;
	КонецЕсли;
	
	Возврат Ложь;
	
КонецФункции

Функция ПоказателиНеанализируемыеНаЗаполненность(ИмяФормы, Знач ИмяРаздела, ДопПараметры = Неопределено)
	
	ИменаПоказателей = Новый Массив;
	
	Если ТипЗнч(ДопПараметры) = Тип("Массив") Тогда
		
		Возврат ДопПараметры;
		
	КонецЕсли;
	
	Возврат ИменаПоказателей;
	
КонецФункции

Функция ДатаВходитВРазрешенныйПериод(ИмяФормы,
									 ПровДата,
									 ЛеваяГраница = '19000101',
									 ПраваяГраница = '20991231') Экспорт
	
	Возврат ПровДата >= ЛеваяГраница И ПровДата <= ПраваяГраница;
	
КонецФункции

Процедура ЗаполнитьДанными(ИмяФормы,
						   ДанныеОтчета,
						   ПараметрыВыгрузки,
						   ДеревоВыгрузки,
						   РезультатВыгрузки,
						   СтруктураРеквизитовФормы,
						   СтруктураМногоуровневыхРазделов) Экспорт
	
	ОбработатьУсловныеЭлементы(ИмяФормы,
							   ДанныеОтчета,
							   ПараметрыВыгрузки,
							   ДеревоВыгрузки,
							   РезультатВыгрузки);
	
	ЗаполнитьДаннымиУзел(ИмяФормы,
						 СтруктураРеквизитовФормы,
						 СтруктураМногоуровневыхРазделов,
						 ПараметрыВыгрузки,
						 ДеревоВыгрузки);
	
	ОтсечьНезаполненныеНеобязательныеУзлы(ИмяФормы, ДеревоВыгрузки, ПараметрыВыгрузки);
	
КонецПроцедуры

Процедура ВосстановитьСохраненныеДанныеОтчетаСтарогоОбразца(ИмяФормы,
															СписокСохранения,
															СтруктураРеквизитовФормы,
															СтруктураМногоуровневыхРазделов)
	
	Возврат;
	
КонецПроцедуры

Функция ИдентификаторФайлаВыгрузки(ИмяФормы, ПараметрыВыгрузки, ПрефиксИмени)
	
	ИдентификаторФайла = ПрефиксИмени
		+ "_" + ?(ЗначениеЗаполнено(ПараметрыВыгрузки.КодИФНСПосредника),
			ПараметрыВыгрузки.КодИФНСПосредника, ПараметрыВыгрузки.КодНО)
		+ "_" + ПараметрыВыгрузки.КодНО
		+ "_" + СокрЛП(ПараметрыВыгрузки.ИННФЛ)
		+ "_" + Формат(ТекущаяДатаСеанса(), "ДФ=ггггММдд")
		+ "_" + Строка(Новый УникальныйИдентификатор);
	
	Возврат ИдентификаторФайла;
	
КонецФункции

Процедура ОбработатьУсловныеЭлементы(ИмяФормы,
									 ДанныеОтчета,
									 Знач ПараметрыВыгрузки,
									 Узел,
									 РезультатВыгрузки)
	
	Если ТипЗнч(Узел) <> Тип("ДеревоЗначений") Тогда
		Если Узел.Код = ПараметрыВыгрузки.ИмяКлючевогоУзлаСодержательнойЧасти Тогда
			Возврат;
		КонецЕсли;
		РегламентированнаяОтчетность.ДополнитьСтруктуруПараметров(ДанныеОтчета, ПараметрыВыгрузки, Узел);
	КонецЕсли;
	КоличествоСтрок = Узел.Строки.Количество();
	Для Инд = 1 По КоличествоСтрок Цикл
		ТекСтр = Узел.Строки.Получить(КоличествоСтрок - Инд);
		Если НЕ ПустаяСтрока(ТекСтр.Условие) Тогда
			Если НЕ РегламентированнаяОтчетность.УсловиеВыполнено(РезультатВыгрузки, ПараметрыВыгрузки, ТекСтр.Условие) Тогда
				Узел.Строки.Удалить(ТекСтр);
				Продолжить;
			КонецЕсли;
		КонецЕсли;
		ОбработатьУсловныеЭлементы(ИмяФормы,
								   ДанныеОтчета,
								   ПараметрыВыгрузки,
								   ТекСтр,
								   РезультатВыгрузки);
	КонецЦикла;
	
КонецПроцедуры

Процедура ЗаполнитьДаннымиУзел(ИмяФормы,
							   СтруктураРеквизитовФормы,
							   СтруктураМногоуровневыхРазделов,
							   ПараметрыВыгрузки,
							   Узел,
							   НомерСтроки = Неопределено)
	
	СтрокиУзла = Новый Массив;
	Для Каждого Стр Из Узел.Строки Цикл
		СтрокиУзла.Добавить(Стр);
	КонецЦикла;
	
	Для Каждого Стр из СтрокиУзла Цикл
		Если Стр.Тип = "С" ИЛИ Стр.Тип = "C" Тогда // учет обоих вариантов: кириллицы и латиницы
			Если РегламентированнаяОтчетностьКлиентСервер.СвойствоОпределено(ПараметрыВыгрузки,
				"ИмяКлючевогоУзлаСодержательнойЧасти") И Стр.Код = ПараметрыВыгрузки.ИмяКлючевогоУзлаСодержательнойЧасти Тогда
				ЗаполнитьСодержательнуюЧасть(ИмяФормы,
											 СтруктураРеквизитовФормы,
											 СтруктураМногоуровневыхРазделов,
											 Стр,
											 ПараметрыВыгрузки);
			ИначеЕсли Стр.Многострочность Тогда
				НомСтр = 1;
				ПодчиненныйЭлемент = ПолучитьПервыйПодчиненныйУзелСЗаполненнымКлючом(ИмяФормы, Стр);
				КлючПодчиненногоЭлемента = ПодчиненныйЭлемент.Ключ;
				Пока РегламентированнаяОтчетностьКлиентСервер.СвойствоОпределено(ПараметрыВыгрузки,
						КлючПодчиненногоЭлемента + "_" + Формат(НомСтр, "ЧГ=")) Цикл
					УзелСоответствующийСтроке = СкопироватьУзел(ИмяФормы, Узел, Стр);
					ЗаполнитьДаннымиУзел(ИмяФормы,
										 СтруктураРеквизитовФормы,
										 СтруктураМногоуровневыхРазделов,
										 ПараметрыВыгрузки,
										 УзелСоответствующийСтроке,
										 НомСтр);
					НомСтр = НомСтр + 1;
				КонецЦикла;
			Иначе
				ЗаполнитьДаннымиУзел(ИмяФормы,
									 СтруктураРеквизитовФормы,
									 СтруктураМногоуровневыхРазделов,
									 ПараметрыВыгрузки,
									 Стр,
									 НомерСтроки);
			КонецЕсли;
		Иначе
			Если ПустаяСтрока(Стр.ЗначениеПоУмолчанию) Тогда
				Если НЕ ПустаяСтрока(Стр.Ключ) Тогда
					ПолныйКодПоказателя = Стр.Ключ + ?(ЗначениеЗаполнено(НомерСтроки), "_" + Формат(НомерСтроки, "ЧГ="), "");
					ЗначениеПоказателя = Неопределено;
					Если ПараметрыВыгрузки.Свойство(ПолныйКодПоказателя, ЗначениеПоказателя) Тогда
						ВывестиПоказательВXML(ИмяФормы,Стр, ЗначениеПоказателя);
					Иначе
						ВывестиПоказательВXML(ИмяФормы, Стр, "");
					КонецЕсли;
				Иначе
					Стр.Значение = "";
				КонецЕсли;
			ИначеЕсли Лев(Стр.ЗначениеПоУмолчанию, 1) = "&" Тогда
				ВывестиПоказательВXML(ИмяФормы, Стр, ПараметрыВыгрузки[Сред(Стр.ЗначениеПоУмолчанию, 2)]);
			Иначе
				Стр.Значение = Стр.ЗначениеПоУмолчанию;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
КонецПроцедуры

Процедура ОтсечьНезаполненныеНеобязательныеУзлы(ИмяФормы, Узел, ПараметрыВыгрузки)
	
	КоличествоСтрок = Узел.Строки.Количество();
	Для Инд = 1 По КоличествоСтрок Цикл
		Стр = Узел.Строки.Получить(КоличествоСтрок - Инд);
		ОтсечьНезаполненныеНеобязательныеУзлы(ИмяФормы, Стр, ПараметрыВыгрузки);
	КонецЦикла;
	
	Если ТипЗнч(Узел) <> Тип("ДеревоЗначений") Тогда
		Если (СтрНайти(Узел.Обязательность, "Н") <> 0 ИЛИ СтрНайти(Узел.Обязательность, "H") <> 0)
			И УзелПуст(ИмяФормы, Узел, ПараметрыВыгрузки) Тогда // учтем оба варианта: кириллицу и латиницу
			РегламентированнаяОтчетность.УдалитьУзел(Узел);
		ИначеЕсли (СтрНайти(Узел.Обязательность, "М") <> 0
			ИЛИ СтрНайти(Узел.Обязательность, "M") <> 0) // учтем оба варианта: кириллицу и латиницу
			И УзелПуст(ИмяФормы, Узел, ПараметрыВыгрузки) И ?(СтрНайти(Узел.Обязательность, "О") <> 0
			ИЛИ СтрНайти(Узел.Обязательность, "O") <> 0,
			РегламентированнаяОтчетность.ИмеютсяАналогичныеСоседниеУзлыКлюч(Узел), Истина) Тогда
			РегламентированнаяОтчетность.УдалитьУзел(Узел);
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

Процедура ЗаполнитьСодержательнуюЧасть(ИмяФормы,
									   СтруктураРеквизитовФормы,
									   СтруктураМногоуровневыхРазделов,
									   УзелРодитель,
									   ПараметрыВыгрузки)
	
	СохрСтруктура = СохраненныеДанныеОтчета(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов);
	ДанныеМногоуровневыхРазделов = СохрСтруктура.ДанныеМногоуровневыхРазделов;
	СохрСтруктура = Неопределено;
	
	// Раздел 1.
	//
	СумНалПу = ПолучитьПодчиненныйЭлемент(ИмяФормы, УзелРодитель, "СумНалПу");
	ДеревоРаздела = ДанныеМногоуровневыхРазделов["Раздел1"];
	Ветка = ДеревоРаздела.Строки[0];
	
	СумНалПуИскл227 = ПолучитьПодчиненныйЭлемент(ИмяФормы, СумНалПу, "СумНалПуИскл227");
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыР1М1];
	Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
		ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
			СтрокаМнЧ.Данные, СкопироватьУзел(ИмяФормы, СумНалПу, СумНалПуИскл227));
	КонецЦикла;
	
	СумНалПу227 = ПолучитьПодчиненныйЭлемент(ИмяФормы, СумНалПу, "СумНалПу227");
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыР1М2];
	Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
		Данные = ОбщегоНазначения.СкопироватьРекурсивно(СтрокаМнЧ.Данные);
		Данные.Вставить("П10001М210003", Окр(СтрокаМнЧ.Данные["П00001М210003"]) - Окр(СтрокаМнЧ.Данные["П00001М211003"]));
		Данные.Вставить("П10001М213003", Окр(СтрокаМнЧ.Данные["П00001М213003"]) - Окр(СтрокаМнЧ.Данные["П00001М214003"]));
		Данные.Вставить("П10001М216003", Окр(СтрокаМнЧ.Данные["П00001М216003"]) - Окр(СтрокаМнЧ.Данные["П00001М217003"]));
		ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
			Данные, СкопироватьУзел(ИмяФормы, СумНалПу, СумНалПу227));
	КонецЦикла;
	
	// Приложение к Разделу 1.
	//
	ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
		ДанныеМногоуровневыхРазделов["Раздел1Приложение"].Строки[0].Данные,
		ПолучитьПодчиненныйЭлемент(ИмяФормы, УзелРодитель, "ЗаявРаспДС"));
	
	// Раздел 2.
	//
	НалБаза = ПолучитьПодчиненныйЭлемент(ИмяФормы, УзелРодитель, "НалБаза");
	ДеревоРаздела = ДанныеМногоуровневыхРазделов["Раздел2"];
	Для каждого Ветка Из ДеревоРаздела.Строки Цикл
		ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
			Ветка.Данные, СкопироватьУзел(ИмяФормы, УзелРодитель, НалБаза));
	КонецЦикла;
	
	// Приложение 1.
	//
	ДоходИстРФ = ПолучитьПодчиненныйЭлемент(ИмяФормы, УзелРодитель, "ДоходИстРФ");
	ДеревоРаздела = ДанныеМногоуровневыхРазделов["Приложение1"];
	Ветка = ДеревоРаздела.Строки[0];
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП1М1];
	Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
		
		ЭкзДоходИстРФ = СкопироватьУзел(ИмяФормы, УзелРодитель, ДоходИстРФ);
		ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
			СтрокаМнЧ.Данные, ЭкзДоходИстРФ);
		
		// Особая обработка.
		ВидДоход = СокрЛП(СтрокаМнЧ.Данные["П000П1М101003"]);
		Ставка = ПолучитьПодчиненныйЭлемент(ИмяФормы, ЭкзДоходИстРФ, "Ставка");
		Если ВидДоход = "025" ИЛИ ВидДоход = "046" Тогда
			Ставка.Обязательность = "О";
		Иначе
			РегламентированнаяОтчетность.УдалитьУзел(Ставка);
		КонецЕсли;
		
		// Особая обработка.
		КПП = СокрЛП(СтрокаМнЧ.Данные["П000П1М104003"]);
		Если ЗначениеЗаполнено(КПП) Тогда
			РегламентированнаяОтчетность.УдалитьУзел(ПолучитьПодчиненныйЭлемент(ИмяФормы, ЭкзДоходИстРФ, "ИстФЛИн"));
		Иначе
			РегламентированнаяОтчетность.УдалитьУзел(ПолучитьПодчиненныйЭлемент(ИмяФормы, ЭкзДоходИстРФ, "ИстЮЛ"));
		КонецЕсли;
		
	КонецЦикла;
	
	// Приложение 2.
	//
	ДоходИстИно = ПолучитьПодчиненныйЭлемент(ИмяФормы, УзелРодитель, "ДоходИстИно");
	РасчДохНалИно = ПолучитьПодчиненныйЭлемент(ИмяФормы, ДоходИстИно, "РасчДохНалИно");
	ДеревоРаздела = ДанныеМногоуровневыхРазделов["Приложение2"];
	Для каждого Ветка Из ДеревоРаздела.Строки Цикл
		
		ЭкзРасчДохНалИно = СкопироватьУзел(ИмяФормы, ДоходИстИно, РасчДохНалИно);
		ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
			Ветка.Данные, ЭкзРасчДохНалИно);
		
		// Особая обработка.
		ВидДоход = СокрЛП(Ветка.Данные["П000П20003103"]);
		Ставка = ПолучитьПодчиненныйЭлемент(ИмяФормы, ЭкзРасчДохНалИно, "Ставка");
		Если ВидДоход = "025" ИЛИ ВидДоход = "046" Тогда
			Ставка.Обязательность = "О";
		Иначе
			РегламентированнаяОтчетность.УдалитьУзел(Ставка);
		КонецЕсли;
		
	КонецЦикла;
	
	// Приложение 3.
	//
	ДоходПредпр = ПолучитьПодчиненныйЭлемент(ИмяФормы, УзелРодитель, "ДоходПредпр");
	ДеревоРаздела = ДанныеМногоуровневыхРазделов["Приложение3"];
	Ветка = ДеревоРаздела.Строки[0];
	
	ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
		Ветка.Данные, ДоходПредпр);
	
	РасчВидДеят = ПолучитьПодчиненныйЭлемент(ИмяФормы, ДоходПредпр, "РасчВидДеят");
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП3М1];
	Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
		ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
			СтрокаМнЧ.Данные, СкопироватьУзел(ИмяФормы, ДоходПредпр, РасчВидДеят));
	КонецЦикла;
	
	ПрофНалВыч = ПолучитьПодчиненныйЭлемент(ИмяФормы, УзелРодитель, "ПрофНалВыч");
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП3М2];
	Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
		ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
			СтрокаМнЧ.Данные, СкопироватьУзел(ИмяФормы, УзелРодитель, ПрофНалВыч));
	КонецЦикла;
	
	// Приложение 3 (продолжение).
	//
	РасчАвансПлат = ПолучитьПодчиненныйЭлемент(ИмяФормы, ДоходПредпр, "РасчАвансПлат");
	ДеревоРаздела = ДанныеМногоуровневыхРазделов["Приложение3Продолжение"];
	Ветка = ДеревоРаздела.Строки[0];
	ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
		Ветка.Данные, РасчАвансПлат);
	
	// Особая обработка.
	Если ЗаполненаСтраницаРаздела(
		ИмяФормы, Ветка, "Приложение3Продолжение", СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов) Тогда
		Если Окр(Ветка.Данные["П000П30016003"]) = 0 И Окр(Ветка.Данные["П000П30016103"]) = 0
			И Окр(Ветка.Данные["П000П30016203"]) = 0 Тогда
			СумПолДох = ПолучитьПодчиненныйЭлемент(ИмяФормы, РасчАвансПлат, "СумПолДох");
			За9м = ПолучитьПодчиненныйЭлемент(ИмяФормы, СумПолДох, "За9м");
			За9м.Обязательность = "О";
		КонецЕсли;
		Если Окр(Ветка.Данные["П000П30019003"]) = 0 И Окр(Ветка.Данные["П000П30019103"]) = 0
			И Окр(Ветка.Данные["П000П30019203"]) = 0 Тогда
			НалБазаИсч = ПолучитьПодчиненныйЭлемент(ИмяФормы, РасчАвансПлат, "НалБазаИсч");
			За9м = ПолучитьПодчиненныйЭлемент(ИмяФормы, НалБазаИсч, "За9м");
			За9м.Обязательность = "О";
		КонецЕсли;
		Если Окр(Ветка.Данные["П000П30020003"]) = 0 И Окр(Ветка.Данные["П000П30020103"]) = 0
			И Окр(Ветка.Данные["П000П30020203"]) = 0 Тогда
			СумИсчАванс = ПолучитьПодчиненныйЭлемент(ИмяФормы, РасчАвансПлат, "СумИсчАванс");
			За9м = ПолучитьПодчиненныйЭлемент(ИмяФормы, СумИсчАванс, "За9м");
			За9м.Обязательность = "О";
		КонецЕсли;
	КонецЕсли;
	
	// Приложение 4.
	//
	ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
		ДанныеМногоуровневыхРазделов["Приложение4"].Строки[0].Данные,
		ПолучитьПодчиненныйЭлемент(ИмяФормы, УзелРодитель, "ДоходОсвПрев"));
	
	// Приложение 5.
	//
	ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
		ДанныеМногоуровневыхРазделов["Приложение5"].Строки[0].Данные,
		ПолучитьПодчиненныйЭлемент(ИмяФормы, УзелРодитель, "ВычСтандСоц"));
	
	// Приложение 6.
	//
	ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
		ДанныеМногоуровневыхРазделов["Приложение6"].Строки[0].Данные,
		ПолучитьПодчиненныйЭлемент(ИмяФормы, УзелРодитель, "ИмущНалВычПр"));
	
	// Приложение 7.
	//
	ИмущНалВычНов = ПолучитьПодчиненныйЭлемент(ИмяФормы, УзелРодитель, "ИмущНалВычНов");
	ДеревоРаздела = ДанныеМногоуровневыхРазделов["Приложение7"];
	Ветка = ДеревоРаздела.Строки[0];
	
	ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
		Ветка.Данные, ИмущНалВычНов);
	
	РасчИмущВыч = ПолучитьПодчиненныйЭлемент(ИмяФормы, ИмущНалВычНов, "РасчИмущВыч");
	СвОбъектРасх = ПолучитьПодчиненныйЭлемент(ИмяФормы, РасчИмущВыч, "СвОбъектРасх");
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП7М1];
	Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
		ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
			СтрокаМнЧ.Данные, СкопироватьУзел(ИмяФормы, РасчИмущВыч, СвОбъектРасх));
	КонецЦикла;
	
	// Приложение 8.
	//
	ДохОперЦБ = ПолучитьПодчиненныйЭлемент(ИмяФормы, УзелРодитель, "ДохОперЦБ");
	ДеревоРаздела = ДанныеМногоуровневыхРазделов["Приложение8"];
	Для каждого Ветка Из ДеревоРаздела.Строки Цикл
		
		ЭкзДохОперЦБ = СкопироватьУзел(ИмяФормы, УзелРодитель, ДохОперЦБ);
		ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
			Ветка.Данные, ЭкзДохОперЦБ);
		
		УчетУбыт = ПолучитьПодчиненныйЭлемент(ИмяФормы, ЭкзДохОперЦБ, "УчетУбыт");
		ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП8М1];
		Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
			ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
				СтрокаМнЧ.Данные, СкопироватьУзел(ИмяФормы, ЭкзДохОперЦБ, УчетУбыт));
		КонецЦикла;
		
	КонецЦикла;
	
	// Расчет к Приложению 1.
	//
	ДохПродОНИ = ПолучитьПодчиненныйЭлемент(ИмяФормы, УзелРодитель, "ДохПродОНИ");
	ДеревоРаздела = ДанныеМногоуровневыхРазделов["Приложение1Расчет"];
	Ветка = ДеревоРаздела.Строки[0];
	
	ДохОНИ = ПолучитьПодчиненныйЭлемент(ИмяФормы, ДохПродОНИ, "ДохОНИ");
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП1РМ1];
	Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
		
		ЭкзДохОНИ = СкопироватьУзел(ИмяФормы, ДохПродОНИ, ДохОНИ);
		ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
			СтрокаМнЧ.Данные, ЭкзДохОНИ);
		
		// Особая обработка.
		ВидДох = СокрЛП(СтрокаМнЧ.Данные["П00П1РМ101003"]);
		КадСтоимГодРег = ПолучитьПодчиненныйЭлемент(ИмяФормы, ЭкзДохОНИ, "КадСтоимГодРег");
		КадСтоимКоэф   = ПолучитьПодчиненныйЭлемент(ИмяФормы, ЭкзДохОНИ, "КадСтоимКоэф");
		Если ВидДох = "1" Тогда
			КадСтоимГодРег.Обязательность = "О";
			КадСтоимКоэф.Обязательность   = "О";
		Иначе
			РегламентированнаяОтчетность.УдалитьУзел(КадСтоимГодРег);
			РегламентированнаяОтчетность.УдалитьУзел(КадСтоимКоэф);
		КонецЕсли;
		
	КонецЦикла;
	
	ДохТС = ПолучитьПодчиненныйЭлемент(ИмяФормы, ДохПродОНИ, "ДохТС");
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП1РМ2];
	Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
		ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
			СтрокаМнЧ.Данные, СкопироватьУзел(ИмяФормы, ДохПродОНИ, ДохТС));
	КонецЦикла;
	
	ДохУстДог = ПолучитьПодчиненныйЭлемент(ИмяФормы, ДохПродОНИ, "ДохУстДог");
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП1РМ3];
	Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
		ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
			СтрокаМнЧ.Данные, СкопироватьУзел(ИмяФормы, ДохПродОНИ, ДохУстДог));
	КонецЦикла;
	
	// Расчет к Приложению 5.
	//
	ВычСоцИнв219 = ПолучитьПодчиненныйЭлемент(ИмяФормы, УзелРодитель, "ВычСоцИнв219");
	ДеревоРаздела = ДанныеМногоуровневыхРазделов["Приложение5Расчет"];
	Ветка = ДеревоРаздела.Строки[0];
	
	ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
		Ветка.Данные, ВычСоцИнв219);
	
	РасчПенсВзнос = ПолучитьПодчиненныйЭлемент(ИмяФормы, ВычСоцИнв219, "РасчПенсВзнос");
	РасчПСВВыч = ПолучитьПодчиненныйЭлемент(ИмяФормы, РасчПенсВзнос, "РасчПСВВыч");
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП5РМ1];
	Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
		ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
			СтрокаМнЧ.Данные, СкопироватьУзел(ИмяФормы, РасчПенсВзнос, РасчПСВВыч));
	КонецЦикла;
	
	РасчСумИнвВыч = ПолучитьПодчиненныйЭлемент(ИмяФормы, ВычСоцИнв219, "РасчСумИнвВыч");
	ДанныеМнЧ = Ветка.ДанныеМногострочныхЧастей[СтруктураРеквизитовФормы.мИдГруппыП5РМ2];
	Для каждого СтрокаМнЧ Из ДанныеМнЧ.Строки Цикл
		ЗаполнитьДаннымиУзел(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов,
			СтрокаМнЧ.Данные, СкопироватьУзел(ИмяФормы, ВычСоцИнв219, РасчСумИнвВыч));
	КонецЦикла;
	
КонецПроцедуры

Функция ПолучитьПервыйПодчиненныйУзелСЗаполненнымКлючом(ИмяФормы, Родитель)
	
	Для Каждого Стр из Родитель.Строки Цикл
		Если ЗначениеЗаполнено(Стр.Ключ) Тогда
			Возврат Стр;
		КонецЕсли;
	КонецЦикла;
	Возврат Неопределено;
	
КонецФункции

Функция СкопироватьУзел(ИмяФормы, Родитель, Узел, Знач МаксИндекс = Неопределено)
	
	// Нахождение узла с максимальным индексом и с тем же кодом,
	// что и у копируемого, и добавление нового сразу после найденного.
	Если МаксИндекс = Неопределено Тогда
		СтрокиСТемЖеКодом = Родитель.Строки.НайтиСтроки(Новый Структура("Код", Узел.Код), Ложь);
		МаксИндекс = - 1;
		КолСтрокСТемЖеКодом = СтрокиСТемЖеКодом.Количество();
		Если КолСтрокСТемЖеКодом > 0 Тогда
			МаксИндекс = Родитель.Строки.Индекс(СтрокиСТемЖеКодом[КолСтрокСТемЖеКодом - 1]);
		КонецЕсли;
	КонецЕсли;
	
	ИндексСоздаваемогоУзла = МаксИндекс + 1;
	Если ИндексСоздаваемогоУзла >= Родитель.Строки.Количество() ИЛИ ИндексСоздаваемогоУзла = 0 Тогда
		// Аналогичный узел не найден или найденный узел - последний.
		НовыйУзел = Родитель.Строки.Добавить();
	Иначе
		НовыйУзел = Родитель.Строки.Вставить(ИндексСоздаваемогоУзла);
	КонецЕсли;
	
	ЗаполнитьЗначенияСвойств(НовыйУзел, Узел, , "Родитель, Строки");
	
	Для Каждого Стр из Узел.Строки Цикл
		СкопироватьУзел(ИмяФормы, НовыйУзел, Стр, Узел.Строки.Количество() - 1);
	КонецЦикла;
	
	Возврат НовыйУзел;
	
КонецФункции

Процедура ВывестиПоказательВXML(ИмяФормы, Узел, ЗначениеПоказателя)
	
	МинШирина = Узел.МинРазмерность;
	МаксШирина = Узел.МаксРазмерность;
	
	Если Узел.Формат = "T" ИЛИ Узел.Формат = "Т" Тогда // учтем оба варианта: кириллицу и латиницу
		Если ТипЗнч(ЗначениеПоказателя) = Тип("Дата") Тогда
			ЗначениеПоказателяСтр = Формат(ЗначениеПоказателя, "ДФ=dd.MM.yyyy");
		Иначе
			ЗначениеПоказателяСтр = СокрЛП(ЗначениеПоказателя);
		КонецЕсли;
		Узел.Значение = ?(МаксШирина < СтрДлина(ЗначениеПоказателяСтр),
		СокрЛП(Лев(ЗначениеПоказателяСтр, МаксШирина)), ЗначениеПоказателяСтр);
	ИначеЕсли Узел.Формат = "N" Тогда
		СтрокаФормата = "ЧРД=.;ЧН=0;ЧГ=;";
		Если Узел.МаксРазмерность <> 0 И Узел.МаксРазмерность <> 99999 Тогда
			СтрокаФормата = СтрокаФормата + "ЧЦ=" + Формат(Узел.МаксРазмерность, "ЧГ=") + ";";
		КонецЕсли;
		Если Узел.МинРазмерность <> 99999 Тогда
			СтрокаФормата = СтрокаФормата + "ЧДЦ=" + Формат(Узел.МинРазмерность, "ЧГ=") + ";";
		КонецЕсли;
		Узел.Значение = СокрЛП(Формат(ЗначениеПоказателя, СтрокаФормата));
	КонецЕсли;
	
КонецПроцедуры

Функция УзелПуст(ИмяФормы, Узел, ПараметрыВыгрузки)
	
	Для Каждого Стр из Узел.Строки Цикл
		Если НЕ УзелПуст(ИмяФормы, Стр, ПараметрыВыгрузки) Тогда
			Возврат Ложь;
		КонецЕсли;
	КонецЦикла;
	
	Если Узел.Формат = "S" Тогда
		Возврат Истина;
	ИначеЕсли Узел.Формат = "N" Тогда
		Возврат Узел.Значение = "0" ИЛИ (НЕ ЗначениеЗаполнено(Узел.Значение));
	Иначе
		Возврат НЕ ЗначениеЗаполнено(Узел.Значение);
	КонецЕсли;
	
КонецФункции

Функция ПолучитьПодчиненныйЭлемент(ИмяФормы, Узел, КодЭлемента)
	
	ЧислоВместоКодаЭлемента = (ТипЗнч(КодЭлемента) = Тип("Число"));
	Если ТипЗнч(КодЭлемента) = Тип("Число") Тогда
		Если Узел.Строки.Количество() > КодЭлемента Тогда
			Возврат Узел.Строки.Получить(КодЭлемента);
		Иначе
			Возврат Неопределено;
		КонецЕсли;
	Иначе
		Для Каждого Стр Из Узел.Строки Цикл
			Если Стр.Код = КодЭлемента Тогда
				Возврат Стр;
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	
КонецФункции

Функция ВыгрузитьДеревоВXML(ИмяФормы,
							ДеревоВыгрузки,
							ПараметрыВыгрузки,
							КодировкаФайлаВыгрузки,
							СтруктураРеквизитовФормы,
							СтруктураМногоуровневыхРазделов)
	
	ПотокXML = РегламентированнаяОтчетность.СоздатьНовыйПотокXML(КодировкаФайлаВыгрузки);
	ЗаписатьУзелДереваВXML(ИмяФормы, ДеревоВыгрузки, ПотокXML, ПараметрыВыгрузки,
	СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов);
	ТекстДляЗаписи = ПотокXML.Закрыть();
	
	Возврат ТекстДляЗаписи;
	
КонецФункции

Процедура ЗаписатьУзелДереваВXML(ИмяФормы,
								 СтрокаДерева,
								 ПотокXML,
								 ПараметрыВыгрузки,
								 СтруктураРеквизитовФормы,
								 СтруктураМногоуровневыхРазделов)
	
	Если ТипЗнч(СтрокаДерева) = Тип("ДеревоЗначений") Тогда
		ПотокXML.ЗаписатьНачалоЭлемента("Файл");
		ПотокXML.ЗаписатьАтрибут("xmlns:xsi", "http://www.w3.org/2001/XMLSchema-instance");
		Для каждого Стр Из СтрокаДерева.Строки Цикл
			ЗаписатьУзелДереваВXML(ИмяФормы, Стр, ПотокXML, ПараметрыВыгрузки,
			СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов);
		КонецЦикла;
		ПотокXML.ЗаписатьКонецЭлемента();
	Иначе
		Если СтрокаДерева.Тип = "А" ИЛИ СтрокаДерева.Тип = "A" Тогда
			ПотокXML.ЗаписатьАтрибут(СтрокаДерева.Код, Строка(СтрокаДерева.Значение));
		Иначе
			ПотокXML.ЗаписатьНачалоЭлемента(СтрокаДерева.Код);
			Для каждого Лист из СтрокаДерева.Строки Цикл
				ЗаписатьУзелДереваВXML(ИмяФормы, Лист, ПотокXML, ПараметрыВыгрузки,
				СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов);
			КонецЦикла;
			ПотокXML.ЗаписатьТекст(Строка(СтрокаДерева.Значение));
			ПотокXML.ЗаписатьКонецЭлемента();
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область ФормированиеПечатногоБланка

Функция ПечатныйБланк(ПараметрыПечати) Экспорт
	
	Перем СтруктураРеквизитовФормы;
	Перем СтруктураМногоуровневыхРазделов;
	Перем ДанныеРазделов;
	Перем ВидПечати;
	Перем ДеревоВыбранныхСтраниц;
	Перем ДанныеМногоуровневыхРазделов;
	
	ИмяФормы = ПараметрыПечати.ВыбраннаяФорма;
	
	ПечатныйБланкФормируетсяВФорматеPDF = Ложь;
	
	Если НЕ ПараметрыПечати.Свойство("СтруктураРеквизитовФормы", СтруктураРеквизитовФормы) Тогда
		СформироватьСтруктуруРеквизитовФормы(ИмяФормы, СтруктураРеквизитовФормы);
		ИнициализироватьМногострочныеЧасти(ИмяФормы, СтруктураРеквизитовФормы);
		ПараметрыПечати.Свойство("СохраненныйОтчет", СтруктураРеквизитовФормы.мСохраненныйДок);
	КонецЕсли;
	
	Если НЕ ПараметрыПечати.Свойство("СтруктураМногоуровневыхРазделов", СтруктураМногоуровневыхРазделов) Тогда
		ИнициализироватьМногоуровневыеРазделы(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов);
	КонецЕсли;
	
	Если НЕ ПараметрыПечати.Свойство("ДеревоВыбранныхСтраниц", ДеревоВыбранныхСтраниц) Тогда
		ДеревоВыбранныхСтраниц = ПараметрыПечати.СохраненныйОтчет.ДеревоНастройкиСтраниц.Получить();
		ПечатныйБланкФормируетсяВФорматеPDF = Истина;
	КонецЕсли;
	
	Если НЕ ПараметрыПечати.Свойство("ВидПечати", ВидПечати) Тогда
		ВидПечати = "";
	КонецЕсли;
	
	Если НЕ ПараметрыПечати.Свойство("ДанныеРазделов", ДанныеРазделов) Тогда
		
		ДанныеРазделов = Новый Структура;
		
		СохрСтруктура = СохраненныеДанныеОтчета(ИмяФормы, СтруктураРеквизитовФормы, СтруктураМногоуровневыхРазделов);
		
		ПоказателиОтчета = СохрСтруктура.ПоказателиОтчета;
		
		Для Каждого Раздел Из ПоказателиОтчета Цикл
			
			ДанныеРазделов.Вставить(СтрЗаменить(Раздел.Ключ, "ПолеТабличногоДокумента", ""),
				РегламентированнаяОтчетность.СвернутьДанныеТабличногоПоля(Раздел.Значение));
			
		КонецЦикла;
		
		Если СохрСтруктура.Свойство("ДанныеМногоуровневыхРазделов", ДанныеМногоуровневыхРазделов) Тогда
			
			Для Каждого ЭлементСтруктуры Из ДанныеМногоуровневыхРазделов Цикл
				
				РегламентированнаяОтчетность.ПоместитьВКэш(ЭлементСтруктуры.Значение, Новый УникальныйИдентификатор,
				СтруктураРеквизитовФормы["АдресВоВрХранилищеДеревоДанных" + ЭлементСтруктуры.Ключ]);
				
			КонецЦикла;
			
		КонецЕсли;
		
	КонецЕсли;
	
	ОбщиеРеквизитыРазделов = ПолучитьОбщиеРеквизитыСТитульногоЛиста(
	ИмяФормы, СтруктураРеквизитовФормы, ДанныеРазделов.Титульный);
	
	Для Каждого СтраницаОтчета Из ДеревоВыбранныхСтраниц.Строки Цикл
		
		Если СтраницаОтчета.ВыводНаПечать = 0 Тогда
			
			Продолжить;
			
		КонецЕсли;
		
		СтруктураПараметров = Новый Структура;
		СтруктураПараметров.Вставить("НаименованиеЛиста",  СтраницаОтчета.Представление);
		СтруктураПараметров.Вставить("ОриентацияЛиста",    СтраницаОтчета.ОриентацияСтраницы);
		СтруктураПараметров.Вставить("ИмяСтраницы",        СтраницаОтчета.ИмяСтраницы);
		Структурапараметров.Вставить("ИмяОбластиТаблПоля", СтраницаОтчета.ИмяОбластиТабличногоПоля);
		Структурапараметров.Вставить("ВидПечати",          ВидПечати);
		СтруктураПараметров.Вставить("СтруктураМногоуровневыхРазделов", СтруктураМногоуровневыхРазделов);
		
		Если СтруктураМногоуровневыхРазделов.Свойство(СтраницаОтчета.ИмяСтраницы) Тогда
			
			ВывестиНаПечатьДанныеМногоуровневогоРаздела(ИмяФормы,
			СтруктураПараметров,
			ОбщиеРеквизитыРазделов,
			СтруктураРеквизитовФормы,
			ДанныеРазделов);
			
		Иначе
			
			ВывестиНаПечатьЛист(ИмяФормы,
			СтруктураПараметров,
			ОбщиеРеквизитыРазделов,
			СтруктураРеквизитовФормы,
			ДанныеРазделов);
			
		КонецЕсли;
		
	КонецЦикла;
	
	РегламентированнаяОтчетностьКлиентСервер.ПроставлениеНомеровЛистов(
	СтруктураРеквизитовФормы, , СтруктураРеквизитовФормы.СписокПечатаемыхЛистов);
	
	Если НЕ ПечатныйБланкФормируетсяВФорматеPDF Тогда
		Возврат "";
	КонецЕсли;
	
	ПакетОтображаемыхДокументов = Новый ПакетОтображаемыхДокументов;
	
	Для Каждого Лист Из СтруктураРеквизитовФормы.СписокПечатаемыхЛистов Цикл
		
		ПакетОтображаемыхДокументов.Состав.Добавить(Лист.Значение[0]);
		
	КонецЦикла;
	
	ИмяВременногоФайла = ПолучитьИмяВременногоФайла("pdf");
	
	ПакетОтображаемыхДокументов.ЗаписатьФайлДляПечати(ИмяВременногоФайла);
	
	ФайлПечатногоБланка = Новый ДвоичныеДанные(ИмяВременногоФайла);
	
	АдресВоВременномХранилище = ПоместитьВоВременноеХранилище(ФайлПечатногоБланка, Новый УникальныйИдентификатор);
	
	УдалитьФайлы(ИмяВременногоФайла);
	
	ПредставлениеПериода = РегламентированнаяОтчетностьКлиентСервер.ПредставлениеПериодаРасширенное(
		НачалоДня(СтруктураРеквизитовФормы.мСохраненныйДок.ДатаНачала),
		КонецДня(СтруктураРеквизитовФормы.мСохраненныйДок.ДатаОкончания),
		Новый Структура("ФорматнаяСтрока", "ФП = Истина"));
	
	ИмяФайлаПечатногоБланка = СтруктураРеквизитовФормы.НаименованиеОтчета + НСтр("ru = ' за ';
																				|en = ' за '")
		+ ПредставлениеПериода + " (" + СтруктураРеквизитовФормы.мСохраненныйДок.Организация + ").pdf";
	
	ПечатныйБланк = Новый Структура;
	ПечатныйБланк.Вставить("АдресПечатногоБланка", АдресВоВременномХранилище);
	ПечатныйБланк.Вставить("ИмяФайлаПечатногоБланка",
		ОбщегоНазначенияКлиентСервер.ЗаменитьНедопустимыеСимволыВИмениФайла(ИмяФайлаПечатногоБланка));
	
	Возврат ПечатныйБланк;
	
КонецФункции

Функция ПолучитьОбщиеРеквизитыСТитульногоЛиста(ИмяФормы, СтруктураРеквизитовФормы, СтруктураДанныхТитульный)
	
	МассивИНН         = Новый Массив(12);
	МассивДатаПодписи = Новый Массив(8);
	
	СтрИНН = "";
	
	Если СтруктураДанныхТитульный.Свойство("ИНН", СтрИНН) Тогда
		
		Если СтрДлина(СтрИНН) = 10 Тогда
			
			СтрИНН = СтрИНН + "--";
			
		КонецЕсли;
		
		Для Ном = 1 По СтрДлина(СтрИНН) Цикл
			
			МассивИНН[Ном - 1] = Сред(СтрИНН, Ном, 1);
			
		КонецЦикла;
		
	КонецЕсли;
	
	ДатаПодписи = "";
	
	Если СтруктураДанныхТитульный.Свойство("ДатаПодписи", ДатаПодписи) Тогда	
		
		Если ТипЗнч(ДатаПодписи) = Тип("Строка") Тогда 
			
			СтрДатаПодписи = Лев(СтрЗаменить(ДатаПодписи, ".", ""), 8);
			
		ИначеЕсли ТипЗнч(ДатаПодписи) = Тип("Дата") Тогда 
			
			Если ЗначениеЗаполнено(ДатаПодписи) Тогда 
				
				СтрДатаПодписи = Лев(СтрЗаменить(Формат(ДатаПодписи, "ДФ = ""дд.ММ.гггг 'г.'"""), ".", ""), 8);
				
			Иначе
				
				СтрДатаПодписи = "        ";
				
			КонецЕсли;
			
		КонецЕсли;
		
		Для Ном = 1 По СтрДлина(СтрДатаПодписи) Цикл
			
			МассивДатаПодписи[Ном - 1] = Сред(СтрДатаПодписи, Ном, 1);
			
		КонецЦикла;
		
	КонецЕсли;
	
	ОбщиеРеквизитыРазделов = Новый Структура;
	ОбщиеРеквизитыРазделов.Вставить("ИНН", МассивИНН);
	ОбщиеРеквизитыРазделов.Вставить("ДатаПодписи", МассивДатаПодписи);
	
	Фамилия = "";
	Имя = "";
	Отчество = "";
	
	Если СтруктураДанныхТитульный.Свойство("Фамилия", Фамилия)
		И СтруктураДанныхТитульный.Свойство("Имя", Имя)
		И СтруктураДанныхТитульный.Свойство("Отчество", Отчество) Тогда
		
		ОбщиеРеквизитыРазделов.Вставить("ФизлицоФамилия",         Фамилия);
		ОбщиеРеквизитыРазделов.Вставить("ФизлицоИмяИнициал",      Лев(Имя, 1));
		ОбщиеРеквизитыРазделов.Вставить("ФизлицоОтчествоИнициал", Лев(Отчество, 1));
		
	Иначе
		
		ОбщиеРеквизитыРазделов.Вставить("ФизлицоФамилия",         "-");
		ОбщиеРеквизитыРазделов.Вставить("ФизлицоИмяИнициал",      "-");
		ОбщиеРеквизитыРазделов.Вставить("ФизлицоОтчествоИнициал", "-");
		
	КонецЕсли;
	
	
	Возврат ОбщиеРеквизитыРазделов;
	
КонецФункции

Процедура ВывестиНаПечатьЛист(ИмяФормы,
							  СтруктураПараметров,
							  ОбщиеРеквизитыРазделов,
							  СтруктураРеквизитовФормы,
							  ДанныеРазделов,
							  ТабличныйДокумент = Неопределено)
	
	ПрефиксИменМакетов = "ПечатныйБланк" + Прав(СокрЛП(ИмяФормы), 7) + "_";
	
	ИмяМЧБ = ПрефиксИменМакетов + СтруктураПараметров.ИмяСтраницы;
	
	МакетПечатнойФормы = ЭтотОбъект.ПолучитьМакет(ИмяМЧБ);
	МакетПечатнойФормы.ПолеСверху = 5;
	МакетПечатнойФормы.ПолеСправа = 5;
	МакетПечатнойФормы.ПолеСнизу  = 5;
	МакетПечатнойФормы.ПолеСлева  = 5;
		
	ЗаполнитьПечатнуюФорму(ИмяФормы,
						   СтруктураПараметров,
						   МакетПечатнойФормы,
						   ОбщиеРеквизитыРазделов,
						   ДанныеРазделов,
						   ТабличныйДокумент);
	
	ТабличныйДокумент = Новый ТабличныйДокумент;
	ТабличныйДокумент.Вывести(МакетПечатнойФормы);
	СтрПоля = "ПолеСверху, ПолеСправа, ПолеСнизу, ПолеСлева";
	ЗаполнитьЗначенияСвойств(ТабличныйДокумент, МакетПечатнойФормы, СтрПоля, "Макет");
	
	РегламентированнаяОтчетность.ВывестиНаПечатьЛистОбщая("",
														  СтруктураПараметров,
														  ТабличныйДокумент,
														  СтруктураРеквизитовФормы.мПечатныеФормы);
	
КонецПроцедуры

Процедура ВывестиНаПечатьДанныеМногоуровневогоРаздела(ИмяФормы,
													  СтруктураПараметров,
													  ОбщиеРеквизитыРазделов,
													  СтруктураРеквизитовФормы,
													  ДанныеРазделов)
	
	ИмяТекРаздела = СтруктураПараметров.ИмяСтраницы;
	
	ДеревоДанныхРаздела = ПолучитьИзВременногоХранилища(
		СтруктураРеквизитовФормы["АдресВоВрХранилищеДеревоДанных" + ИмяТекРаздела]);
	
	ТабличныйДокумент = Новый ТабличныйДокумент;
	
	Если ИмяТекРаздела = "Раздел1" ИЛИ ИмяТекРаздела = "Приложение1" ИЛИ ИмяТекРаздела = "Приложение3"
		ИЛИ ИмяТекРаздела = "Приложение7" ИЛИ ИмяТекРаздела = "Приложение8" ИЛИ ИмяТекРаздела = "Приложение1Расчет"
		ИЛИ ИмяТекРаздела = "Приложение5Расчет" Тогда
		
		МакетРаздела = ЭтотОбъект.ПолучитьМакет(Сред(ИмяФормы, СтрНайти(ИмяФормы, "ФормаОтчета")) + "_" + ИмяТекРаздела);
		
		ИмяГруппыМнЧ1 = "";
		ИмяГруппыМнЧ2 = "";
		ИмяГруппыМнЧ3 = "";
		
		Если ИмяТекРаздела = "Раздел1" Тогда
			
			ИмяГруппыМнЧ1 = СтруктураРеквизитовФормы.мИдГруппыР1М1;
			ИмяГруппыМнЧ2 = СтруктураРеквизитовФормы.мИдГруппыР1М2;
			
			СтрокМнЧ1НаЛисте = 2;
			СтрокМнЧ2НаЛисте = 1;
			
		ИначеЕсли ИмяТекРаздела = "Приложение1" Тогда
			
			ИмяГруппыМнЧ1 = СтруктураРеквизитовФормы.мИдГруппыП1М1;
			
			СтрокМнЧ1НаЛисте = 3;
			
		ИначеЕсли ИмяТекРаздела = "Приложение3" Тогда
			
			ИмяГруппыМнЧ1 = СтруктураРеквизитовФормы.мИдГруппыП3М1;
			ИмяГруппыМнЧ2 = СтруктураРеквизитовФормы.мИдГруппыП3М2;
			
			СтрокМнЧ1НаЛисте = 1;
			СтрокМнЧ2НаЛисте = 1;
			
		ИначеЕсли ИмяТекРаздела = "Приложение7" Тогда
			
			ИмяГруппыМнЧ1 = СтруктураРеквизитовФормы.мИдГруппыП7М1;
			
			СтрокМнЧ1НаЛисте = 1;
			
		ИначеЕсли ИмяТекРаздела = "Приложение8" Тогда
			
			ИмяГруппыМнЧ1 = СтруктураРеквизитовФормы.мИдГруппыП8М1;
			
			СтрокМнЧ1НаЛисте = 3;
			
		ИначеЕсли ИмяТекРаздела = "Приложение1Расчет" Тогда
			
			ИмяГруппыМнЧ1 = СтруктураРеквизитовФормы.мИдГруппыП1РМ1;
			ИмяГруппыМнЧ2 = СтруктураРеквизитовФормы.мИдГруппыП1РМ2;
			ИмяГруппыМнЧ3 = СтруктураРеквизитовФормы.мИдГруппыП1РМ3;
			
			СтрокМнЧ1НаЛисте = 1;
			СтрокМнЧ2НаЛисте = 1;
			СтрокМнЧ3НаЛисте = 1;
			
		Иначе// "Приложение5Расчет"
			
			ИмяГруппыМнЧ1 = СтруктураРеквизитовФормы.мИдГруппыП5РМ1;
			ИмяГруппыМнЧ2 = СтруктураРеквизитовФормы.мИдГруппыП5РМ2;
			
			СтрокМнЧ1НаЛисте = 1;
			СтрокМнЧ2НаЛисте = 1;
			
		КонецЕсли;
		
		ИменаГрафМнЧ1 = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппыМнЧ1]["ИменаГраф"];
		Если ЗначениеЗаполнено(ИмяГруппыМнЧ2) Тогда
			ИменаГрафМнЧ2 = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппыМнЧ2]["ИменаГраф"];
		КонецЕсли;
		Если ЗначениеЗаполнено(ИмяГруппыМнЧ3) Тогда
			ИменаГрафМнЧ3 = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппыМнЧ3]["ИменаГраф"];
		КонецЕсли;
		
		Для каждого Ветка Из ДеревоДанныхРаздела.Строки Цикл
			
			// Определение количества листов.
			//
			ДанныеМнЧ1 = Ветка.ДанныеМногострочныхЧастей[ИмяГруппыМнЧ1];
			КолСтрокМнЧ = ДанныеМнЧ1.Строки.Количество();
			ДробКол = КолСтрокМнЧ / СтрокМнЧ1НаЛисте;
			ЦелКол = Цел(КолСтрокМнЧ / СтрокМнЧ1НаЛисте);
			КолЛистовМнЧ1 = ?(ДробКол = ЦелКол, ЦелКол, ЦелКол + 1);
			
			КолЛистовМнЧ2 = 0;
			Если ЗначениеЗаполнено(ИмяГруппыМнЧ2) Тогда
				ДанныеМнЧ2 = Ветка.ДанныеМногострочныхЧастей[ИмяГруппыМнЧ2];
				КолСтрокМнЧ = ДанныеМнЧ2.Строки.Количество();
				ДробКол = КолСтрокМнЧ / СтрокМнЧ2НаЛисте;
				ЦелКол = Цел(КолСтрокМнЧ / СтрокМнЧ2НаЛисте);
				КолЛистовМнЧ2 = ?(ДробКол = ЦелКол, ЦелКол, ЦелКол + 1);
			КонецЕсли;
			
			КолЛистовМнЧ3 = 0;
			Если ЗначениеЗаполнено(ИмяГруппыМнЧ3) Тогда
				ДанныеМнЧ3 = Ветка.ДанныеМногострочныхЧастей[ИмяГруппыМнЧ3];
				КолСтрокМнЧ = ДанныеМнЧ3.Строки.Количество();
				ДробКол = КолСтрокМнЧ / СтрокМнЧ3НаЛисте;
				ЦелКол = Цел(КолСтрокМнЧ / СтрокМнЧ3НаЛисте);
				КолЛистовМнЧ3 = ?(ДробКол = ЦелКол, ЦелКол, ЦелКол + 1);
			КонецЕсли;
			
			КолЛистовРаздела = Макс(КолЛистовМнЧ1, КолЛистовМнЧ2, КолЛистовМнЧ3);
			
			// Подготовка многострочных данных для заполнения листов.
			//
			МассивДанныхМнЧ1ДляПечати = Новый Массив;
			Если ЗначениеЗаполнено(ИмяГруппыМнЧ2) Тогда
				МассивДанныхМнЧ2ДляПечати = Новый Массив;
			КонецЕсли;
			Если ЗначениеЗаполнено(ИмяГруппыМнЧ3) Тогда
				МассивДанныхМнЧ3ДляПечати = Новый Массив;
			КонецЕсли;
			
			Для НомЛиста = 1 По КолЛистовРаздела Цикл
				
				ПриращениеКНомеру = (НомЛиста - 1) * СтрокМнЧ1НаЛисте;
				ДанныеМнЧДляПечати = Новый Структура;
				Для ИндСтроки = 1 По СтрокМнЧ1НаЛисте Цикл
					_ИндСтроки = РегламентированнаяОтчетностьКлиентСервер.СтрокаСИндексомПоказателя(ИндСтроки);
					ИндСПриращением = ИндСтроки + ПриращениеКНомеру;
					Если ИндСПриращением > ДанныеМнЧ1.Строки.Количество() Тогда
						Прервать;
					КонецЕсли;
					Для каждого ИмяГрафы Из ИменаГрафМнЧ1 Цикл
						ДанныеМнЧДляПечати.Вставить(ИмяГрафы + _ИндСтроки, ДанныеМнЧ1.Строки[ИндСПриращением - 1].Данные[ИмяГрафы]);
					КонецЦикла;
				КонецЦикла;
				МассивДанныхМнЧ1ДляПечати.Добавить(ДанныеМнЧДляПечати);
				
				Если ЗначениеЗаполнено(ИмяГруппыМнЧ2) Тогда
					ПриращениеКНомеру = (НомЛиста - 1) * СтрокМнЧ2НаЛисте;
					ДанныеМнЧДляПечати = Новый Структура;
					Для ИндСтроки = 1 По СтрокМнЧ2НаЛисте Цикл
						_ИндСтроки = РегламентированнаяОтчетностьКлиентСервер.СтрокаСИндексомПоказателя(ИндСтроки);
						ИндСПриращением = ИндСтроки + ПриращениеКНомеру;
						Если ИндСПриращением > ДанныеМнЧ2.Строки.Количество() Тогда
							Прервать;
						КонецЕсли;
						Для каждого ИмяГрафы Из ИменаГрафМнЧ2 Цикл
							ДанныеМнЧДляПечати.Вставить(ИмяГрафы + _ИндСтроки, ДанныеМнЧ2.Строки[ИндСПриращением - 1].Данные[ИмяГрафы]);
						КонецЦикла;
					КонецЦикла;
					МассивДанныхМнЧ2ДляПечати.Добавить(ДанныеМнЧДляПечати);
				КонецЕсли;
				
				Если ЗначениеЗаполнено(ИмяГруппыМнЧ3) Тогда
					ПриращениеКНомеру = (НомЛиста - 1) * СтрокМнЧ3НаЛисте;
					ДанныеМнЧДляПечати = Новый Структура;
					Для ИндСтроки = 1 По СтрокМнЧ3НаЛисте Цикл
						_ИндСтроки = РегламентированнаяОтчетностьКлиентСервер.СтрокаСИндексомПоказателя(ИндСтроки);
						ИндСПриращением = ИндСтроки + ПриращениеКНомеру;
						Если ИндСПриращением > ДанныеМнЧ3.Строки.Количество() Тогда
							Прервать;
						КонецЕсли;
						Для каждого ИмяГрафы Из ИменаГрафМнЧ3 Цикл
							ДанныеМнЧДляПечати.Вставить(ИмяГрафы + _ИндСтроки, ДанныеМнЧ3.Строки[ИндСПриращением - 1].Данные[ИмяГрафы]);
						КонецЦикла;
					КонецЦикла;
					МассивДанныхМнЧ3ДляПечати.Добавить(ДанныеМнЧДляПечати);
				КонецЕсли;
				
			КонецЦикла;
			
			// Вывод листов.
			//
			Для НомЛиста = 1 По КолЛистовРаздела Цикл
				
				ТабличныйДокумент.Очистить();
				ТабличныйДокумент.Вывести(МакетРаздела);
				
				Если НомЛиста = КолЛистовРаздела Тогда
					НемногострочныеДанные = Ветка.Данные;
					Для каждого Пок Из НемногострочныеДанные Цикл
						Обл = ТабличныйДокумент.Области.Найти(Пок.Ключ);
						Если Обл <> Неопределено Тогда
							Обл.Значение = Пок.Значение;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
				
				Для Ном = 1 По СтрокМнЧ1НаЛисте - 1 Цикл
					ИмяОбластиПреемника
						= "ДобавлениеСтроки" + ИмяГруппыМнЧ1 + РегламентированнаяОтчетностьКлиентСервер.СтрокаСИндексомПоказателя(Ном);
					ВставитьДопСтроку(ИмяФормы, СтруктураРеквизитовФормы, ТабличныйДокумент, ИмяГруппыМнЧ1, ИмяОбластиПреемника);
				КонецЦикла;
				Если ЗначениеЗаполнено(ИмяГруппыМнЧ2) Тогда
					Для Ном = 1 По СтрокМнЧ2НаЛисте - 1 Цикл
						ИмяОбластиПреемника
							= "ДобавлениеСтроки" + ИмяГруппыМнЧ2 + РегламентированнаяОтчетностьКлиентСервер.СтрокаСИндексомПоказателя(Ном);
						ВставитьДопСтроку(ИмяФормы, СтруктураРеквизитовФормы, ТабличныйДокумент, ИмяГруппыМнЧ2, ИмяОбластиПреемника);
					КонецЦикла;
				КонецЕсли;
				Если ЗначениеЗаполнено(ИмяГруппыМнЧ3) Тогда
					Для Ном = 1 По СтрокМнЧ3НаЛисте - 1 Цикл
						ИмяОбластиПреемника
							= "ДобавлениеСтроки" + ИмяГруппыМнЧ3 + РегламентированнаяОтчетностьКлиентСервер.СтрокаСИндексомПоказателя(Ном);
						ВставитьДопСтроку(ИмяФормы, СтруктураРеквизитовФормы, ТабличныйДокумент, ИмяГруппыМнЧ3, ИмяОбластиПреемника);
					КонецЦикла;
				КонецЕсли;
				
				ДанныеМнЧДляПечати = МассивДанныхМнЧ1ДляПечати[НомЛиста - 1];
				Для каждого Пок Из ДанныеМнЧДляПечати Цикл
					Обл = ТабличныйДокумент.Области.Найти(Пок.Ключ);
					Если Обл <> Неопределено Тогда
						Обл.Значение = Пок.Значение;
					КонецЕсли;
				КонецЦикла;
				Если ЗначениеЗаполнено(ИмяГруппыМнЧ2) Тогда
					ДанныеМнЧДляПечати = МассивДанныхМнЧ2ДляПечати[НомЛиста - 1];
					Для каждого Пок Из ДанныеМнЧДляПечати Цикл
						Обл = ТабличныйДокумент.Области.Найти(Пок.Ключ);
						Если Обл <> Неопределено Тогда
							Обл.Значение = Пок.Значение;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
				Если ЗначениеЗаполнено(ИмяГруппыМнЧ3) Тогда
					ДанныеМнЧДляПечати = МассивДанныхМнЧ3ДляПечати[НомЛиста - 1];
					Для каждого Пок Из ДанныеМнЧДляПечати Цикл
						Обл = ТабличныйДокумент.Области.Найти(Пок.Ключ);
						Если Обл <> Неопределено Тогда
							Обл.Значение = Пок.Значение;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
				
				СтруктураПараметровРаздела = ОбщегоНазначения.СкопироватьРекурсивно(СтруктураПараметров);
				СтруктураПараметровРаздела.Вставить("ИмяСтраницы", ИмяТекРаздела);
				ВывестиНаПечатьЛист(ИмяФормы, СтруктураПараметровРаздела, ОбщиеРеквизитыРазделов,
					СтруктураРеквизитовФормы, ДанныеРазделов, ТабличныйДокумент);
				
			КонецЦикла;
			
		КонецЦикла;
		
	ИначеЕсли ИмяТекРаздела = "Раздел2" ИЛИ ИмяТекРаздела = "Раздел1Приложение"
		ИЛИ ИмяТекРаздела = "Приложение2" ИЛИ ИмяТекРаздела = "Приложение3Продолжение"
		ИЛИ ИмяТекРаздела = "Приложение4" ИЛИ ИмяТекРаздела = "Приложение5"
		ИЛИ ИмяТекРаздела = "Приложение6" Тогда
		
		МакетРаздела = ЭтотОбъект.ПолучитьМакет(Сред(ИмяФормы, СтрНайти(ИмяФормы, "ФормаОтчета")) + "_" + ИмяТекРаздела);
		
		Для каждого Ветка Из ДеревоДанныхРаздела.Строки Цикл
			
			ТабличныйДокумент.Очистить();
			ТабличныйДокумент.Вывести(МакетРаздела);
			
			Для каждого Пок Из Ветка.Данные Цикл
				Обл = ТабличныйДокумент.Области.Найти(Пок.Ключ);
				Если Обл <> Неопределено Тогда
					Обл.Значение = Пок.Значение;
				КонецЕсли;
			КонецЦикла;
			
			СтруктураПараметровРаздела = ОбщегоНазначения.СкопироватьРекурсивно(СтруктураПараметров);
			ВывестиНаПечатьЛист(ИмяФормы, СтруктураПараметровРаздела, ОбщиеРеквизитыРазделов,
			СтруктураРеквизитовФормы, ДанныеРазделов, ТабличныйДокумент);
			
			Если ИмяТекРаздела = "Приложение5" Тогда
				
				ТабличныйДокумент.Очистить();
				ТабличныйДокумент.Вывести(МакетРаздела);
				
				Для каждого Пок Из Ветка.Данные Цикл
					Обл = ТабличныйДокумент.Области.Найти(Пок.Ключ);
					Если Обл <> Неопределено Тогда
						Обл.Значение = Пок.Значение;
					КонецЕсли;
				КонецЦикла;
				
				СтруктураПараметровРаздела = ОбщегоНазначения.СкопироватьРекурсивно(СтруктураПараметров);
				СтруктураПараметровРаздела.Вставить("ИмяСтраницы", "Приложение5Продолжение");
				ВывестиНаПечатьЛист(ИмяФормы, СтруктураПараметровРаздела, ОбщиеРеквизитыРазделов,
					СтруктураРеквизитовФормы, ДанныеРазделов, ТабличныйДокумент);
				
			КонецЕсли;
			
		КонецЦикла;
		
	КонецЕсли;
	
	ДеревоДанныхРаздела = Неопределено;
	
КонецПроцедуры

Процедура ЗаполнитьПечатнуюФорму(ИмяФормы,
								 ПараметрыПечати,
								 МакетПечатнойФормы,
								 ОбщиеРеквизитыРазделов,
								 ДанныеРазделов,
								 ТабличныйДокумент)
	
	Показатели = Новый ТаблицаЗначений;
	Показатели.Колонки.Добавить("Имя");
	Показатели.Колонки.Добавить("Значение");
	Показатели.Колонки.Добавить("ЗначениеМЧБ");
	
	Показатели.Индексы.Добавить("Имя");
	
	Если ПараметрыПечати.ИмяСтраницы = "Титульный" Тогда
		
		МакетФормыОтчета = ЭтотОбъект.ПолучитьМакет(ИмяФормы + "_" + ПараметрыПечати.ИмяСтраницы);
		
		Для Каждого Показатель Из ДанныеРазделов[ПараметрыПечати.ИмяСтраницы] Цикл
			
			НовСтр = Показатели.Добавить();
			НовСтр.Имя = Показатель.Ключ;
			НовСтр.Значение = Показатель.Значение;
			НовСтр.ЗначениеМЧБ = ПолучитьЗначениеМЧБ(ИмяФормы, Показатель, МакетФормыОтчета);
			
		КонецЦикла;
		
	Иначе
		
		Для Каждого Область Из ТабличныйДокумент.Области Цикл
			Если Область.ТипОбласти = ТипОбластиЯчеекТабличногоДокумента.Прямоугольник
				И Область.СодержитЗначение = Истина Тогда
				
				НовСтр = Показатели.Добавить();
				НовСтр.Имя = Область.Имя;
				НовСтр.Значение = Область.Значение;
				НовСтр.ЗначениеМЧБ = ПолучитьЗначениеМЧБ(ИмяФормы, Область, ТабличныйДокумент);
				
			КонецЕсли;
		КонецЦикла;
		
	КонецЕсли;
	
	НайденноеЗначение = Показатели.Найти("ИНН", "Имя");
	Если НЕ НайденноеЗначение = Неопределено Тогда
		Показатели.Удалить(НайденноеЗначение);
	КонецЕсли;
	ИНН = "";
	Для Ном = 0 По 11 Цикл
		ИНН = ИНН + ОбщиеРеквизитыРазделов.ИНН[Ном];
	КонецЦикла;
	НовСтр = Показатели.Добавить();
	НовСтр.Имя = "ИНН";
	НовСтр.Значение = ИНН;
	НовСтр.ЗначениеМЧБ = СокрЛП(ИНН);
	
	НайденноеЗначение = Показатели.Найти("ДатаПодписи", "Имя");
	Если НЕ НайденноеЗначение = Неопределено Тогда
		Показатели.Удалить(НайденноеЗначение);
	КонецЕсли;
	ДатаПодписиСтр = "";
	Для Ном = 0 По 7 Цикл
		ДатаПодписиСтр = ДатаПодписиСтр + ОбщиеРеквизитыРазделов.ДатаПодписи[Ном];
	КонецЦикла;
	НовСтр = Показатели.Добавить();
	НовСтр.Имя = "ДатаПодписи";
	НовСтр.Значение = ДатаПодписиСтр;
	НовСтр.ЗначениеМЧБ = СокрЛП(ДатаПодписиСтр);
	
	НовСтр = Показатели.Добавить();
	НовСтр.Имя = "ДатаПодписиПолная";
	Если СокрЛП(ДатаПодписиСтр) <> "" Тогда
		НовСтр.Значение = Формат(Дата(Прав(ДатаПодписиСтр, 4)
									+ Сред(ДатаПодписиСтр, 3, 2)
									+ Лев(ДатаПодписиСтр, 2) + "000000"), "ДФ = ""дд.ММ.гггг""");
		НовСтр.ЗначениеМЧБ = СокрЛП(Формат(Дата(Прав(ДатаПодписиСтр, 4)
											  + Сред(ДатаПодписиСтр, 3, 2)
											  + Лев(ДатаПодписиСтр, 2) + "000000"), "ДФ = ""дд.ММ.гггг"""));
	КонецЕсли;
	
	НовСтр = Показатели.Добавить();
	НовСтр.Имя = "ФизлицоФамилия";
	НовСтр.Значение = ОбщиеРеквизитыРазделов.ФизлицоФамилия;
	НовСтр.ЗначениеМЧБ = ОбщиеРеквизитыРазделов.ФизлицоФамилия;
	НовСтр = Показатели.Добавить();
	НовСтр.Имя = "ФизлицоИмяИнициал";
	НовСтр.Значение = ОбщиеРеквизитыРазделов.ФизлицоИмяИнициал;
	НовСтр.ЗначениеМЧБ = ОбщиеРеквизитыРазделов.ФизлицоИмяИнициал;
	НовСтр = Показатели.Добавить();
	НовСтр.Имя = "ФизлицоОтчествоИнициал";
	НовСтр.Значение = ОбщиеРеквизитыРазделов.ФизлицоОтчествоИнициал;
	НовСтр.ЗначениеМЧБ = ОбщиеРеквизитыРазделов.ФизлицоОтчествоИнициал;
	НовСтр = Показатели.Добавить();
	
	ИНН = Новый Массив(12);
	Для Инд = 1 По 9 Цикл
		Для Знакоместо = 0 По 11 Цикл
			ИНН[Знакоместо] = Показатели.Найти("ИНН" + Инд + "_" + (Знакоместо + 1), "Имя");
		КонецЦикла;
		Если ИНН[0] = Неопределено ИЛИ ИНН[1] = Неопределено Тогда
			Продолжить;
		КонецЕсли;
	КонецЦикла;
	
	Для Каждого Показатель Из Показатели Цикл
		
		Если СтрНачинаетсяС(Показатель.Имя, "П00001М103003")
			ИЛИ СтрНачинаетсяС(Показатель.Имя, "П00001М207003")
			ИЛИ СтрНачинаетсяС(Показатель.Имя, "П00001М209003")
			ИЛИ СтрНачинаетсяС(Показатель.Имя, "П00001М212003")
			ИЛИ СтрНачинаетсяС(Показатель.Имя, "П00001М215003")
			ИЛИ СтрНачинаетсяС(Показатель.Имя, "П000П1М105003") Тогда
			Показатель.ЗначениеМЧБ = РегламентированнаяОтчетностьКлиентСервер.ДополнитьСтроку(
				СокрЛП(Показатель.Значение), 11, "-", 1);
		КонецЕсли;
		
	КонецЦикла;
	
	ИндексТочкиПоКорню = Новый Структура;
	Для Каждого Область Из МакетПечатнойФормы.Области Цикл
		Если Область.Текст = "." Тогда
			ТекАдресЗначенияОбласти = АдресЗначенияОбласти(ИмяФормы, Область);
			Корень = ТекАдресЗначенияОбласти.Корень;
			ИндексТочкиЧислаНаМЧБ = ТекАдресЗначенияОбласти.ИндексЗнакоместа;
			ИндексТочкиПоКорню.Вставить(Корень,ИндексТочкиЧислаНаМЧБ);
		КонецЕсли;
	КонецЦикла;
	
	Для Каждого Область Из МакетПечатнойФормы.Области Цикл
		Если Область.ТипОбласти = ТипОбластиЯчеекТабличногоДокумента.Прямоугольник Тогда
			ИмяОбласти = Область.Имя;
			
			Если СтрЧислоВхождений(ИмяОбласти, "НомСтр") > 0
			 ИЛИ СтрЧислоВхождений(ИмяОбласти, "СоставленаНа") > 0 Тогда
				Продолжить;
			КонецЕсли;
			
			РезультатПоиска = Показатели.Найти(ИмяОбласти, "Имя");
			Если РезультатПоиска = Неопределено Тогда
				ТекАдресЗначенияОбласти = АдресЗначенияОбласти(ИмяФормы, Область);
				ЗначениеВыведено = Ложь;
				Если ТекАдресЗначенияОбласти.ИндексЗнакоместа <> 0 Тогда
					РезультатПоиска = Показатели.Найти(ТекАдресЗначенияОбласти.Корень, "Имя");
					Если РезультатПоиска <> Неопределено Тогда
						Если ТипЗнч(РезультатПоиска.Значение)=Тип("Число") Тогда
							// Разделение числа на 2 части.
							ЦелаяЧасть = Цел(РезультатПоиска.Значение);
							Если РезультатПоиска.Значение = 0 И РезультатПоиска.ЗначениеМЧБ <> "" Тогда
								СтрЦелаяЧасть = "0";
							Иначе
								СтрЦелаяЧасть = СтрЗаменить(Строка(Формат(Цел(РезультатПоиска.Значение), "ЧРГ=';'")), ";", "");
							КонецЕсли;
							Если РезультатПоиска.Значение < 0 И СтрНайти(РезультатПоиска.ЗначениеМЧБ, ".") > 0 Тогда
								СтрДробнаяЧасть = Сред(Строка(РезультатПоиска.Значение - ЦелаяЧасть),4);
							Иначе
								СтрДробнаяЧасть = Сред(Строка(РезультатПоиска.Значение - ЦелаяЧасть),3);
							КонецЕсли;
							Если СтрЦелаяЧасть <> "" ИЛИ СтрДробнаяЧасть <> "" Тогда
								СтрЦелаяЧасть = ?(СтрЦелаяЧасть = "", "0", СтрЦелаяЧасть);
								Если РезультатПоиска.Значение < 0 Тогда
									СтрЦелаяЧасть = ?(СтрЦелаяЧасть = "0", "-0", СтрЦелаяЧасть);
								КонецЕсли;
								СтрДробнаяЧасть = ?(СтрДробнаяЧасть = "", "0", СтрДробнаяЧасть);
							КонецЕсли;
							// Разделение областей показателя на 2 части.
							ИндексТочкиЧислаНаМЧБ = Неопределено;
							Если ИндексТочкиПоКорню.Свойство(ТекАдресЗначенияОбласти.Корень,ИндексТочкиЧислаНаМЧБ) = Ложь Тогда
								// На МЧБ нет разделения на целую и дробную части.
								КолЗнакомест = 0;
								Если ПараметрыПечати.ИмяСтраницы = "Раздел1"
									ИЛИ ПараметрыПечати.ИмяСтраницы = "Раздел2" Тогда
									КолЗнакомест = 13;
								ИначеЕсли ПараметрыПечати.ИмяСтраницы = "Приложение1" Тогда
									Если СтрНачинаетсяС(ИмяОбласти, "П000П1М102003") Тогда
										КолЗнакомест = 2;
									Иначе
										КолЗнакомест = 13;
									КонецЕсли;
								ИначеЕсли ПараметрыПечати.ИмяСтраницы = "Приложение2" Тогда
									Если СтрНачинаетсяС(ИмяОбласти, "П000П20004103") Тогда
										КолЗнакомест = 2;
									Иначе
										КолЗнакомест = 12;
									КонецЕсли;
								ИначеЕсли ПараметрыПечати.ИмяСтраницы = "Приложение3"
									ИЛИ ПараметрыПечати.ИмяСтраницы = "Приложение3Продолжение" Тогда
									КолЗнакомест = 12;
								КонецЕсли;
								Если КолЗнакомест > 0 Тогда
									
									// Особая обработка: выравнивание целого числа по правому краю.
									СтрЦелоеЧисло = ?(РезультатПоиска.ЗначениеМЧБ = "",
										РезультатПоиска.ЗначениеМЧБ, СтроковыеФункцииКлиентСервер.ДополнитьСтроку(
										РезультатПоиска.ЗначениеМЧБ, КолЗнакомест, " "));
									
								Иначе
									СтрЦелоеЧисло = РезультатПоиска.ЗначениеМЧБ;
								КонецЕсли;
								ПрисвоитьЗначениеОбласти(ИмяФормы, Область, СтрЦелоеЧисло,
														 ТекАдресЗначенияОбласти.ИндексЗнакоместа);
								ЗначениеВыведено = Истина;
							Иначе
								// Определяем какая часть выводится (Целая, дробная или точка).
								Если ТекАдресЗначенияОбласти.ИндексЗнакоместа < ИндексТочкиЧислаНаМЧБ Тогда
									// Выводится целая часть.
									
									// Особая обработка: выравнивание целой части по правому краю.
									СтрЦелаяЧасть = ?(СтрЦелаяЧасть = "",
										СтрЦелаяЧасть, СтроковыеФункцииКлиентСервер.ДополнитьСтроку(СтрЦелаяЧасть, ИндексТочкиЧислаНаМЧБ - 1, " "));
									
									ПрисвоитьЗначениеОбласти(ИмяФормы, Область,
										?(РезультатПоиска.ЗначениеМЧБ = "-", "-", СтрЦелаяЧасть),
										ТекАдресЗначенияОбласти.ИндексЗнакоместа);
									ЗначениеВыведено = Истина;
								ИначеЕсли ТекАдресЗначенияОбласти.ИндексЗнакоместа > ИндексТочкиЧислаНаМЧБ Тогда
									// Выводится дробная часть.
									ПрисвоитьЗначениеОбластиДробнойЧастиПриРазделенииНаМЧБНаЦелуюИДробнуюЧасть(
										ИмяФормы, Область, СтрДробнаяЧасть,
										ТекАдресЗначенияОбласти.ИндексЗнакоместа - ИндексТочкиЧислаНаМЧБ);
									ЗначениеВыведено = Истина;
								Иначе
									// Выводится точка.
									// Присваивать ничего не будем, но считаем, что область заполненяется корректно.
									ЗначениеВыведено = Истина;
								КонецЕсли;
							КонецЕсли;
						Иначе
							ПрисвоитьЗначениеОбласти(ИмяФормы, Область, РезультатПоиска.ЗначениеМЧБ,
													 ТекАдресЗначенияОбласти.ИндексЗнакоместа,
													 ТипЗнч(РезультатПоиска.Значение) <> Тип("Строка")
													 ИЛИ НЕ ЗначениеЗаполнено(РезультатПоиска.Значение));
							ЗначениеВыведено = Истина;
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
				
				Если НЕ ЗначениеВыведено
					  И ИмяОбласти <> "ОпределениеВысотыСтрокиМногострочнойЧасти" Тогда // Служебное поле.
					
					Сообщение = Новый СообщениеПользователю;
					Сообщение.Текст = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
						НСтр("ru = 'Не удалось заполнить область ""%1""';
							|en = 'Не удалось заполнить область ""%1""'"), ИмяОбласти);
					Сообщение.Сообщить();
					
				КонецЕсли;
			Иначе
				ПрисвоитьЗначениеОбласти(ИмяФормы, Область, РезультатПоиска.ЗначениеМЧБ);
			КонецЕсли;
			
		КонецЕсли;
		
	КонецЦикла;
	
КонецПроцедуры

Функция ПолучитьЗначениеМЧБ(ИмяФормы, Показатель, МакетФормыОтчета)
	
	ФорматОбласти = "";
	
	Область = МакетФормыОтчета.Области.Найти(?(ТипЗнч(Показатель) = Тип("КлючИЗначение"), 
		Показатель.Ключ, Показатель.Имя));
	
	Если НЕ Область = Неопределено Тогда
		
		ФорматОбласти = Область.Формат;
		
	КонецЕсли;
	
	ТипЗначения = ТипЗнч(Показатель.Значение);
	
	Если ТипЗначения = Тип("Число") Тогда
		
		СоотвСтрокаФормата = РазобратьСтрокуФормата(ИмяФормы, ФорматОбласти);
		
		СоотвСтрокаФормата.Вставить("ЧРД", ".");
		СоотвСтрокаФормата.Вставить("ЧГ", "");
		
		Если Показатель.Значение = 0 И ТипЗнч(Показатель) = Тип("ОбластьЯчеекТабличногоДокумента")
			И НЕ (СтрНачинаетсяС(Показатель.Имя, "П000П1М102003") ИЛИ Показатель.Имя = "П000П20004103") Тогда
			КвалификаторыЧисла = Показатель.ТипЗначения.КвалификаторыЧисла;
			РазрядностьДробнойЧасти = КвалификаторыЧисла.РазрядностьДробнойЧасти;
			Если РазрядностьДробнойЧасти > 0 Тогда
				СоотвСтрокаФормата.Вставить("ЧН",
					СтроковыеФункцииКлиентСервер.ДополнитьСтроку("0.", РазрядностьДробнойЧасти + 2, "0", "Справа"));
			Иначе
				СоотвСтрокаФормата.Вставить("ЧН", "0");
			КонецЕсли;
		КонецЕсли;
		
		Результат = Формат(Показатель.Значение, СобратьСтрокуФормата(ИмяФормы, СоотвСтрокаФормата));
		
	ИначеЕсли ТипЗначения = Тип("Строка") Тогда
		
		Результат = СокрЛП(Показатель.Значение);
		
	ИначеЕсли ТипЗначения = Тип("Дата") Тогда
		
		Результат = Формат(Показатель.Значение, ?(ПустаяСтрока(ФорматОбласти), "ДФ=ddMMyyyy", ФорматОбласти));
		
	ИначеЕсли ТипЗначения = Тип("Булево") Тогда
		
		Результат = Формат(Показатель.Значение, ФорматОбласти);
		
	КонецЕсли;
	
	Возврат СокрЛП(Результат);
	
КонецФункции

Функция АдресЗначенияОбласти(ИмяФормы, Область)
	
	Имя = Область.Имя;
	КореньИмениОбласти = Неопределено;
	СтрИндексЗнакоместа = "";
	ИндексЗнакоместа = 0;
	ДлинаИмени = СтрДлина(Имя);
	
	Для ИндексВхождения = 1 По ДлинаИмени Цикл
		СтрИндексЗнакоместа = Сред(Имя, ДлинаИмени - ИндексВхождения + 1);
		Если СтроковыеФункцииКлиентСервер.ТолькоЦифрыВСтроке(СтрИндексЗнакоместа) Тогда
			КореньИмениОбласти = Лев(Имя, ДлинаИмени - ИндексВхождения);
			ИндексЗнакоместа = Число(СтрИндексЗнакоместа);
		Иначе
			Прервать;
		КонецЕсли;
	КонецЦикла;
	
	Если Прав(КореньИмениОбласти, 1) = "_" Тогда
		КореньИмениОбласти = Лев(КореньИмениОбласти, СтрДлина(КореньИмениОбласти) - 1);
	КонецЕсли;
		
	Возврат Новый Структура("Корень, ИндексЗнакоместа", КореньИмениОбласти, ИндексЗнакоместа);
	
КонецФункции

Процедура ПрисвоитьЗначениеОбласти(ИмяФормы, Область, Знач Значение, ИндексЗнакоместа = 0, ДополнятьСправа_ = Истина)
	
	Если ИндексЗнакоместа <> 0 Тогда
		Если СтрДлина(Значение) >= ИндексЗнакоместа Тогда
			Значение = Сред(Значение, ИндексЗнакоместа, 1);
		Иначе
			Значение = ?(ДополнятьСправа_, "-", "");
		КонецЕсли;
	ИначеЕсли НЕ ЗначениеЗаполнено(Значение) Тогда
		Значение = "-";
	КонецЕсли;
	
	Если Область.СодержитЗначение = Истина Тогда
		Область.Значение = Значение;
		//Область.Значение = ВРЕГ(Значение);
	Иначе
		Область.Текст = Значение;
		//Область.Текст = ВРЕГ(Значение);
	КонецЕсли;
	
КонецПроцедуры

Функция РазобратьСтрокуФормата(ИмяФормы, Знач СтрокаФормата)
	
	ЗначенияПараметров = Новый Соответствие;
	
	Пока СтрНайти(СтрокаФормата, ";") <> 0 Цикл
		
		ВхождениеРазделителя = СтрНайти(СтрокаФормата, ";");
		
		ДоРазделителя = Лев(СтрокаФормата, ВхождениеРазделителя - 1);
		
		ВхождениеРавно = СтрНайти(ДоРазделителя, "=");
		
		Если ВхождениеРавно <> 0 И ВхождениеРавно <> 1 Тогда
			
			ЗначенияПараметров.Вставить(Лев(ДоРазделителя, ВхождениеРавно - 1), Сред(ДоРазделителя, ВхождениеРавно + 1));
			
		КонецЕсли;
		
		СтрокаФормата = Сред(СтрокаФормата, ВхождениеРазделителя + 1);
		
	КонецЦикла;
	
	ВхождениеРавно = СтрНайти(СтрокаФормата, "=");
	
	Если ВхождениеРавно <> 0 И ВхождениеРавно <> 1 Тогда
		
		ЗначенияПараметров.Вставить(Лев(СтрокаФормата, ВхождениеРавно - 1), Сред(СтрокаФормата, ВхождениеРавно + 1));
		
	КонецЕсли;
	
	Возврат ЗначенияПараметров;
	
КонецФункции

Функция СобратьСтрокуФормата(ИмяФормы, ПараметрыФормата)
	
	СтрокаФормата = "";
	
	Для Каждого Параметр Из ПараметрыФормата Цикл
		
		СтрокаФормата = СтрокаФормата + "; " + Параметр.Ключ + "=" + Параметр.Значение;
		
	КонецЦикла;
	
	Если НЕ ПустаяСтрока(СтрокаФормата) Тогда
		
		СтрокаФормата = Сред(СтрокаФормата, 3);
		
	КонецЕсли;
	
	Возврат СтрокаФормата;
	
КонецФункции

Процедура ПрисвоитьЗначениеОбластиДробнойЧастиПриРазделенииНаМЧБНаЦелуюИДробнуюЧасть(ИмяФормы,
																					 Область,
																					 Знач ДробнаяЧасть,
																					 ИндексЗнакоместа = 0)
	
	Если ИндексЗнакоместа <> 0 Тогда
		Если СтрДлина(ДробнаяЧасть) >= ИндексЗнакоместа Тогда
			ДробнаяЧасть = Сред(ДробнаяЧасть, ИндексЗнакоместа, 1);
		Иначе
			ДробнаяЧасть = ?(ЗначениеЗаполнено(ДробнаяЧасть), "0", "-");
		КонецЕсли;
	ИначеЕсли НЕ ЗначениеЗаполнено(ДробнаяЧасть) Тогда
		ДробнаяЧасть = "-";
	КонецЕсли;
	
	Если Область.СодержитЗначение = Истина Тогда
		Область.Значение = ДробнаяЧасть;
		//Область.Значение = ВРЕГ(ДробнаяЧасть);
	Иначе
		Область.Текст = ДробнаяЧасть;
		//Область.Текст = ВРЕГ(ДробнаяЧасть);
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

Процедура ВставитьДопСтроку(ИмяФормы,
							СтруктураРеквизитовФормы,
							ТабличныйДокумент,
							Знач ИмяГруппы,
							Знач ИмяОбластиПреемника,
							ЭтоАвтоВставкаПодчиненнойМнЧ = Ложь) Экспорт
	
	НачИндекс = "_1";
	
	Если СтрНайти(ИмяОбластиПреемника, "ДобавлениеСтроки" + ИмяГруппы) > 0 Тогда
		
		ИскомаяОбласть = ТабличныйДокумент.Области.Найти("МногострочнаяЧасть" + ИмяГруппы);
		
		ВремТаблДок = ТабличныйДокумент.ПолучитьОбласть(ИскомаяОбласть.Имя);
		ВставляемаяОбласть = ВремТаблДок.Область(ИскомаяОбласть.Имя);
		ВставляемаяОбласть.Имя = "";
		
		НовКоординаты = РегламентированнаяОтчетностьКлиентСервер.СтрокаСКоординатамиПоказателя(ИмяОбластиПреемника);
		
		КолУровнейПодчиненности = СтрЧислоВхождений(НовКоординаты, "_");
		НачКоординаты = "";
		Для НомУр = 1 По КолУровнейПодчиненности Цикл
			НачКоординаты = НачКоординаты + НачИндекс;
		КонецЦикла;
		
		ПреИндекс_Число = РегламентированнаяОтчетностьКлиентСервер.ИндексПоказателя(ИмяОбластиПреемника);
		НовИндекс_Число = ?(ЭтоАвтоВставкаПодчиненнойМнЧ, 1, ПреИндекс_Число + 1);
		
		ПреИндекс = РегламентированнаяОтчетностьКлиентСервер.СтрокаСИндексомПоказателя(ПреИндекс_Число);
		НовИндекс = РегламентированнаяОтчетностьКлиентСервер.СтрокаСИндексомПоказателя(НовИндекс_Число);
		
		НачПостфикс = ИмяГруппы + НачКоординаты + НачИндекс;
		ПреПостфикс = ИмяГруппы + НовКоординаты + ПреИндекс;
		НовПостфикс = ИмяГруппы + НовКоординаты + НовИндекс;
		
		МассивИменГраф = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппы]["ИменаГраф"];
		
		Для каждого ИмяГрафы Из МассивИменГраф Цикл
			
			НачИмяОбл = ИмяГрафы + НачКоординаты + НачИндекс;
			НовИмяОбл = ИмяГрафы + НовКоординаты + НовИндекс;
			
			ОбластьЯчейки = ВремТаблДок.Области[НачИмяОбл];
			ОбластьЯчейки.Имя = НовИмяОбл;
			
			Если ОбластьЯчейки.СодержитЗначение = Истина Тогда
				ОбластьЯчейки.Очистить();
			КонецЕсли;
			
		КонецЦикла;
		
		Обл = ВремТаблДок.Области.Найти("УдалитьСтроку" + НачПостфикс);
		Если Обл <> Неопределено Тогда
			Обл.Имя = "УдалитьСтроку" + НовПостфикс;
		КонецЕсли;
		
		Если ЭтоАвтоВставкаПодчиненнойМнЧ Тогда
			Обл = ВремТаблДок.Области.Найти("УдалитьСтроку" + НовПостфикс);
			Если Обл <> Неопределено Тогда
				Обл.Гиперссылка = Ложь;
				Обл.Текст = "";
			КонецЕсли;
		Иначе
			Обл = ВремТаблДок.Области.Найти("УдалитьСтроку" + НовПостфикс);
			Если Обл <> Неопределено Тогда
				Обл.Гиперссылка = Истина;
				Обл.Текст = "х";
				Если НовИндекс_Число = 2 Тогда
					Если Обл <> Неопределено Тогда
						Обл = ТабличныйДокумент.Области.Найти("УдалитьСтроку" + ПреПостфикс);
						Обл.Гиперссылка = Истина;
						Обл.Текст = "х";
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		Обл = ТабличныйДокумент.Области.Найти("ДобавитьСтроку" + ПреПостфикс);
		Если Обл <> Неопределено Тогда
			Обл.Имя = "ДобавитьСтроку" + НовПостфикс;
		КонецЕсли;
		Обл = ТабличныйДокумент.Области.Найти("ДобавитьСтрокуЗначок" + ПреПостфикс);
		Если Обл <> Неопределено Тогда
			Обл.Имя = "ДобавитьСтрокуЗначок" + НовПостфикс;
		КонецЕсли;
		
		ОблПреемник = ТабличныйДокумент.Области.Найти(ИмяОбластиПреемника);
		ОблПреемник.Имя = "ДобавлениеСтроки" + НовПостфикс;
		
		// Изменения в оформлении ячеек: установка значения "НетЛинии"/"Сплошная" для
		// свойства "ГраницаСнизу" (в случае задания номеров специальных колонок):
		НомераСпецКолонок = Неопределено;
		СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[ИмяГруппы].Свойство(
			"КолонкиСИзмНижнГраницей", НомераСпецКолонок);
		Если НомераСпецКолонок <> Неопределено Тогда
			Для каждого НомКолонки Из НомераСпецКолонок Цикл
				// Удаление линии в определенных колонках последней (до добавления) строки.
				Если НЕ ЭтоАвтоВставкаПодчиненнойМнЧ Тогда
					Обл = ТабличныйДокумент.Область(
						ОблПреемник.Верх - 1, НомКолонки, ОблПреемник.Верх - 1, НомКолонки);
					Если Обл <> Неопределено Тогда
						Обл.ГраницаСнизу = Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.НетЛинии);
					КонецЕсли;
				КонецЕсли;
				// Установка линии в определенных колонках добавляемой строки.
				Обл = ВремТаблДок.Область(
					ВставляемаяОбласть.Низ, НомКолонки, ВставляемаяОбласть.Низ, НомКолонки);
				Если Обл <> Неопределено Тогда
					Обл.ГраницаСнизу = Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная);
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		
		ОблПреемник_ = ТабличныйДокумент.Область(
			ОблПреемник.Верх, , ОблПреемник.Верх + ИскомаяОбласть.Низ - ИскомаяОбласть.Верх, );
		ТабличныйДокумент.ВставитьОбласть(
			ВставляемаяОбласть, ОблПреемник_, ТипСмещенияТабличногоДокумента.ПоВертикали);
		
		Если НЕ ЭтоАвтоВставкаПодчиненнойМнЧ Тогда
			// Установка текущей области после добавления строки.
			НовИмяТекОбл = МассивИменГраф[0] + НовКоординаты + НовИндекс;
			НовТекОбл = ТабличныйДокумент.Области[НовИмяТекОбл];
			ТабличныйДокумент.ТекущаяОбласть = НовТекОбл;
		КонецЕсли;
		
	КонецЕсли;
	
	ИменаПодчиненныхГрупп = СтруктураРеквизитовФормы.СтруктураМногострочныхЧастей[
		ИмяГруппы]["ИменаПодчиненныхГрупп"];
	Для каждого ИмяПодчГруппы Из ИменаПодчиненныхГрупп Цикл
		НовКоординатыДляПодчОбласти = НовКоординаты + НовИндекс;
		
		КолУровнейПодчиненности = СтрЧислоВхождений(НовКоординатыДляПодчОбласти, "_");
		НачКоординатыДляПодчОбласти = "";
		Для НомУр = 1 По КолУровнейПодчиненности Цикл
			НачКоординатыДляПодчОбласти = НачКоординатыДляПодчОбласти + НачИндекс;
		КонецЦикла;
		
		НачИндВставляемойОбласти = НачИндекс;
		
		ИскомаяОбласть = ТабличныйДокумент.Области.Найти(
			"ДобавлениеСтроки" + ИмяПодчГруппы + НачКоординатыДляПодчОбласти + НачИндВставляемойОбласти);
		
		Если ИскомаяОбласть = Неопределено Тогда
			НачИндВставляемойОбласти = 1;
			Пока ТабличныйДокумент.Области.Найти("ДобавлениеСтроки" + ИмяПодчГруппы
				+ НачКоординатыДляПодчОбласти + "_" + Формат(НачИндВставляемойОбласти, "ЧГ=")) = Неопределено Цикл
				НачИндВставляемойОбласти = НачИндВставляемойОбласти + 1;
			КонецЦикла;
			НачИндВставляемойОбласти = "_" + Формат(НачИндВставляемойОбласти, "ЧГ=");
			ИскомаяОбласть = ТабличныйДокумент.Области.Найти(
				"ДобавлениеСтроки" + ИмяПодчГруппы + НачКоординатыДляПодчОбласти + НачИндВставляемойОбласти);
		КонецЕсли;
		
		ВремТабличныйДокумент = ТабличныйДокумент.ПолучитьОбласть(ИскомаяОбласть.Имя);
		ВставляемаяОбласть = ВремТабличныйДокумент.Область(ИскомаяОбласть.Имя);
		Для каждого ОбластьЯчейки Из ВремТабличныйДокумент.Области Цикл
			ОбластьЯчейки.Имя = СтрЗаменить(ОбластьЯчейки.Имя,
				ИмяПодчГруппы + НачКоординатыДляПодчОбласти + НачИндВставляемойОбласти,
				ИмяПодчГруппы + НовКоординатыДляПодчОбласти + НачИндекс);
		КонецЦикла;
		ИмяОбластиПреемникаДляПодчОбласти = СтрЗаменить(ИмяОбластиПреемника, ПреПостфикс, НовПостфикс);
		ОбластьПреемник = ТабличныйДокумент.Области.Найти(ИмяОбластиПреемникаДляПодчОбласти);
		
		ТабличныйДокумент.ВставитьОбласть(ВставляемаяОбласть, ОбластьПреемник, ТипСмещенияТабличногоДокумента.ПоВертикали);
		
		ИмяОбластиПреемникаДляПодчОбласти = "ДобавлениеСтроки" + ИмяПодчГруппы + НовКоординатыДляПодчОбласти + НачИндекс;
		
		ВставитьДопСтроку(ИмяФормы,
						  СтруктураРеквизитовФормы,
						  ТабличныйДокумент,
						  ИмяПодчГруппы,
						  ИмяОбластиПреемникаДляПодчОбласти,
						  Истина);
	КонецЦикла;
	
КонецПроцедуры

Функция НастройкиАвтозаполненияОтчета(ПараметрыОтчета)
	
	Возврат ОбщегоНазначенияКлиентСервер.СвойствоСтруктуры(ПараметрыОтчета, "НастройкиАвтозаполнения", Неопределено);
	
КонецФункции

#КонецОбласти

#КонецЕсли