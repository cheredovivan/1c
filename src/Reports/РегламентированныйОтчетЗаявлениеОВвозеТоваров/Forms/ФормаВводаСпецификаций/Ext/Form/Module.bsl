
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	// Пропускаем инициализацию, чтобы гарантировать получение формы при передаче параметра "АвтоТест".
	Если Параметры.Свойство("АвтоТест") Тогда
		Возврат;
	КонецЕсли;
	
	Если ОбщегоНазначения.ПодсистемаСуществует("РегламентированнаяОтчетность.Интерфейс85") Тогда
		МодульРегламентированнаяОтчетностьИнтерфейс85 = ОбщегоНазначения.ОбщийМодуль("РегламентированнаяОтчетностьИнтерфейс85");
		МодульРегламентированнаяОтчетностьИнтерфейс85.УстановитьНазначениеДействияКоманды(Команды.ОК);
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ОК(Команда)
	
	КолвоЭлементов = ТЗСпецификаций.Количество();
	
	Для ОбратныйИндекс = 1 По КолвоЭлементов Цикл
		
		Элемент = ТЗСпецификаций[КолвоЭлементов - ОбратныйИндекс];
		
		Если НЕ ЗначениеЗаполнено(Элемент.Дата) И НЕ ЗначениеЗаполнено(Элемент.Номер) Тогда
	    	ТЗСпецификаций.Удалить(Элемент);
		КонецЕсли;
				
	КонецЦикла;	
		
	Закрыть(ТЗСпецификаций); 	
	
КонецПроцедуры

#КонецОбласти