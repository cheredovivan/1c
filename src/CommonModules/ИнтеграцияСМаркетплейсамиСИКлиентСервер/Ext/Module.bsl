// @strict-types

#Область СлужебныйПрограммныйИнтерфейс

#Область Словарь

// Внутренняя ошибка сервиса.
// 
// Возвращаемое значение:
//  Строка - Внутренняя ошибка сервиса
Функция ВнутренняяОшибкаСервиса() Экспорт
	Возврат НСтр("ru = 'Внутренняя ошибка сервиса.';
				|en = 'Internal service error.'");
КонецФункции

// Пользователь модели сервиса.
// 
// Возвращаемое значение:
//  Строка - Пользователь модели сервиса
Функция ПользовательМоделиСервиса() Экспорт
	Возврат "fresh";
КонецФункции

// Имя сервиса.
// 
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
// 
// Возвращаемое значение:
//  Строка - Имя сервиса
Функция ИмяСервиса(ВидМаркетплейса = Неопределено) Экспорт
	
	Результат = "";
	
	Если ВидМаркетплейса = Неопределено
		Или ВидМаркетплейса = ПредопределенноеЗначение("Перечисление.ВидыМаркетплейсов.ПустаяСсылка") Тогда
		Результат = ИмяСервисаСервисИнтеграции();
	ИначеЕсли ИнтеграцияСМаркетплейсамиКлиентСервер.ЭтоWildberries(ВидМаркетплейса) Тогда
		Результат = ИмяСервисаWildberries();
	ИначеЕсли ИнтеграцияСМаркетплейсамиКлиентСервер.ЭтоOzon(ВидМаркетплейса) Тогда
		Результат = ИмяСервисаOzon();
	ИначеЕсли ИнтеграцияСМаркетплейсамиКлиентСервер.ЭтоЯндексМаркет(ВидМаркетплейса) Тогда
		Результат = ИмяСервисаЯндексМаркет();
	ИначеЕсли ИнтеграцияСМаркетплейсамиКлиентСервер.ЭтоLamoda(ВидМаркетплейса) Тогда
		Результат = ИмяСервисаLamoda();
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции

// Имя сервиса сервис интеграции.
// 
// Возвращаемое значение:
//  Строка - Имя сервиса сервис интеграции
Функция ИмяСервисаСервисИнтеграции() Экспорт
	Возврат "Маркетплейсы.СервисИнтеграции";
КонецФункции

// Имя сервиса Wildberries.
// 
// Возвращаемое значение:
//  Строка - Имя сервиса wildberries
Функция ИмяСервисаWildberries() Экспорт
	Возврат "Маркетплейсы.Wildberries";
КонецФункции

// Имя сервиса Ozon.
// 
// Возвращаемое значение:
//  Строка - Имя сервиса ozon
Функция ИмяСервисаOzon() Экспорт
	Возврат "Маркетплейсы.Ozon";
КонецФункции

// Имя сервиса Яндекс маркет.
// 
// Возвращаемое значение:
//  Строка - Имя сервиса яндекс маркет
Функция ИмяСервисаЯндексМаркет() Экспорт
	Возврат "Маркетплейсы.ЯндексМаркет";
КонецФункции

// Имя сервиса Lamoda.
// 
// Возвращаемое значение:
//  Строка - Имя сервиса wildberries
Функция ИмяСервисаLamoda() Экспорт
	Возврат "Маркетплейсы.Lamoda";
КонецФункции

// Метод менеджер длительных операций.
// 
// Возвращаемое значение:
//  Строка - Метод менеджер длительных операций
Функция МетодМенеджерДлительныхОпераций() Экспорт
	Возврат "МенеджерДлительныхОпераций";
КонецФункции

// Метод обновить токен доступа.
// 
// Возвращаемое значение:
//  Строка - Метод обновить токен доступа
Функция МетодОбновитьТокенДоступа() Экспорт
	Возврат "ОбновитьТокенДоступа";
КонецФункции

// Установить соединение с сервисом интеграции.
// 
// Возвращаемое значение:
//  Строка - Установить соединение с сервисом интеграции
Функция МетодУстановитьСоединение() Экспорт
	Возврат "УстановитьСоединение";
КонецФункции

// Метод получить состояние подключения с сервисом интеграции.
// 
// Возвращаемое значение:
//  Строка - Метод получить состояние подключения с сервисом интеграции
Функция МетодПолучитьСостояниеПодключенияССервисомИнтеграции() Экспорт
	Возврат "ПолучитьСостояниеПодключения";
КонецФункции

// Метод создать обновить учетную запись.
// 
// Возвращаемое значение:
//  Строка - Метод создать обновить учетную запись
Функция МетодСоздатьОбновитьУчетнуюЗапись() Экспорт
	Возврат "СоздатьОбновитьУчетнуюЗапись";
КонецФункции

// Метод завершение менеджер длительных операций.
// 
// Возвращаемое значение:
//  Строка - Метод завершение менеджер длительных операций
Функция МетодЗавершениеМенеджерДлительныхОпераций() Экспорт
	Возврат "ЗавершениеМенеджерДлительныхОпераций";
КонецФункции

// Имя метода общего модуля получения учетных записей в сервисе интеграции
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодПолучитьУчетныеЗаписи() Экспорт
	Возврат "ПолучитьУчетныеЗаписи";
КонецФункции

// Метод удалить учетную запись.
// 
// Возвращаемое значение:
//  Строка - Метод удалить учетную запись
Функция МетодУдалитьУчетнуюЗапись() Экспорт
	Возврат "УдалитьУчетнуюЗапись";
КонецФункции

// Имя метода общего модуля обновления настроек учетной записи в сервисе интеграции
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодОбновитьНастройкиУчетнойЗаписи() Экспорт
	Возврат "ОбновитьНастройкиУчетнойЗаписи";
КонецФункции

// Имя метода общего модуля получения данных по складам маркетплейсов
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодПолучитьСкладыМаркетплейса() Экспорт
	Возврат "ПолучитьСкладыМаркетплейса";
КонецФункции

// Имя метода общего модуля обновления данных складов маркетплейсов
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодОбновитьСкладыМаркетплейса() Экспорт
	Возврат "ОбновитьСкладыМаркетплейса";
КонецФункции

// Имя метода общего модуля получения карточки склада маркетплейса
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодПолучитьКарточкуСкладаМаркетплейса() Экспорт
	Возврат "ПолучитьКарточкуСкладаМаркетплейса";
КонецФункции

// Имя метода общего модуля выгрузки данных складов 1С
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодВыгрузитьСклады() Экспорт
	Возврат "ВыгрузитьСклады";
КонецФункции

// Имя метода общего модуля получения данным по номенклатуре маркетплейсов
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодПолучитьНоменклатуруМаркетплейса() Экспорт
	Возврат "ПолучитьНоменклатуруМаркетплейса";
КонецФункции

// Имя метода общего модуля обновления данных номенклатуры маркетплейсов
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодОбновитьНоменклатуруМаркетплейса() Экспорт
	Возврат "ОбновитьНоменклатуруМаркетплейса";
КонецФункции

// Имя метода общего модуля получения карточки склада маркетплейса
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодПолучитьКарточкуНоменклатурыМаркетплейса() Экспорт
	Возврат "ПолучитьКарточкуНоменклатурыМаркетплейса";
КонецФункции

// Имя метода общего модуля получения списка ограничений остатков номенклатуры для маркетплейса
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодПолучитьОграниченияОстатковТоваров() Экспорт
	
	Возврат "ПолучитьОграниченияОстатковТоваров";
	
КонецФункции

// Имя метода общего модуля выгрузки ограничений остатков номенклатуры для маркетплейса
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодВыгрузитьОграниченияОстатковТоваров() Экспорт
	
	Возврат "ВыгрузитьОграниченияОстатковТоваров";
	
КонецФункции

// Имя метода общего модуля удаления ограничений остатков номенклатуры для маркетплейса
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодУдалитьОграниченияОстатковТоваров() Экспорт
	
	Возврат "УдалитьОграниченияОстатковТоваров";
	
КонецФункции

// Имя метода общего модуля получения остатков номенклатуры маркетплейса
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодПолучитьОстаткиТоваровМаркетплейса() Экспорт
	Возврат "ПолучитьОстаткиТоваровМаркетплейса";
КонецФункции

// Имя метода общего модуля выгрузки остатков номенклатуры для маркетплейса
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодВыгрузитьОстаткиТоваров() Экспорт
	Возврат "ВыгрузитьОстаткиТоваров";
КонецФункции

// Имя метода общего модуля выгрузки остатков номенклатуры для маркетплейса
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодВыгрузитьПодготовленныеОстаткиТоваров() Экспорт
	Возврат "ВыгрузитьПодготовленныеОстаткиТоваров";
КонецФункции

// Имя метода общего модуля подготовки остатков товаров для расчета
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодПодготовитьОстаткиТоваров() Экспорт
	Возврат "ПодготовитьОстаткиТоваров";
КонецФункции

// Метод получить данные пользователя ИТС.
// 
// Возвращаемое значение:
//  Строка - Метод получить данные пользователя ИТС
Функция МетодПолучитьДанныеПользователяИТС() Экспорт
	Возврат "ПолучитьДанныеПользователяИТС";
КонецФункции

// Метод получить список подключений.
// 
// Возвращаемое значение:
//  Строка - Получить список подключений
Функция МетодПолучитьПодключения() Экспорт
	Возврат "ПолучитьПодключения";
КонецФункции

// Метод установить подключение.
// 
// Возвращаемое значение:
//  Строка - Метод установить подключение
Функция МетодУстановитьПодключение() Экспорт
	Возврат "УстановитьПодключение";
КонецФункции

// Метод удалить подключение.
// 
// Возвращаемое значение:
//  Строка - Метод удалить подключение
Функция МетодУдалитьПодключение() Экспорт
	Возврат "УдалитьПодключение";
КонецФункции

// Имя метода ping
// 
// Возвращаемое значение:
//  Строка - Имя метода проверки доступности сервиса интеграции
Функция МетодПроверитьДоступностьСервисаИнтеграции() Экспорт
	Возврат "ПроверитьДоступностьСервисаИнтеграции";
КонецФункции

// Имя метода ping сервиса маркетплейса
// 
// Возвращаемое значение:
//  Строка - Имя метода проверки доступности сервиса интеграции
Функция МетодПроверитьДоступностьСервисаМаркетплейса() Экспорт
	Возврат "ПроверитьДоступностьСервисаМаркетплейса";
КонецФункции

// Имя метода общего модуля получения цен номенклатуры маркетплейса
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодПолучитьПоказателиНоменклатурыМаркетплейса() Экспорт
	Возврат "ПолучитьПоказателиНоменклатурыМаркетплейса";
КонецФункции

// Имя метода Выгрузить цены.
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодВыгрузитьЦены() Экспорт
	Возврат "ВыгрузитьЦены";
КонецФункции

// Имя метода Получить бренды.
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодПолучитьБренды() Экспорт
	Возврат "ПолучитьБренды";
КонецФункции

// Имя метода Получить категории.
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодПолучитьКатегории() Экспорт
	Возврат "ПолучитьКатегории";
КонецФункции

// Имя метода общего модуля переноса номенклатуры партнера
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодПеренестиНоменклатуруПартнера() Экспорт
	Возврат "ПеренестиНоменклатуруПартнера";
КонецФункции

// Маркеры результатов расчета цены.
// Соответствует идентификаторам элементов картинки КоллекцияСтатусовОбъектовТорговыхПлощадок.
// 
// Возвращаемое значение:
//  Структура - Маркеры:
// * Ошибка - Число - Есть ошибки при расчете цены по номенклатуре.
// * НетДанных - Число - Идет получение данных из сервиса интеграции.
// * БезОшибок - Число - Ошибок при расчете цен не возникло.
// * НаКарантине - Число - Номенклатура помещена маркетплейсом на карантин.
// * Все - Число - Используется для отбора всех цен.
Функция МаркерыСтатусовЦен() Экспорт
	
	Результат = Новый Структура;
	Результат.Вставить("Ошибка", 0);
	Результат.Вставить("НетДанных", 2);
	Результат.Вставить("БезОшибок", 3);
	Результат.Вставить("НаКарантине", 5);
	Результат.Вставить("Все", 8);
	
	Возврат Результат;
КонецФункции

#КонецОбласти

#Область Конструкторы

#Область КонструкторыКарточекОбъектовСервисаИнтеграции

// Параметр "УчетнаяЗапись", используемый в ответах методов.
//
// Возвращаемое значение:
//  Структура - данные карточки склада маркетплейса:
// * Состояние - Число - Состояние подключения учетной записи сервиса интеграции:
// 	# -1 - Проверка не осуществлялась;
// 	#  0 - Нет в информационной базе (устанавливается при отсутствии Организации);
// 	#  1 - Требуется переподключение;
// 	#  2 - Неизвестно (сервис Wildberrries не дал конкретного ответа, требуется повторный запрос позже);
// 	#  3 - Подключено.
// * УчетнаяЗаписьИдентификатор - Строка - Идентификатор учетной записи сервиса интеграции
// * УчетнаяЗапись - СправочникСсылка.УчетныеЗаписиМаркетплейсов - Учетная запись
// * Представление - Строка - Представление учетной записи сервиса интеграции
// * Организация - СправочникСсылка.Организации - Организация учетной записи
// * Партнер - СправочникСсылка.Партнеры - партнер, с которым заключен договора комиссии для продажи на маркетплейсе
// * Токены - Массив из См. НовыйОписаниеТокена - Токены
// * Функциональность - Массив из Число - Функциональность
// * ИспользоватьИнтеграциюПоОстаткам - Булево - Признак работы с остатками
// * АвтоКоррекцияОстатков - Булево - Признак автоматического отслеживания и коррекции расхождений между выгруженными и фактическим остатками
// * ИспользоватьИнтеграциюПоЦенам - Булево - Признак работы с ценами
// * АвтоКоррекцияЦен - Булево - Признак автоматического отслеживания и коррекции расхождений между выгруженными и фактическим ценами
// * РазрешенаВыгрузкаЦенНаМаркетплейс - Булево - Признак автоматической выгрузки цен в маркетплейс
// * ХешКлючейАвторизации - Строка - хеш ключей client_id и client_secret
// * Ошибки - Строка - описание ошибок
Функция НовыйКарточкаУчетнойЗаписи() Экспорт
	
	Результат = Новый Структура;
	
	Результат.Вставить("Состояние", 0);
	Результат.Вставить("УчетнаяЗаписьИдентификатор", "");
	Результат.Вставить("УчетнаяЗапись", ПредопределенноеЗначение("Справочник.УчетныеЗаписиМаркетплейсов.ПустаяСсылка"));
	Результат.Вставить("Представление", "");
	Результат.Вставить("Организация", ПредопределенноеЗначение("Справочник.Организации.ПустаяСсылка"));
	Результат.Вставить("Партнер", ПредопределенноеЗначение("Справочник.Партнеры.ПустаяСсылка"));
	Результат.Вставить("Токены", Новый Массив);
	Результат.Вставить("Функциональность", Новый Массив);
	Результат.Вставить("ИспользоватьИнтеграциюПоОстаткам", Ложь);
	Результат.Вставить("АвтоКоррекцияОстатков", Ложь);
	Результат.Вставить("ИспользоватьИнтеграциюПоЦенам", Ложь);
	Результат.Вставить("АвтоКоррекцияЦен", Ложь);
	Результат.Вставить("РазрешенаВыгрузкаЦенНаМаркетплейс", Ложь);
	Результат.Вставить("ХешКлючейАвторизации", "");
	Результат.Вставить("Ошибки", "");
	
	Возврат Результат;
	
КонецФункции

// Новый описание токена.
// 
// Возвращаемое значение:
//  Структура - Новый описание токена:
// * ХешТокена - Строка - 
// * Категории - Строка - 
// * ДействуетДо - Дата - 
// * Ошибка - Строка - 
Функция НовыйОписаниеТокена() Экспорт
	
	Результат = Новый Структура;
	
	Результат.Вставить("ХешТокена", "");
	Результат.Вставить("Категории", "");
	Результат.Вставить("ДействуетДо", Дата(1,1,1));
	Результат.Вставить("Ошибка", "");
	
	Возврат Результат;
	
КонецФункции

// Параметр "СкладМаркетплейса", используемый в ответах методов.
// 
// Возвращаемое значение:
//  Структура - данные карточки склада маркетплейса:
// * ИдентификаторСкладаСервиса - Строка - Идентификатор склада сервиса интеграции
// * НаименованиеСкладаСервиса - Строка - Наименование склада сервиса
// * НаименованиеСкладаМаркетплейса - Строка - Наименование склада маркетплейса
// * Склад - СправочникСсылка.Склады - Склад 1С, соответствующий складу маркетплейса
// * СхемаРаботыСклада - ПеречислениеСсылка.СхемыРаботыТорговыхПлощадок - схема работы склада
// * ДополнительныеСведения - Неопределено, Структура - дополнительные сведения, предоставляемые маркетплейсом.Свойства:
//  ** АдресМаркетплейса - Строка - адрес склада маркетплейса
//  ** ГородМаркетплейса - Строка - город, в котором расположен склад маркетплейса
Функция НовыйКарточкаСкладаМаркетплейса() Экспорт
	
	Результат = Новый Структура;
	
	Результат.Вставить("ИдентификаторСкладаСервиса", "");
	Результат.Вставить("НаименованиеСкладаСервиса", "");
	Результат.Вставить("НаименованиеСкладаМаркетплейса", "");
	Результат.Вставить("Склад", ПредопределенноеЗначение("Справочник.Склады.ПустаяСсылка"));
	Результат.Вставить("СхемаРаботыСклада", ПредопределенноеЗначение("Перечисление.СхемыРаботыТорговыхПлощадок.ПустаяСсылка"));
	Результат.Вставить("ДополнительныеСведения", Неопределено);
	
	Возврат Результат;
	
КонецФункции

// Параметр "НоменклатураМаркетплейса", используемый в ответах методов
// 
// Возвращаемое значение:
//  Структура - данные карточки номенклатуры маркетплейса:
// * ИдентификаторНоменклатурыСервиса - Строка - Идентификатор номенклатуры (sku) сервиса интеграции
// * НаименованиеНоменклатурыСервиса - Строка - Наименование номенклатуры (sku) сервиса интеграции
// * ПолноеНаименованиеНоменклатурыСервиса - Строка - Полное наименование номенклатуры (sku) сервиса интеграции
// * ИдентификаторХарактеристики - Строка - Идентификатор характеристики номенклатуры маркетплейса
// * НаименованиеХарактеристики - Строка - Наименование характеристики номенклатуры маркетплейса
// * НоменклатураКонтрагента - СправочникСсылка.НоменклатураКонтрагентов - ссылка на сопоставление 
//      номенклатуры маркетплейса и номенклатуры 1С.
// * Штрихкод - Строка - штрих-код номенклатуры (sku) маркетплейса
// * Артикул - Строка - артикул номенклатуры (sku), установленный продавцом
// * АртикулМаркетплейса - Строка - артикул номенклатуры (MarketSku), установленный маркетплейсом
// * ДополнительныеСведения - Неопределено - , Структура - дополнительные сведения, предоставляемые маркетплейсом.Свойства:
//  ** фото - ДвоичныеДанные - фото номенклатурной позиции
Функция НовыйКарточкаНоменклатурыМаркетплейса() Экспорт
	
	Результат = Новый Структура;
	
	Результат.Вставить("ИдентификаторНоменклатурыСервиса", "");
	Результат.Вставить("НаименованиеНоменклатурыСервиса", "");
	Результат.Вставить("ПолноеНаименованиеНоменклатурыСервиса", "");
	Результат.Вставить("ИдентификаторХарактеристики", "");
	Результат.Вставить("НаименованиеХарактеристики", "");
	Результат.Вставить("НоменклатураКонтрагента", ПредопределенноеЗначение("Справочник.НоменклатураКонтрагентов.ПустаяСсылка"));
	Результат.Вставить("Штрихкод", "");
	Результат.Вставить("Артикул", "");
	Результат.Вставить("АртикулМаркетплейса", "");
	Результат.Вставить("ДополнительныеСведения", Неопределено);
	
	Возврат Результат;
	
КонецФункции

// Параметр "КарточкаНастройкиОграниченияОстаткаТоваров", используемый в ответах методов
// 
// Возвращаемое значение:
//  Структура - описание накладываемого ограничения на фактический остаток товара:
//   * ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
//   * Используется - Булево - признак активности ограничения
//   * Код - Число - код ограничения
//   * Наименование - Строка - краткое наименование ограничения
//   * ОбластьДействия - Неопределено, Произвольный - свойство товара,на которое накладывается ограничение. (Например: ссылка или вид номенклатуры)
//   * ПроцентОстатка - Число - процент от фактического остатка
//   * СтраховойЗапас - Число - страховой запас
//   * МинимальныйОстаток - Число - минимальный остаток, который должен быть показан на маркетплейсе
//   * МаксимальныйОстаток - Число - минимальный остаток, который должен быть показан на маркетплейсе
Функция НовыйКарточкаНастройкиОграниченияОстаткаТоваров() Экспорт
	
	Результат = Новый Структура;
	
	Результат.Вставить("ВидМаркетплейса", ПредопределенноеЗначение("Перечисление.ВидыМаркетплейсов.ПустаяСсылка"));
	Результат.Вставить("Используется", Ложь);
	Результат.Вставить("Код", 0);
	Результат.Вставить("Наименование", "");
	Результат.Вставить("ОбластьДействия", Неопределено);
	Результат.Вставить("ПроцентОстатка", 100);
	Результат.Вставить("СтраховойЗапас", 0);
	Результат.Вставить("МинимальныйОстаток", 0);
	Результат.Вставить("МаксимальныйОстаток", 0);
	
	Возврат Результат;
	
КонецФункции

// Параметр "КарточкаОстаткаТовараМаркетплейса", используемый в ответах методов
// 
// Возвращаемое значение:
//  Структура - Состав карточки остатка товара маркетплейса. Свойства:
//   * НоменклатураПартнера - СправочникСсылка.НоменклатураКонтрагентов - номенклатура партнера
//   * ИдентификаторСклада - Строка - идентификатор склада сервиса интеграции
//   * НаименованиеСклада - Строка - наименование склада сервиса интеграции
//   * КоличествоМаркетплейса - Число - Количество товара на торговой площадке
//   * Количество - Число - Количество товара для отображения на сайте маркетплейса
//   * ИдентификаторОграничения - Строка - идентификатор примененного ограничения
//   * ПредставлениеОграничения - Строка - представление примененного ограничения
//   * ДатаВыгрузки - Дата - дата последней выгрузки остатка в маркетплейс
Функция НовыйКарточкаОстаткаТовараМаркетплейса() Экспорт
	
	Результат = Новый Структура;
	
	Результат.Вставить("НоменклатураПартнера", ПредопределенноеЗначение("Справочник.НоменклатураКонтрагентов.ПустаяСсылка"));
	Результат.Вставить("ИдентификаторСклада", "");
	Результат.Вставить("НаименованиеСклада", "");
	Результат.Вставить("КоличествоМаркетплейса", 0);
	Результат.Вставить("Количество", 0);
	Результат.Вставить("ИдентификаторОграничения", "");
	Результат.Вставить("ПредставлениеОграничения", "");
	Результат.Вставить("ДатаВыгрузки", '00010101');
	
	Возврат Результат;
	
КонецФункции

// Конструктор записи, содержащей показатели номенклатуры маркетплейса
// 
// Возвращаемое значение:
//  Структура - Описание измерений и показателей:
//   * идНоменклатурыСИ - Строка - идентификатор номенклатуры, назначенный сервисом интеграции
//   * ИдБрендаМП - Строка - идентификатор бренда, назначенный сервисом интеграции
//   * ИдКатегорииМП - Строка - идентификатор категории, назначенный сервисом интеграции
//   * КоличествоМП - Число - Общее количество упаковок товара на всех складах маркетплейса по данным маркетплейса
//   * ЦенаБезСкидки - Число - Расчетная базовая цена продавца (без скидок)
//   * ЦенаБезСкидкиМП - Число - Базовая цена продавца (без скидок), опубликованная на маркетплейсе
//   * ЦенаСоСкидкойПродавца - Число - Расчетная цена со скидкой продавца
//   * ЦенаСоСкидкойПродавцаМП - Число - Цена со скидкой продавца, опубликованная на маркетплейсе
//   * ЦенаСоВсемиСкидками - Число - Расчетная цена c учетом скидки продавца и клубной программы Wildberries
//   * ЦенаСоВсемиСкидкамиМП - Число - Цена c учетом скидки продавца и клубной программы Wildberries, опубликованная на маркетплейсе
//   * СкидкаПродавца - Число - Расчетный % скидки продавца
//   * СкидкаПродавцаМП - Число - % скидки продавца, опубликованный на маркетплейсе
//   * СкидкаWB - Число - Расчетный % скидки клубной программы Wildberries
//   * СкидкаМПWB - Число - % скидки клубной программы Wildberries
//   * МаркерСтатуса - Число - см. МаркерыСтатусовЦен
//   * НаКарантине - Булево - Номенклатура помещена маркетплейсом в карантин по причине резкого изменения цены
//   * ТекстОшибки - Строка - Описание ошибки, возникшей при расчете цен
//   * ДатаВыгрузкиЦен - Дата - Дата публикации цен на маркетплейсе
//   * Основная - Булево - Цены данной номенклатуры легли в основу для расчета цен всех остальных номенклатур с идентичным nmID
//   * ЦеныПоХарактеристикам - Булево - Для данной номенклатуры цены устанавливаются в разрезе характеристик (размеров)
Функция НовыйКарточкаПоказателиНоменклатурыМаркетплейса() Экспорт
	
	Результат = Новый Структура;
	
	Результат.Вставить("идНоменклатурыСИ", "");
	
	Результат.Вставить("ИдБрендаМП", "");
	Результат.Вставить("ИдКатегорииМП", "");
	
	Результат.Вставить("КоличествоМП", 0);
	Результат.Вставить("ЦенаБезСкидки", 0);
	Результат.Вставить("ЦенаБезСкидкиМП", 0);
	Результат.Вставить("ЦенаСоСкидкойПродавца", 0);
	Результат.Вставить("ЦенаСоСкидкойПродавцаМП", 0);
	Результат.Вставить("ЦенаСоВсемиСкидками", 0);
	Результат.Вставить("ЦенаСоВсемиСкидкамиМП", 0);
	Результат.Вставить("СкидкаПродавца", 0);
	Результат.Вставить("СкидкаПродавцаМП", 0);
	Результат.Вставить("СкидкаWB", 0);
	Результат.Вставить("СкидкаМПWB", 0);
	
	Результат.Вставить("ТекстОшибки", "");
	
	Результат.Вставить("ДатаВыгрузкиЦен", '00010101');
	
	Результат.Вставить("МаркерСтатуса", -1);
	Результат.Вставить("НаКарантине", Ложь);
	Результат.Вставить("Основная", Ложь);
	Результат.Вставить("ЦеныПоХарактеристикам", Ложь);
	
	Возврат Результат;
	
КонецФункции

// Конструктор страницы кэша динамического списка
// 
// Возвращаемое значение:
//  Структура - Описание страницы кэша:
// * ПервыйКлюч - Строка - Минимальный ключ, находящийся на странице. Данное поле идентифицирует страницу
// * ПервыйИдентификатор - Строка - идентификатор первой записи на странице.
// * ПоследнийКлюч - Строка - Максимальный ключ, находящийся на странице
// * ПоследнийИдентификатор - Строка - идентификатор последней записи на странице
// * АдресСтраницы - Строка - Адрес страницы во временном хранилище
// * Первая - Булево - Признак того, что станица является первой. 
// * Последняя - Булево - Признак того, что станица является последней.
// * ДатаАктуальности - Дата - дата получения данных из сервиса интеграции 
Функция НовыйСтраницаКэша() Экспорт
	
	Результат = Новый Структура;
	
	Результат.Вставить("ПервыйКлюч", "");
	Результат.Вставить("ПервыйИдентификатор", "");
	Результат.Вставить("ПоследнийКлюч", "");
	Результат.Вставить("ПоследнийИдентификатор", "");
	Результат.Вставить("АдресСтраницы", "");
	Результат.Вставить("Первая", Ложь);
	Результат.Вставить("Последняя", Ложь);
	Результат.Вставить("ДатаАктуальности", '00010101');
	Результат.Вставить("Курсор", "");

	Возврат Результат;
	
КонецФункции

#КонецОбласти

// Новые параметры подключения.
// 
// Возвращаемое значение:
//  Структура - Новые параметры подключения:
// * client_id - Строка - 
// * КлючПодключения - Строка - 
// * ИдентификаторИнформационнойБазы - Строка - 
// * Представление - Строка - 
// * ДатаПодключенияСИ - Дата - 
// * ЭтоНовоеПодключение - Булево - 
Функция НовыеПараметрыПодключения() Экспорт
	
	ПараметрыПодключения = Новый Структура;
	
	ПараметрыПодключения.Вставить("client_id", "");
	ПараметрыПодключения.Вставить("КлючПодключения", "");
	ПараметрыПодключения.Вставить("ИдентификаторИнформационнойБазы", "");
	ПараметрыПодключения.Вставить("Представление", "");
	ПараметрыПодключения.Вставить("ДатаПодключенияСИ", Дата(1, 1, 1));
	ПараметрыПодключения.Вставить("ЭтоНовоеПодключение", Ложь);
	
	Возврат ПараметрыПодключения;
	
КонецФункции

// Новый результат метода.
// 
// Возвращаемое значение:
//  Структура - Новый результат метода:
// * Ошибки - Массив из Строка - описание ошибок, возникших в ходе выполнения метода
// * КодСостояния - Число - Код ответа. https://ru.wikipedia.org/wiki/Список_кодов_состояния_HTTP.
Функция НовыйРезультатМетода() Экспорт
	
	Результат = Новый Структура;
	
	Результат.Вставить("Ошибки", Новый Массив);
	Результат.Вставить("КодСостояния", 0);
	
	Возврат Результат;
	
КонецФункции

#КонецОбласти

// Инициализация параметров менеджера длительных операций.
// 
// Возвращаемое значение:
//  Структура - Новые параметры менеджера длительных операций:
//   * Метод - Строка - имя метода менеджера длительных операций
//   * МетодЗавершение - Строка - 
//   * ТекстСообщения - Строка - сообщение, выводимое в окне ожидания
//   * РежимПараллельныхОчередей - Булево - определяет вариант работы с очередями. Ложь - используется "Очередь". Истина - используется "Очереди"
//   * ВыводитьОкноОжидания - Булево - 
//   * ВыводитьСообщения - Булево - Вывод сообщений, подготовленных во время длительных операций
//   * ОжидатьЗавершение - Число - 
//   * РежимОткрытияОкнаОжидания - РежимОткрытияОкнаФормы - Параметр РежимОткрытияОкна у формы ожидания
//                               - Неопределено - Значение по умолчанию
//   * ЗапуститьВФоне - Булево - 
//   * Очередь - СписокЗначений из Структура - Параметры операции
//   * Очереди - Массив из структура - очереди, выполняемые в параллельном режиме. Свойства:
//    ** ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - разделитель очереди.
//       При использовании в других подсистемах имя разделителя меняется. Например, в сервисе доставки это ТипГрузоперевозки.
//    ** Методы - Массив из структура - последовательно выполняемые методы очереди. Порядок в массиве определяет порядок исполнения. Свойства:
//     *** ПараметрыМетода - Произвольный - параметры метода http-запроса.
//     *** ИмяМетода - Строка- имя метода http-запроса.
//     *** ИменаМетодовКэширования - Массив из Строка - имена процедур, которые должны быть применены для кэширования 
//         полученных значений. Позволит передать данные из одного метода в другой в пределах одной очереди.
//     *** ЭтоФункция - Булево - определяет, что метод реализован в виде процедуры или функции
//   * ОбработкаРезультатаНаСервере - Булево - обработку результата необходимо провести на сервере.
//   * ФоновоеЗадание - Неопределено
//                    - См. ДлительныеОперации.ВыполнитьФункцию
//   * КлючФоновогоЗадания - Произвольный, Строка, Неопределено - 
//   * КлючВыполнения - Строка - По умолчанию равен имени формы, из которой вызывается. Можно переопределить при инициации.
//   В методе ИнтеграцияСМаркетплейсамиСИ.ВыполнитьДлительнуюОперацию определяет постобработку для специфичных ситуаций,
//   т.е. логику вне формы, используется для уменьшения серверных вызовов.
//   * ЭтоФункция - Булево - 
//   * ОтменитьАктивные - Булево - Если Истина, активные фоновые задания с идентичным ключом фонового задания будут отменены
//   * ЗакрытьПослеЗавершенияОперации - Булево - Если Истина, закрыть форму после завершения операции
//   * ОтменитьМодифицированность - Булево - Снимает флаг модифицированности формы
//   * ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
//   * СеансыУведомленияКлиента - Массив из Число - сеансы, в которые необходимо передать результат выполнения.
Функция НовыеПараметрыМенеджераДлительныхОпераций() Экспорт
	
	Параметры = Новый Структура;
	
	Параметры.Вставить("Метод", МетодМенеджерДлительныхОпераций());
	Параметры.Вставить("МетодЗавершение", МетодЗавершениеМенеджерДлительныхОпераций());
	Параметры.Вставить("ТекстСообщения", НСтр("ru = 'Обработка данных.';
												|en = 'Data processing.'"));
	Параметры.Вставить("РежимПараллельныхОчередей", Ложь);
	Параметры.Вставить("ВыводитьОкноОжидания", Истина);
	Параметры.Вставить("ВыводитьСообщения", Истина);
	Параметры.Вставить("ОжидатьЗавершение", 0);
	Параметры.Вставить("РежимОткрытияОкнаОжидания", Неопределено);
	Параметры.Вставить("ЗапуститьВФоне", Истина);
	Параметры.Вставить("Очередь", Новый СписокЗначений);
	Параметры.Вставить("Очереди", Новый Массив);
	Параметры.Вставить("ОбработкаРезультатаНаСервере", Ложь);
	Параметры.Вставить("ОбработкаРезультатаНаСервереБезКонтекста", Ложь);
	Параметры.Вставить("ФоновоеЗадание", Неопределено);
	Параметры.Вставить("КлючФоновогоЗадания", Неопределено);
	Параметры.Вставить("КлючВыполнения", "");
	Параметры.Вставить("ЭтоФункция", Ложь);
	Параметры.Вставить("ОтменитьАктивные", Ложь);
	Параметры.Вставить("ЗакрытьПослеЗавершенияОперации", Ложь);
	Параметры.Вставить("ОтменитьМодифицированность", Ложь);
	Параметры.Вставить("ВидМаркетплейса", ПредопределенноеЗначение("Перечисление.ВидыМаркетплейсов.ПустаяСсылка"));
	Параметры.Вставить("СеансыУведомленияКлиента", Новый Массив);
	
	Возврат Параметры;
	
КонецФункции

// Маркетплейс по виду.
// 
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
// 
// Возвращаемое значение:
//  Строка - Маркетплейс по виду
Функция МаркетплейсПоВиду(ВидМаркетплейса) Экспорт
	
	Результат = "";
	
	Если ИнтеграцияСМаркетплейсамиКлиентСервер.ЭтоLamoda(ВидМаркетплейса) Тогда
		Результат = "Lamoda";
	ИначеЕсли ИнтеграцияСМаркетплейсамиКлиентСервер.ЭтоWildberries(ВидМаркетплейса) Тогда
		Результат = "Wildberries";
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции

// Представление вида маркетплейса.
// 
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
// 
// Возвращаемое значение:
//  Строка - Представление вида маркетплейса
Функция ПредставлениеВидаМаркетплейса(ВидМаркетплейса) Экспорт
	
	Результат = "";
	
	Если ВидМаркетплейса = ПредопределенноеЗначение("Перечисление.ВидыМаркетплейсов.ПустаяСсылка") Тогда
		Результат = НСтр("ru = 'Маркетплейс';
						|en = 'Marketplace'");
	ИначеЕсли ВидМаркетплейса = ПредопределенноеЗначение("Перечисление.ВидыМаркетплейсов.МаркетплейсWildberries") Тогда
		Результат = НСтр("ru = 'Маркетплейс Wildberries';
						|en = 'Wildberries marketplace'");
	ИначеЕсли ВидМаркетплейса = ПредопределенноеЗначение("Перечисление.ВидыМаркетплейсов.МаркетплейсLamoda") Тогда
		Результат = НСтр("ru = 'Маркетплейс Lamoda';
						|en = 'Lamoda'");
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции

#Область РегламентныеЗадания

// Префикс маркетплейса 
//
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
// 
// Возвращаемое значение:
//  Строка - Префикс
Функция ПрефиксМаркетплейса(ВидМаркетплейса) Экспорт
	
	Результат = "";
	Если ИнтеграцияСМаркетплейсамиКлиентСервер.ЭтоLamoda(ВидМаркетплейса) Тогда
		Результат= ИнтеграцияСМаркетплейсомLamodaКлиентСервер.ПрефиксМаркетплейса();
	ИначеЕсли ИнтеграцияСМаркетплейсамиКлиентСервер.ЭтоWildberries(ВидМаркетплейса) Тогда
		Результат = ИнтеграцияСМаркетплейсомWildberriesКлиентСервер.ПрефиксМаркетплейса();
	КонецЕсли;
	
	Возврат Результат;
КонецФункции

// Префикс имени регламентного задания СинхронизацияССервисомИнтеграции
//
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
// 
// Возвращаемое значение:
//  Строка - Префикс
Функция ПрефиксЗаданияСинхронизацияССервисомИнтеграции(ВидМаркетплейса) Экспорт
	ПрефиксМаркетплейса = ПрефиксМаркетплейса(ВидМаркетплейса);
	Возврат СтрШаблон("%1_", ПрефиксМаркетплейса);
КонецФункции

// Префикс имени регламентного задания РасчетОстатковТоваров
//
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
// 
// Возвращаемое значение:
//  Строка - Префикс
Функция ПрефиксЗаданияРасчетОстатковТоваров(ВидМаркетплейса) Экспорт
	ПрефиксМаркетплейса = ПрефиксМаркетплейса(ВидМаркетплейса);
	Возврат СтрШаблон("%1StokRemains_", ПрефиксМаркетплейса);
КонецФункции

// Префикс имени регламентного задания ВыгрузитьЦены
//
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
// 
// Возвращаемое значение:
//  Строка - Префикс
Функция ПрефиксЗаданияВыгрузкаЦенНаМаркетплейсы(ВидМаркетплейса) Экспорт
	ПрефиксМаркетплейса = ПрефиксМаркетплейса(ВидМаркетплейса);
	Возврат СтрШаблон("%1GoodsPrices_", ПрефиксМаркетплейса);
КонецФункции

// Формирование ключа регламентного задания СинхронизацияССервисомИнтеграции
//
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
//  ИдентификаторУчетнойЗаписи - Строка - идентификатор учетной записи системы интеграции
//
// Возвращаемое значение:
//  Строка - Ключ
Функция КлючЗаданияСинхронизацияССервисомИнтеграции(Знач ВидМаркетплейса, Знач ИдентификаторУчетнойЗаписи) Экспорт
	Возврат ПрефиксЗаданияСинхронизацияССервисомИнтеграции(ВидМаркетплейса) + ИдентификаторУчетнойЗаписи;
КонецФункции

// Формирование ключа регламентного задания РасчетОстатковТоваров
// 
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
//  ИдентификаторУчетнойЗаписи - Строка - идентификатор учетной записи системы интеграции
//
// Возвращаемое значение:
//  Строка - Ключ
Функция КлючЗаданияРасчетОстатковТоваров(Знач ВидМаркетплейса, Знач ИдентификаторУчетнойЗаписи) Экспорт
	Возврат ПрефиксЗаданияРасчетОстатковТоваров(ВидМаркетплейса) + ИдентификаторУчетнойЗаписи;
КонецФункции

// Формирование ключа регламентного задания ВыгрузкаЦенНаМаркетплейсы
// 
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
//  ИдентификаторУчетнойЗаписи - Строка - идентификатор учетной записи системы интеграции
//
// Возвращаемое значение:
//  Строка - Ключ
Функция КлючЗаданияВыгрузкаЦенНаМаркетплейсы(Знач ВидМаркетплейса, Знач ИдентификаторУчетнойЗаписи) Экспорт
	Возврат ПрефиксЗаданияВыгрузкаЦенНаМаркетплейсы(ВидМаркетплейса) + ИдентификаторУчетнойЗаписи;
КонецФункции

// Префиксы регламентных заданий.
// 
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
// 
// Возвращаемое значение:
//	Соответствие Из КлючИЗначение - Префиксы регламентных заданий:
//		* Ключ - Строка - имя регламентного задания
//		* Значение - Строка - префикс регламентного задания
Функция ПрефиксыРегламентныхЗаданий(ВидМаркетплейса) Экспорт

	Префиксы = Новый Соответствие;
	
	Префиксы.Вставить("Синхронизация", ПрефиксЗаданияСинхронизацияССервисомИнтеграции(ВидМаркетплейса));
	Префиксы.Вставить("ВыгрузкаОстатков", ПрефиксЗаданияРасчетОстатковТоваров(ВидМаркетплейса));
	Префиксы.Вставить("ВыгрузкаЦен", ПрефиксЗаданияВыгрузкаЦенНаМаркетплейсы(ВидМаркетплейса));
	
	Возврат Префиксы;

КонецФункции

// Представление регламентного задания СинхронизацияССервисомИнтеграции
//
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
//
// Возвращаемое значение:
//  Строка - Представление
Функция ПредставлениеЗаданияСинхронизацияССервисомИнтеграции(ВидМаркетплейса) Экспорт
	Возврат СтрШаблон(НСтр("ru = '%1. Синхронизация';
							|en = '%1. Synchronization'"), МаркетплейсПоВиду(ВидМаркетплейса));
КонецФункции

// Представление регламентного задания РасчетОстатковТоваров
//
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
//
// Возвращаемое значение:
//  Строка - Представление
Функция ПредставлениеЗаданияРасчетОстатковТоваров(ВидМаркетплейса) Экспорт
	Возврат СтрШаблон(НСтр("ru = '%1. Расчет остатков товаров';
							|en = '%1. Calculate stock balance'"), МаркетплейсПоВиду(ВидМаркетплейса));
КонецФункции

// Представление регламентного задания РасчетОстатковТоваров
//
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
//
// Возвращаемое значение:
//  Строка - Представление
Функция ПредставлениеЗаданияВыгрузкаЦенНаМаркетплейсы(ВидМаркетплейса) Экспорт
	Возврат СтрШаблон(НСтр("ru = '%1. Выгрузка цен товаров';
							|en = '%1. Export item prices'"), МаркетплейсПоВиду(ВидМаркетплейса));
КонецФункции

// Возвращает наименование регламентного задания
//
// Параметры:
//  ВидМаркетплейса - ПеречислениеСсылка.ВидыМаркетплейсов - Вид маркетплейса
//  Идентификатор - Строка - Идентификатор регламентного задания.
// 
// Возвращаемое значение:
//  Строка - Наименование регламентного задания
Функция НаименованиеРегламентногоЗадания(ВидМаркетплейса, Идентификатор) Экспорт
	
	Результат = "";
	
	Если Идентификатор = ПрефиксЗаданияСинхронизацияССервисомИнтеграции(ВидМаркетплейса) Тогда
		Результат = ПредставлениеЗаданияСинхронизацияССервисомИнтеграции(ВидМаркетплейса);
	ИначеЕсли Идентификатор = ПрефиксЗаданияРасчетОстатковТоваров(ВидМаркетплейса) Тогда
		Результат = ПредставлениеЗаданияРасчетОстатковТоваров(ВидМаркетплейса);
	ИначеЕсли Идентификатор = ПрефиксЗаданияВыгрузкаЦенНаМаркетплейсы(ВидМаркетплейса) Тогда
		Результат = ПредставлениеЗаданияВыгрузкаЦенНаМаркетплейсы(ВидМаркетплейса) ;
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции

#КонецОбласти

#КонецОбласти